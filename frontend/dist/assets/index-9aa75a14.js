(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();function uh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var dh={exports:{}},ta={},fh={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yo=Symbol.for("react.element"),ov=Symbol.for("react.portal"),iv=Symbol.for("react.fragment"),av=Symbol.for("react.strict_mode"),lv=Symbol.for("react.profiler"),cv=Symbol.for("react.provider"),uv=Symbol.for("react.context"),dv=Symbol.for("react.forward_ref"),fv=Symbol.for("react.suspense"),hv=Symbol.for("react.memo"),pv=Symbol.for("react.lazy"),Zu=Symbol.iterator;function mv(e){return e===null||typeof e!="object"?null:(e=Zu&&e[Zu]||e["@@iterator"],typeof e=="function"?e:null)}var hh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ph=Object.assign,mh={};function os(e,t,n){this.props=e,this.context=t,this.refs=mh,this.updater=n||hh}os.prototype.isReactComponent={};os.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};os.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gh(){}gh.prototype=os.prototype;function Pc(e,t,n){this.props=e,this.context=t,this.refs=mh,this.updater=n||hh}var Lc=Pc.prototype=new gh;Lc.constructor=Pc;ph(Lc,os.prototype);Lc.isPureReactComponent=!0;var qu=Array.isArray,yh=Object.prototype.hasOwnProperty,Mc={current:null},vh={key:!0,ref:!0,__self:!0,__source:!0};function xh(e,t,n){var r,s={},o=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(o=""+t.key),t)yh.call(t,r)&&!vh.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:yo,type:e,key:o,ref:i,props:s,_owner:Mc.current}}function gv(e,t){return{$$typeof:yo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $c(e){return typeof e=="object"&&e!==null&&e.$$typeof===yo}function yv(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ed=/\/+/g;function ba(e,t){return typeof e=="object"&&e!==null&&e.key!=null?yv(""+e.key):t.toString(36)}function ri(e,t,n,r,s){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case yo:case ov:i=!0}}if(i)return i=e,s=s(i),e=r===""?"."+ba(i,0):r,qu(s)?(n="",e!=null&&(n=e.replace(ed,"$&/")+"/"),ri(s,t,n,"",function(u){return u})):s!=null&&($c(s)&&(s=gv(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(ed,"$&/")+"/")+e)),t.push(s)),1;if(i=0,r=r===""?".":r+":",qu(e))for(var l=0;l<e.length;l++){o=e[l];var c=r+ba(o,l);i+=ri(o,t,n,c,s)}else if(c=mv(e),typeof c=="function")for(e=c.call(e),l=0;!(o=e.next()).done;)o=o.value,c=r+ba(o,l++),i+=ri(o,t,n,c,s);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function To(e,t,n){if(e==null)return e;var r=[],s=0;return ri(e,r,"","",function(o){return t.call(n,o,s++)}),r}function vv(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var rt={current:null},si={transition:null},xv={ReactCurrentDispatcher:rt,ReactCurrentBatchConfig:si,ReactCurrentOwner:Mc};function wh(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:To,forEach:function(e,t,n){To(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return To(e,function(){t++}),t},toArray:function(e){return To(e,function(t){return t})||[]},only:function(e){if(!$c(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ce.Component=os;ce.Fragment=iv;ce.Profiler=lv;ce.PureComponent=Pc;ce.StrictMode=av;ce.Suspense=fv;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xv;ce.act=wh;ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=ph({},e.props),s=e.key,o=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,i=Mc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)yh.call(t,c)&&!vh.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:yo,type:e.type,key:s,ref:o,props:r,_owner:i}};ce.createContext=function(e){return e={$$typeof:uv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:cv,_context:e},e.Consumer=e};ce.createElement=xh;ce.createFactory=function(e){var t=xh.bind(null,e);return t.type=e,t};ce.createRef=function(){return{current:null}};ce.forwardRef=function(e){return{$$typeof:dv,render:e}};ce.isValidElement=$c;ce.lazy=function(e){return{$$typeof:pv,_payload:{_status:-1,_result:e},_init:vv}};ce.memo=function(e,t){return{$$typeof:hv,type:e,compare:t===void 0?null:t}};ce.startTransition=function(e){var t=si.transition;si.transition={};try{e()}finally{si.transition=t}};ce.unstable_act=wh;ce.useCallback=function(e,t){return rt.current.useCallback(e,t)};ce.useContext=function(e){return rt.current.useContext(e)};ce.useDebugValue=function(){};ce.useDeferredValue=function(e){return rt.current.useDeferredValue(e)};ce.useEffect=function(e,t){return rt.current.useEffect(e,t)};ce.useId=function(){return rt.current.useId()};ce.useImperativeHandle=function(e,t,n){return rt.current.useImperativeHandle(e,t,n)};ce.useInsertionEffect=function(e,t){return rt.current.useInsertionEffect(e,t)};ce.useLayoutEffect=function(e,t){return rt.current.useLayoutEffect(e,t)};ce.useMemo=function(e,t){return rt.current.useMemo(e,t)};ce.useReducer=function(e,t,n){return rt.current.useReducer(e,t,n)};ce.useRef=function(e){return rt.current.useRef(e)};ce.useState=function(e){return rt.current.useState(e)};ce.useSyncExternalStore=function(e,t,n){return rt.current.useSyncExternalStore(e,t,n)};ce.useTransition=function(){return rt.current.useTransition()};ce.version="18.3.1";fh.exports=ce;var v=fh.exports;const I=uh(v);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wv=v,Sv=Symbol.for("react.element"),kv=Symbol.for("react.fragment"),Cv=Object.prototype.hasOwnProperty,jv=wv.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Nv={key:!0,ref:!0,__self:!0,__source:!0};function Sh(e,t,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Cv.call(t,r)&&!Nv.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:Sv,type:e,key:o,ref:i,props:s,_owner:jv.current}}ta.Fragment=kv;ta.jsx=Sh;ta.jsxs=Sh;dh.exports=ta;var a=dh.exports,yl={},kh={exports:{}},wt={},Ch={exports:{}},jh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,b){var D=A.length;A.push(b);e:for(;0<D;){var z=D-1>>>1,H=A[z];if(0<s(H,b))A[z]=b,A[D]=H,D=z;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var b=A[0],D=A.pop();if(D!==b){A[0]=D;e:for(var z=0,H=A.length,X=H>>>1;z<X;){var G=2*(z+1)-1,q=A[G],te=G+1,re=A[te];if(0>s(q,D))te<H&&0>s(re,q)?(A[z]=re,A[te]=D,z=te):(A[z]=q,A[G]=D,z=G);else if(te<H&&0>s(re,D))A[z]=re,A[te]=D,z=te;else break e}}return b}function s(A,b){var D=A.sortIndex-b.sortIndex;return D!==0?D:A.id-b.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,f=null,p=3,m=!1,y=!1,x=!1,j=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(A){for(var b=n(u);b!==null;){if(b.callback===null)r(u);else if(b.startTime<=A)r(u),b.sortIndex=b.expirationTime,t(c,b);else break;b=n(u)}}function k(A){if(x=!1,w(A),!y)if(n(c)!==null)y=!0,L(C);else{var b=n(u);b!==null&&F(k,b.startTime-A)}}function C(A,b){y=!1,x&&(x=!1,h(P),P=-1),m=!0;var D=p;try{for(w(b),f=n(c);f!==null&&(!(f.expirationTime>b)||A&&!B());){var z=f.callback;if(typeof z=="function"){f.callback=null,p=f.priorityLevel;var H=z(f.expirationTime<=b);b=e.unstable_now(),typeof H=="function"?f.callback=H:f===n(c)&&r(c),w(b)}else r(c);f=n(c)}if(f!==null)var X=!0;else{var G=n(u);G!==null&&F(k,G.startTime-b),X=!1}return X}finally{f=null,p=D,m=!1}}var N=!1,T=null,P=-1,$=5,M=-1;function B(){return!(e.unstable_now()-M<$)}function W(){if(T!==null){var A=e.unstable_now();M=A;var b=!0;try{b=T(!0,A)}finally{b?V():(N=!1,T=null)}}else N=!1}var V;if(typeof g=="function")V=function(){g(W)};else if(typeof MessageChannel<"u"){var E=new MessageChannel,O=E.port2;E.port1.onmessage=W,V=function(){O.postMessage(null)}}else V=function(){j(W,0)};function L(A){T=A,N||(N=!0,V())}function F(A,b){P=j(function(){A(e.unstable_now())},b)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){y||m||(y=!0,L(C))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(A){switch(p){case 1:case 2:case 3:var b=3;break;default:b=p}var D=p;p=b;try{return A()}finally{p=D}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,b){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var D=p;p=A;try{return b()}finally{p=D}},e.unstable_scheduleCallback=function(A,b,D){var z=e.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?z+D:z):D=z,A){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=D+H,A={id:d++,callback:b,priorityLevel:A,startTime:D,expirationTime:H,sortIndex:-1},D>z?(A.sortIndex=D,t(u,A),n(c)===null&&A===n(u)&&(x?(h(P),P=-1):x=!0,F(k,D-z))):(A.sortIndex=H,t(c,A),y||m||(y=!0,L(C))),A},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(A){var b=p;return function(){var D=p;p=b;try{return A.apply(this,arguments)}finally{p=D}}}})(jh);Ch.exports=jh;var Ev=Ch.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _v=v,vt=Ev;function Y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Nh=new Set,Us={};function pr(e,t){Kr(e,t),Kr(e+"Capture",t)}function Kr(e,t){for(Us[e]=t,e=0;e<t.length;e++)Nh.add(t[e])}var mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vl=Object.prototype.hasOwnProperty,bv=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,td={},nd={};function Tv(e){return vl.call(nd,e)?!0:vl.call(td,e)?!1:bv.test(e)?nd[e]=!0:(td[e]=!0,!1)}function Pv(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Lv(e,t,n,r){if(t===null||typeof t>"u"||Pv(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function st(e,t,n,r,s,o,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var Xe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xe[e]=new st(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xe[t]=new st(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xe[e]=new st(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xe[e]=new st(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xe[e]=new st(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xe[e]=new st(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xe[e]=new st(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xe[e]=new st(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xe[e]=new st(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ac=/[\-:]([a-z])/g;function Dc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ac,Dc);Xe[t]=new st(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ac,Dc);Xe[t]=new st(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ac,Dc);Xe[t]=new st(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xe[e]=new st(e,1,!1,e.toLowerCase(),null,!1,!1)});Xe.xlinkHref=new st("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xe[e]=new st(e,1,!1,e.toLowerCase(),null,!0,!0)});function Oc(e,t,n,r){var s=Xe.hasOwnProperty(t)?Xe[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Lv(t,n,s,r)&&(n=null),r||s===null?Tv(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var kn=_v.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Po=Symbol.for("react.element"),jr=Symbol.for("react.portal"),Nr=Symbol.for("react.fragment"),Rc=Symbol.for("react.strict_mode"),xl=Symbol.for("react.profiler"),Eh=Symbol.for("react.provider"),_h=Symbol.for("react.context"),Ic=Symbol.for("react.forward_ref"),wl=Symbol.for("react.suspense"),Sl=Symbol.for("react.suspense_list"),zc=Symbol.for("react.memo"),En=Symbol.for("react.lazy"),bh=Symbol.for("react.offscreen"),rd=Symbol.iterator;function fs(e){return e===null||typeof e!="object"?null:(e=rd&&e[rd]||e["@@iterator"],typeof e=="function"?e:null)}var Le=Object.assign,Ta;function Es(e){if(Ta===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ta=t&&t[1]||""}return`
`+Ta+e}var Pa=!1;function La(e,t){if(!e||Pa)return"";Pa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{Pa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Es(e):""}function Mv(e){switch(e.tag){case 5:return Es(e.type);case 16:return Es("Lazy");case 13:return Es("Suspense");case 19:return Es("SuspenseList");case 0:case 2:case 15:return e=La(e.type,!1),e;case 11:return e=La(e.type.render,!1),e;case 1:return e=La(e.type,!0),e;default:return""}}function kl(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Nr:return"Fragment";case jr:return"Portal";case xl:return"Profiler";case Rc:return"StrictMode";case wl:return"Suspense";case Sl:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _h:return(e.displayName||"Context")+".Consumer";case Eh:return(e._context.displayName||"Context")+".Provider";case Ic:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zc:return t=e.displayName||null,t!==null?t:kl(e.type)||"Memo";case En:t=e._payload,e=e._init;try{return kl(e(t))}catch{}}return null}function $v(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kl(t);case 8:return t===Rc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Vn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Th(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Av(e){var t=Th(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Lo(e){e._valueTracker||(e._valueTracker=Av(e))}function Ph(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Th(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Si(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cl(e,t){var n=t.checked;return Le({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function sd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Vn(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Lh(e,t){t=t.checked,t!=null&&Oc(e,"checked",t,!1)}function jl(e,t){Lh(e,t);var n=Vn(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nl(e,t.type,n):t.hasOwnProperty("defaultValue")&&Nl(e,t.type,Vn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function od(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Nl(e,t,n){(t!=="number"||Si(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var _s=Array.isArray;function Rr(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Vn(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function El(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Y(91));return Le({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function id(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Y(92));if(_s(n)){if(1<n.length)throw Error(Y(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Vn(n)}}function Mh(e,t){var n=Vn(t.value),r=Vn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function ad(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $h(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _l(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$h(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Mo,Ah=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Mo=Mo||document.createElement("div"),Mo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Mo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Vs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var As={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dv=["Webkit","ms","Moz","O"];Object.keys(As).forEach(function(e){Dv.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),As[t]=As[e]})});function Dh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||As.hasOwnProperty(e)&&As[e]?(""+t).trim():t+"px"}function Oh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Dh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Ov=Le({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bl(e,t){if(t){if(Ov[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Y(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Y(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Y(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Y(62))}}function Tl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pl=null;function Fc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ll=null,Ir=null,zr=null;function ld(e){if(e=wo(e)){if(typeof Ll!="function")throw Error(Y(280));var t=e.stateNode;t&&(t=ia(t),Ll(e.stateNode,e.type,t))}}function Rh(e){Ir?zr?zr.push(e):zr=[e]:Ir=e}function Ih(){if(Ir){var e=Ir,t=zr;if(zr=Ir=null,ld(e),t)for(e=0;e<t.length;e++)ld(t[e])}}function zh(e,t){return e(t)}function Fh(){}var Ma=!1;function Bh(e,t,n){if(Ma)return e(t,n);Ma=!0;try{return zh(e,t,n)}finally{Ma=!1,(Ir!==null||zr!==null)&&(Fh(),Ih())}}function Ws(e,t){var n=e.stateNode;if(n===null)return null;var r=ia(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Y(231,t,typeof n));return n}var Ml=!1;if(mn)try{var hs={};Object.defineProperty(hs,"passive",{get:function(){Ml=!0}}),window.addEventListener("test",hs,hs),window.removeEventListener("test",hs,hs)}catch{Ml=!1}function Rv(e,t,n,r,s,o,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Ds=!1,ki=null,Ci=!1,$l=null,Iv={onError:function(e){Ds=!0,ki=e}};function zv(e,t,n,r,s,o,i,l,c){Ds=!1,ki=null,Rv.apply(Iv,arguments)}function Fv(e,t,n,r,s,o,i,l,c){if(zv.apply(this,arguments),Ds){if(Ds){var u=ki;Ds=!1,ki=null}else throw Error(Y(198));Ci||(Ci=!0,$l=u)}}function mr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Hh(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function cd(e){if(mr(e)!==e)throw Error(Y(188))}function Bv(e){var t=e.alternate;if(!t){if(t=mr(e),t===null)throw Error(Y(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return cd(s),e;if(o===r)return cd(s),t;o=o.sibling}throw Error(Y(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(Y(189))}}if(n.alternate!==r)throw Error(Y(190))}if(n.tag!==3)throw Error(Y(188));return n.stateNode.current===n?e:t}function Uh(e){return e=Bv(e),e!==null?Vh(e):null}function Vh(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Vh(e);if(t!==null)return t;e=e.sibling}return null}var Wh=vt.unstable_scheduleCallback,ud=vt.unstable_cancelCallback,Hv=vt.unstable_shouldYield,Uv=vt.unstable_requestPaint,Oe=vt.unstable_now,Vv=vt.unstable_getCurrentPriorityLevel,Bc=vt.unstable_ImmediatePriority,Yh=vt.unstable_UserBlockingPriority,ji=vt.unstable_NormalPriority,Wv=vt.unstable_LowPriority,Kh=vt.unstable_IdlePriority,na=null,Qt=null;function Yv(e){if(Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(na,e,void 0,(e.current.flags&128)===128)}catch{}}var Ft=Math.clz32?Math.clz32:Xv,Kv=Math.log,Gv=Math.LN2;function Xv(e){return e>>>=0,e===0?32:31-(Kv(e)/Gv|0)|0}var $o=64,Ao=4194304;function bs(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ni(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,o=e.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=bs(l):(o&=i,o!==0&&(r=bs(o)))}else i=n&~s,i!==0?r=bs(i):o!==0&&(r=bs(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,o=t&-t,s>=o||s===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Ft(t),s=1<<n,r|=e[n],t&=~s;return r}function Jv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qv(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,o=e.pendingLanes;0<o;){var i=31-Ft(o),l=1<<i,c=s[i];c===-1?(!(l&n)||l&r)&&(s[i]=Jv(l,t)):c<=t&&(e.expiredLanes|=l),o&=~l}}function Al(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Gh(){var e=$o;return $o<<=1,!($o&4194240)&&($o=64),e}function $a(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ft(t),e[t]=n}function Zv(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Ft(n),o=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~o}}function Hc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ft(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var ye=0;function Xh(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Jh,Uc,Qh,Zh,qh,Dl=!1,Do=[],Dn=null,On=null,Rn=null,Ys=new Map,Ks=new Map,Pn=[],qv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dd(e,t){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":On=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":Ys.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ks.delete(t.pointerId)}}function ps(e,t,n,r,s,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},t!==null&&(t=wo(t),t!==null&&Uc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function ex(e,t,n,r,s){switch(t){case"focusin":return Dn=ps(Dn,e,t,n,r,s),!0;case"dragenter":return On=ps(On,e,t,n,r,s),!0;case"mouseover":return Rn=ps(Rn,e,t,n,r,s),!0;case"pointerover":var o=s.pointerId;return Ys.set(o,ps(Ys.get(o)||null,e,t,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Ks.set(o,ps(Ks.get(o)||null,e,t,n,r,s)),!0}return!1}function ep(e){var t=Zn(e.target);if(t!==null){var n=mr(t);if(n!==null){if(t=n.tag,t===13){if(t=Hh(n),t!==null){e.blockedOn=t,qh(e.priority,function(){Qh(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function oi(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ol(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Pl=r,n.target.dispatchEvent(r),Pl=null}else return t=wo(n),t!==null&&Uc(t),e.blockedOn=n,!1;t.shift()}return!0}function fd(e,t,n){oi(e)&&n.delete(t)}function tx(){Dl=!1,Dn!==null&&oi(Dn)&&(Dn=null),On!==null&&oi(On)&&(On=null),Rn!==null&&oi(Rn)&&(Rn=null),Ys.forEach(fd),Ks.forEach(fd)}function ms(e,t){e.blockedOn===t&&(e.blockedOn=null,Dl||(Dl=!0,vt.unstable_scheduleCallback(vt.unstable_NormalPriority,tx)))}function Gs(e){function t(s){return ms(s,e)}if(0<Do.length){ms(Do[0],e);for(var n=1;n<Do.length;n++){var r=Do[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Dn!==null&&ms(Dn,e),On!==null&&ms(On,e),Rn!==null&&ms(Rn,e),Ys.forEach(t),Ks.forEach(t),n=0;n<Pn.length;n++)r=Pn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Pn.length&&(n=Pn[0],n.blockedOn===null);)ep(n),n.blockedOn===null&&Pn.shift()}var Fr=kn.ReactCurrentBatchConfig,Ei=!0;function nx(e,t,n,r){var s=ye,o=Fr.transition;Fr.transition=null;try{ye=1,Vc(e,t,n,r)}finally{ye=s,Fr.transition=o}}function rx(e,t,n,r){var s=ye,o=Fr.transition;Fr.transition=null;try{ye=4,Vc(e,t,n,r)}finally{ye=s,Fr.transition=o}}function Vc(e,t,n,r){if(Ei){var s=Ol(e,t,n,r);if(s===null)Ua(e,t,r,_i,n),dd(e,r);else if(ex(s,e,t,n,r))r.stopPropagation();else if(dd(e,r),t&4&&-1<qv.indexOf(e)){for(;s!==null;){var o=wo(s);if(o!==null&&Jh(o),o=Ol(e,t,n,r),o===null&&Ua(e,t,r,_i,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Ua(e,t,r,null,n)}}var _i=null;function Ol(e,t,n,r){if(_i=null,e=Fc(r),e=Zn(e),e!==null)if(t=mr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Hh(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return _i=e,null}function tp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Vv()){case Bc:return 1;case Yh:return 4;case ji:case Wv:return 16;case Kh:return 536870912;default:return 16}default:return 16}}var $n=null,Wc=null,ii=null;function np(){if(ii)return ii;var e,t=Wc,n=t.length,r,s="value"in $n?$n.value:$n.textContent,o=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===s[o-r];r++);return ii=s.slice(e,1<r?1-r:void 0)}function ai(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Oo(){return!0}function hd(){return!1}function St(e){function t(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Oo:hd,this.isPropagationStopped=hd,this}return Le(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Oo)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Oo)},persist:function(){},isPersistent:Oo}),t}var is={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yc=St(is),xo=Le({},is,{view:0,detail:0}),sx=St(xo),Aa,Da,gs,ra=Le({},xo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gs&&(gs&&e.type==="mousemove"?(Aa=e.screenX-gs.screenX,Da=e.screenY-gs.screenY):Da=Aa=0,gs=e),Aa)},movementY:function(e){return"movementY"in e?e.movementY:Da}}),pd=St(ra),ox=Le({},ra,{dataTransfer:0}),ix=St(ox),ax=Le({},xo,{relatedTarget:0}),Oa=St(ax),lx=Le({},is,{animationName:0,elapsedTime:0,pseudoElement:0}),cx=St(lx),ux=Le({},is,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dx=St(ux),fx=Le({},is,{data:0}),md=St(fx),hx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},px={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=mx[e])?!!t[e]:!1}function Kc(){return gx}var yx=Le({},xo,{key:function(e){if(e.key){var t=hx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ai(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?px[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kc,charCode:function(e){return e.type==="keypress"?ai(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ai(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),vx=St(yx),xx=Le({},ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gd=St(xx),wx=Le({},xo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kc}),Sx=St(wx),kx=Le({},is,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cx=St(kx),jx=Le({},ra,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Nx=St(jx),Ex=[9,13,27,32],Gc=mn&&"CompositionEvent"in window,Os=null;mn&&"documentMode"in document&&(Os=document.documentMode);var _x=mn&&"TextEvent"in window&&!Os,rp=mn&&(!Gc||Os&&8<Os&&11>=Os),yd=String.fromCharCode(32),vd=!1;function sp(e,t){switch(e){case"keyup":return Ex.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function op(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Er=!1;function bx(e,t){switch(e){case"compositionend":return op(t);case"keypress":return t.which!==32?null:(vd=!0,yd);case"textInput":return e=t.data,e===yd&&vd?null:e;default:return null}}function Tx(e,t){if(Er)return e==="compositionend"||!Gc&&sp(e,t)?(e=np(),ii=Wc=$n=null,Er=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rp&&t.locale!=="ko"?null:t.data;default:return null}}var Px={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Px[e.type]:t==="textarea"}function ip(e,t,n,r){Rh(r),t=bi(t,"onChange"),0<t.length&&(n=new Yc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Rs=null,Xs=null;function Lx(e){yp(e,0)}function sa(e){var t=Tr(e);if(Ph(t))return e}function Mx(e,t){if(e==="change")return t}var ap=!1;if(mn){var Ra;if(mn){var Ia="oninput"in document;if(!Ia){var wd=document.createElement("div");wd.setAttribute("oninput","return;"),Ia=typeof wd.oninput=="function"}Ra=Ia}else Ra=!1;ap=Ra&&(!document.documentMode||9<document.documentMode)}function Sd(){Rs&&(Rs.detachEvent("onpropertychange",lp),Xs=Rs=null)}function lp(e){if(e.propertyName==="value"&&sa(Xs)){var t=[];ip(t,Xs,e,Fc(e)),Bh(Lx,t)}}function $x(e,t,n){e==="focusin"?(Sd(),Rs=t,Xs=n,Rs.attachEvent("onpropertychange",lp)):e==="focusout"&&Sd()}function Ax(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return sa(Xs)}function Dx(e,t){if(e==="click")return sa(t)}function Ox(e,t){if(e==="input"||e==="change")return sa(t)}function Rx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ht=typeof Object.is=="function"?Object.is:Rx;function Js(e,t){if(Ht(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!vl.call(t,s)||!Ht(e[s],t[s]))return!1}return!0}function kd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cd(e,t){var n=kd(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kd(n)}}function cp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function up(){for(var e=window,t=Si();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Si(e.document)}return t}function Xc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ix(e){var t=up(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&cp(n.ownerDocument.documentElement,n)){if(r!==null&&Xc(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!e.extend&&o>r&&(s=r,r=o,o=s),s=Cd(n,o);var i=Cd(n,r);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var zx=mn&&"documentMode"in document&&11>=document.documentMode,_r=null,Rl=null,Is=null,Il=!1;function jd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Il||_r==null||_r!==Si(r)||(r=_r,"selectionStart"in r&&Xc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Is&&Js(Is,r)||(Is=r,r=bi(Rl,"onSelect"),0<r.length&&(t=new Yc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=_r)))}function Ro(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var br={animationend:Ro("Animation","AnimationEnd"),animationiteration:Ro("Animation","AnimationIteration"),animationstart:Ro("Animation","AnimationStart"),transitionend:Ro("Transition","TransitionEnd")},za={},dp={};mn&&(dp=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);function oa(e){if(za[e])return za[e];if(!br[e])return e;var t=br[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in dp)return za[e]=t[n];return e}var fp=oa("animationend"),hp=oa("animationiteration"),pp=oa("animationstart"),mp=oa("transitionend"),gp=new Map,Nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yn(e,t){gp.set(e,t),pr(t,[e])}for(var Fa=0;Fa<Nd.length;Fa++){var Ba=Nd[Fa],Fx=Ba.toLowerCase(),Bx=Ba[0].toUpperCase()+Ba.slice(1);Yn(Fx,"on"+Bx)}Yn(fp,"onAnimationEnd");Yn(hp,"onAnimationIteration");Yn(pp,"onAnimationStart");Yn("dblclick","onDoubleClick");Yn("focusin","onFocus");Yn("focusout","onBlur");Yn(mp,"onTransitionEnd");Kr("onMouseEnter",["mouseout","mouseover"]);Kr("onMouseLeave",["mouseout","mouseover"]);Kr("onPointerEnter",["pointerout","pointerover"]);Kr("onPointerLeave",["pointerout","pointerover"]);pr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pr("onBeforeInput",["compositionend","keypress","textInput","paste"]);pr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ts="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ts));function Ed(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Fv(r,t,void 0,e),e.currentTarget=null}function yp(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var l=r[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==o&&s.isPropagationStopped())break e;Ed(s,l,u),o=c}else for(i=0;i<r.length;i++){if(l=r[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==o&&s.isPropagationStopped())break e;Ed(s,l,u),o=c}}}if(Ci)throw e=$l,Ci=!1,$l=null,e}function Ce(e,t){var n=t[Ul];n===void 0&&(n=t[Ul]=new Set);var r=e+"__bubble";n.has(r)||(vp(t,e,2,!1),n.add(r))}function Ha(e,t,n){var r=0;t&&(r|=4),vp(n,e,r,t)}var Io="_reactListening"+Math.random().toString(36).slice(2);function Qs(e){if(!e[Io]){e[Io]=!0,Nh.forEach(function(n){n!=="selectionchange"&&(Hx.has(n)||Ha(n,!1,e),Ha(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Io]||(t[Io]=!0,Ha("selectionchange",!1,t))}}function vp(e,t,n,r){switch(tp(t)){case 1:var s=nx;break;case 4:s=rx;break;default:s=Vc}n=s.bind(null,t,n,e),s=void 0,!Ml||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Ua(e,t,n,r,s){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=Zn(l),i===null)return;if(c=i.tag,c===5||c===6){r=o=i;continue e}l=l.parentNode}}r=r.return}Bh(function(){var u=o,d=Fc(n),f=[];e:{var p=gp.get(e);if(p!==void 0){var m=Yc,y=e;switch(e){case"keypress":if(ai(n)===0)break e;case"keydown":case"keyup":m=vx;break;case"focusin":y="focus",m=Oa;break;case"focusout":y="blur",m=Oa;break;case"beforeblur":case"afterblur":m=Oa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=pd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ix;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Sx;break;case fp:case hp:case pp:m=cx;break;case mp:m=Cx;break;case"scroll":m=sx;break;case"wheel":m=Nx;break;case"copy":case"cut":case"paste":m=dx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=gd}var x=(t&4)!==0,j=!x&&e==="scroll",h=x?p!==null?p+"Capture":null:p;x=[];for(var g=u,w;g!==null;){w=g;var k=w.stateNode;if(w.tag===5&&k!==null&&(w=k,h!==null&&(k=Ws(g,h),k!=null&&x.push(Zs(g,k,w)))),j)break;g=g.return}0<x.length&&(p=new m(p,y,null,n,d),f.push({event:p,listeners:x}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&n!==Pl&&(y=n.relatedTarget||n.fromElement)&&(Zn(y)||y[gn]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(y=n.relatedTarget||n.toElement,m=u,y=y?Zn(y):null,y!==null&&(j=mr(y),y!==j||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=pd,k="onMouseLeave",h="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(x=gd,k="onPointerLeave",h="onPointerEnter",g="pointer"),j=m==null?p:Tr(m),w=y==null?p:Tr(y),p=new x(k,g+"leave",m,n,d),p.target=j,p.relatedTarget=w,k=null,Zn(d)===u&&(x=new x(h,g+"enter",y,n,d),x.target=w,x.relatedTarget=j,k=x),j=k,m&&y)t:{for(x=m,h=y,g=0,w=x;w;w=vr(w))g++;for(w=0,k=h;k;k=vr(k))w++;for(;0<g-w;)x=vr(x),g--;for(;0<w-g;)h=vr(h),w--;for(;g--;){if(x===h||h!==null&&x===h.alternate)break t;x=vr(x),h=vr(h)}x=null}else x=null;m!==null&&_d(f,p,m,x,!1),y!==null&&j!==null&&_d(f,j,y,x,!0)}}e:{if(p=u?Tr(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var C=Mx;else if(xd(p))if(ap)C=Ox;else{C=Ax;var N=$x}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=Dx);if(C&&(C=C(e,u))){ip(f,C,n,d);break e}N&&N(e,p,u),e==="focusout"&&(N=p._wrapperState)&&N.controlled&&p.type==="number"&&Nl(p,"number",p.value)}switch(N=u?Tr(u):window,e){case"focusin":(xd(N)||N.contentEditable==="true")&&(_r=N,Rl=u,Is=null);break;case"focusout":Is=Rl=_r=null;break;case"mousedown":Il=!0;break;case"contextmenu":case"mouseup":case"dragend":Il=!1,jd(f,n,d);break;case"selectionchange":if(zx)break;case"keydown":case"keyup":jd(f,n,d)}var T;if(Gc)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Er?sp(e,n)&&(P="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(rp&&n.locale!=="ko"&&(Er||P!=="onCompositionStart"?P==="onCompositionEnd"&&Er&&(T=np()):($n=d,Wc="value"in $n?$n.value:$n.textContent,Er=!0)),N=bi(u,P),0<N.length&&(P=new md(P,e,null,n,d),f.push({event:P,listeners:N}),T?P.data=T:(T=op(n),T!==null&&(P.data=T)))),(T=_x?bx(e,n):Tx(e,n))&&(u=bi(u,"onBeforeInput"),0<u.length&&(d=new md("onBeforeInput","beforeinput",null,n,d),f.push({event:d,listeners:u}),d.data=T))}yp(f,t)})}function Zs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function bi(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Ws(e,n),o!=null&&r.unshift(Zs(e,o,s)),o=Ws(e,t),o!=null&&r.push(Zs(e,o,s))),e=e.return}return r}function vr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _d(e,t,n,r,s){for(var o=t._reactName,i=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Ws(n,o),c!=null&&i.unshift(Zs(n,c,l))):s||(c=Ws(n,o),c!=null&&i.push(Zs(n,c,l)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var Ux=/\r\n?/g,Vx=/\u0000|\uFFFD/g;function bd(e){return(typeof e=="string"?e:""+e).replace(Ux,`
`).replace(Vx,"")}function zo(e,t,n){if(t=bd(t),bd(e)!==t&&n)throw Error(Y(425))}function Ti(){}var zl=null,Fl=null;function Bl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Hl=typeof setTimeout=="function"?setTimeout:void 0,Wx=typeof clearTimeout=="function"?clearTimeout:void 0,Td=typeof Promise=="function"?Promise:void 0,Yx=typeof queueMicrotask=="function"?queueMicrotask:typeof Td<"u"?function(e){return Td.resolve(null).then(e).catch(Kx)}:Hl;function Kx(e){setTimeout(function(){throw e})}function Va(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Gs(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Gs(t)}function In(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Pd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var as=Math.random().toString(36).slice(2),Jt="__reactFiber$"+as,qs="__reactProps$"+as,gn="__reactContainer$"+as,Ul="__reactEvents$"+as,Gx="__reactListeners$"+as,Xx="__reactHandles$"+as;function Zn(e){var t=e[Jt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gn]||n[Jt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Pd(e);e!==null;){if(n=e[Jt])return n;e=Pd(e)}return t}e=n,n=e.parentNode}return null}function wo(e){return e=e[Jt]||e[gn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Tr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Y(33))}function ia(e){return e[qs]||null}var Vl=[],Pr=-1;function Kn(e){return{current:e}}function je(e){0>Pr||(e.current=Vl[Pr],Vl[Pr]=null,Pr--)}function Se(e,t){Pr++,Vl[Pr]=e.current,e.current=t}var Wn={},qe=Kn(Wn),ut=Kn(!1),ar=Wn;function Gr(e,t){var n=e.type.contextTypes;if(!n)return Wn;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function dt(e){return e=e.childContextTypes,e!=null}function Pi(){je(ut),je(qe)}function Ld(e,t,n){if(qe.current!==Wn)throw Error(Y(168));Se(qe,t),Se(ut,n)}function xp(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(Y(108,$v(e)||"Unknown",s));return Le({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Wn,ar=qe.current,Se(qe,e),Se(ut,ut.current),!0}function Md(e,t,n){var r=e.stateNode;if(!r)throw Error(Y(169));n?(e=xp(e,t,ar),r.__reactInternalMemoizedMergedChildContext=e,je(ut),je(qe),Se(qe,e)):je(ut),Se(ut,n)}var ln=null,aa=!1,Wa=!1;function wp(e){ln===null?ln=[e]:ln.push(e)}function Jx(e){aa=!0,wp(e)}function Gn(){if(!Wa&&ln!==null){Wa=!0;var e=0,t=ye;try{var n=ln;for(ye=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ln=null,aa=!1}catch(s){throw ln!==null&&(ln=ln.slice(e+1)),Wh(Bc,Gn),s}finally{ye=t,Wa=!1}}return null}var Lr=[],Mr=0,Mi=null,$i=0,jt=[],Nt=0,lr=null,cn=1,un="";function Xn(e,t){Lr[Mr++]=$i,Lr[Mr++]=Mi,Mi=e,$i=t}function Sp(e,t,n){jt[Nt++]=cn,jt[Nt++]=un,jt[Nt++]=lr,lr=e;var r=cn;e=un;var s=32-Ft(r)-1;r&=~(1<<s),n+=1;var o=32-Ft(t)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,cn=1<<32-Ft(t)+s|n<<s|r,un=o+e}else cn=1<<o|n<<s|r,un=e}function Jc(e){e.return!==null&&(Xn(e,1),Sp(e,1,0))}function Qc(e){for(;e===Mi;)Mi=Lr[--Mr],Lr[Mr]=null,$i=Lr[--Mr],Lr[Mr]=null;for(;e===lr;)lr=jt[--Nt],jt[Nt]=null,un=jt[--Nt],jt[Nt]=null,cn=jt[--Nt],jt[Nt]=null}var yt=null,gt=null,_e=!1,It=null;function kp(e,t){var n=bt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function $d(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,yt=e,gt=In(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,yt=e,gt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=lr!==null?{id:cn,overflow:un}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=bt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,yt=e,gt=null,!0):!1;default:return!1}}function Wl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yl(e){if(_e){var t=gt;if(t){var n=t;if(!$d(e,t)){if(Wl(e))throw Error(Y(418));t=In(n.nextSibling);var r=yt;t&&$d(e,t)?kp(r,n):(e.flags=e.flags&-4097|2,_e=!1,yt=e)}}else{if(Wl(e))throw Error(Y(418));e.flags=e.flags&-4097|2,_e=!1,yt=e}}}function Ad(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;yt=e}function Fo(e){if(e!==yt)return!1;if(!_e)return Ad(e),_e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Bl(e.type,e.memoizedProps)),t&&(t=gt)){if(Wl(e))throw Cp(),Error(Y(418));for(;t;)kp(e,t),t=In(t.nextSibling)}if(Ad(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Y(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){gt=In(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}gt=null}}else gt=yt?In(e.stateNode.nextSibling):null;return!0}function Cp(){for(var e=gt;e;)e=In(e.nextSibling)}function Xr(){gt=yt=null,_e=!1}function Zc(e){It===null?It=[e]:It.push(e)}var Qx=kn.ReactCurrentBatchConfig;function ys(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Y(309));var r=n.stateNode}if(!r)throw Error(Y(147,e));var s=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},t._stringRef=o,t)}if(typeof e!="string")throw Error(Y(284));if(!n._owner)throw Error(Y(290,e))}return e}function Bo(e,t){throw e=Object.prototype.toString.call(t),Error(Y(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Dd(e){var t=e._init;return t(e._payload)}function jp(e){function t(h,g){if(e){var w=h.deletions;w===null?(h.deletions=[g],h.flags|=16):w.push(g)}}function n(h,g){if(!e)return null;for(;g!==null;)t(h,g),g=g.sibling;return null}function r(h,g){for(h=new Map;g!==null;)g.key!==null?h.set(g.key,g):h.set(g.index,g),g=g.sibling;return h}function s(h,g){return h=Hn(h,g),h.index=0,h.sibling=null,h}function o(h,g,w){return h.index=w,e?(w=h.alternate,w!==null?(w=w.index,w<g?(h.flags|=2,g):w):(h.flags|=2,g)):(h.flags|=1048576,g)}function i(h){return e&&h.alternate===null&&(h.flags|=2),h}function l(h,g,w,k){return g===null||g.tag!==6?(g=Za(w,h.mode,k),g.return=h,g):(g=s(g,w),g.return=h,g)}function c(h,g,w,k){var C=w.type;return C===Nr?d(h,g,w.props.children,k,w.key):g!==null&&(g.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===En&&Dd(C)===g.type)?(k=s(g,w.props),k.ref=ys(h,g,w),k.return=h,k):(k=pi(w.type,w.key,w.props,null,h.mode,k),k.ref=ys(h,g,w),k.return=h,k)}function u(h,g,w,k){return g===null||g.tag!==4||g.stateNode.containerInfo!==w.containerInfo||g.stateNode.implementation!==w.implementation?(g=qa(w,h.mode,k),g.return=h,g):(g=s(g,w.children||[]),g.return=h,g)}function d(h,g,w,k,C){return g===null||g.tag!==7?(g=sr(w,h.mode,k,C),g.return=h,g):(g=s(g,w),g.return=h,g)}function f(h,g,w){if(typeof g=="string"&&g!==""||typeof g=="number")return g=Za(""+g,h.mode,w),g.return=h,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case Po:return w=pi(g.type,g.key,g.props,null,h.mode,w),w.ref=ys(h,null,g),w.return=h,w;case jr:return g=qa(g,h.mode,w),g.return=h,g;case En:var k=g._init;return f(h,k(g._payload),w)}if(_s(g)||fs(g))return g=sr(g,h.mode,w,null),g.return=h,g;Bo(h,g)}return null}function p(h,g,w,k){var C=g!==null?g.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:l(h,g,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Po:return w.key===C?c(h,g,w,k):null;case jr:return w.key===C?u(h,g,w,k):null;case En:return C=w._init,p(h,g,C(w._payload),k)}if(_s(w)||fs(w))return C!==null?null:d(h,g,w,k,null);Bo(h,w)}return null}function m(h,g,w,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return h=h.get(w)||null,l(g,h,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Po:return h=h.get(k.key===null?w:k.key)||null,c(g,h,k,C);case jr:return h=h.get(k.key===null?w:k.key)||null,u(g,h,k,C);case En:var N=k._init;return m(h,g,w,N(k._payload),C)}if(_s(k)||fs(k))return h=h.get(w)||null,d(g,h,k,C,null);Bo(g,k)}return null}function y(h,g,w,k){for(var C=null,N=null,T=g,P=g=0,$=null;T!==null&&P<w.length;P++){T.index>P?($=T,T=null):$=T.sibling;var M=p(h,T,w[P],k);if(M===null){T===null&&(T=$);break}e&&T&&M.alternate===null&&t(h,T),g=o(M,g,P),N===null?C=M:N.sibling=M,N=M,T=$}if(P===w.length)return n(h,T),_e&&Xn(h,P),C;if(T===null){for(;P<w.length;P++)T=f(h,w[P],k),T!==null&&(g=o(T,g,P),N===null?C=T:N.sibling=T,N=T);return _e&&Xn(h,P),C}for(T=r(h,T);P<w.length;P++)$=m(T,h,P,w[P],k),$!==null&&(e&&$.alternate!==null&&T.delete($.key===null?P:$.key),g=o($,g,P),N===null?C=$:N.sibling=$,N=$);return e&&T.forEach(function(B){return t(h,B)}),_e&&Xn(h,P),C}function x(h,g,w,k){var C=fs(w);if(typeof C!="function")throw Error(Y(150));if(w=C.call(w),w==null)throw Error(Y(151));for(var N=C=null,T=g,P=g=0,$=null,M=w.next();T!==null&&!M.done;P++,M=w.next()){T.index>P?($=T,T=null):$=T.sibling;var B=p(h,T,M.value,k);if(B===null){T===null&&(T=$);break}e&&T&&B.alternate===null&&t(h,T),g=o(B,g,P),N===null?C=B:N.sibling=B,N=B,T=$}if(M.done)return n(h,T),_e&&Xn(h,P),C;if(T===null){for(;!M.done;P++,M=w.next())M=f(h,M.value,k),M!==null&&(g=o(M,g,P),N===null?C=M:N.sibling=M,N=M);return _e&&Xn(h,P),C}for(T=r(h,T);!M.done;P++,M=w.next())M=m(T,h,P,M.value,k),M!==null&&(e&&M.alternate!==null&&T.delete(M.key===null?P:M.key),g=o(M,g,P),N===null?C=M:N.sibling=M,N=M);return e&&T.forEach(function(W){return t(h,W)}),_e&&Xn(h,P),C}function j(h,g,w,k){if(typeof w=="object"&&w!==null&&w.type===Nr&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Po:e:{for(var C=w.key,N=g;N!==null;){if(N.key===C){if(C=w.type,C===Nr){if(N.tag===7){n(h,N.sibling),g=s(N,w.props.children),g.return=h,h=g;break e}}else if(N.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===En&&Dd(C)===N.type){n(h,N.sibling),g=s(N,w.props),g.ref=ys(h,N,w),g.return=h,h=g;break e}n(h,N);break}else t(h,N);N=N.sibling}w.type===Nr?(g=sr(w.props.children,h.mode,k,w.key),g.return=h,h=g):(k=pi(w.type,w.key,w.props,null,h.mode,k),k.ref=ys(h,g,w),k.return=h,h=k)}return i(h);case jr:e:{for(N=w.key;g!==null;){if(g.key===N)if(g.tag===4&&g.stateNode.containerInfo===w.containerInfo&&g.stateNode.implementation===w.implementation){n(h,g.sibling),g=s(g,w.children||[]),g.return=h,h=g;break e}else{n(h,g);break}else t(h,g);g=g.sibling}g=qa(w,h.mode,k),g.return=h,h=g}return i(h);case En:return N=w._init,j(h,g,N(w._payload),k)}if(_s(w))return y(h,g,w,k);if(fs(w))return x(h,g,w,k);Bo(h,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,g!==null&&g.tag===6?(n(h,g.sibling),g=s(g,w),g.return=h,h=g):(n(h,g),g=Za(w,h.mode,k),g.return=h,h=g),i(h)):n(h,g)}return j}var Jr=jp(!0),Np=jp(!1),Ai=Kn(null),Di=null,$r=null,qc=null;function eu(){qc=$r=Di=null}function tu(e){var t=Ai.current;je(Ai),e._currentValue=t}function Kl(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Br(e,t){Di=e,qc=$r=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(lt=!0),e.firstContext=null)}function Lt(e){var t=e._currentValue;if(qc!==e)if(e={context:e,memoizedValue:t,next:null},$r===null){if(Di===null)throw Error(Y(308));$r=e,Di.dependencies={lanes:0,firstContext:e}}else $r=$r.next=e;return t}var qn=null;function nu(e){qn===null?qn=[e]:qn.push(e)}function Ep(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,nu(t)):(n.next=s.next,s.next=n),t.interleaved=n,yn(e,r)}function yn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var _n=!1;function ru(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _p(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zn(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,yn(e,n)}return s=r.interleaved,s===null?(t.next=t,nu(r)):(t.next=s.next,s.next=t),r.interleaved=t,yn(e,n)}function li(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Hc(e,n)}}function Od(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=t:o=o.next=t}else s=o=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Oi(e,t,n,r){var s=e.updateQueue;_n=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?o=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(o!==null){var f=s.baseState;i=0,d=u=c=null,l=o;do{var p=l.lane,m=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,x=l;switch(p=t,m=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){f=y.call(m,f,p);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,p=typeof y=="function"?y.call(m,f,p):y,p==null)break e;f=Le({},f,p);break e;case 2:_n=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else m={eventTime:m,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else o===null&&(s.shared.lanes=0);ur|=i,e.lanes=i,e.memoizedState=f}}function Rd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Y(191,s));s.call(r)}}}var So={},Zt=Kn(So),eo=Kn(So),to=Kn(So);function er(e){if(e===So)throw Error(Y(174));return e}function su(e,t){switch(Se(to,t),Se(eo,e),Se(Zt,So),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:_l(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=_l(t,e)}je(Zt),Se(Zt,t)}function Qr(){je(Zt),je(eo),je(to)}function bp(e){er(to.current);var t=er(Zt.current),n=_l(t,e.type);t!==n&&(Se(eo,e),Se(Zt,n))}function ou(e){eo.current===e&&(je(Zt),je(eo))}var be=Kn(0);function Ri(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ya=[];function iu(){for(var e=0;e<Ya.length;e++)Ya[e]._workInProgressVersionPrimary=null;Ya.length=0}var ci=kn.ReactCurrentDispatcher,Ka=kn.ReactCurrentBatchConfig,cr=0,Te=null,Fe=null,Ve=null,Ii=!1,zs=!1,no=0,Zx=0;function Je(){throw Error(Y(321))}function au(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ht(e[n],t[n]))return!1;return!0}function lu(e,t,n,r,s,o){if(cr=o,Te=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ci.current=e===null||e.memoizedState===null?n0:r0,e=n(r,s),zs){o=0;do{if(zs=!1,no=0,25<=o)throw Error(Y(301));o+=1,Ve=Fe=null,t.updateQueue=null,ci.current=s0,e=n(r,s)}while(zs)}if(ci.current=zi,t=Fe!==null&&Fe.next!==null,cr=0,Ve=Fe=Te=null,Ii=!1,t)throw Error(Y(300));return e}function cu(){var e=no!==0;return no=0,e}function Xt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ve===null?Te.memoizedState=Ve=e:Ve=Ve.next=e,Ve}function Mt(){if(Fe===null){var e=Te.alternate;e=e!==null?e.memoizedState:null}else e=Fe.next;var t=Ve===null?Te.memoizedState:Ve.next;if(t!==null)Ve=t,Fe=e;else{if(e===null)throw Error(Y(310));Fe=e,e={memoizedState:Fe.memoizedState,baseState:Fe.baseState,baseQueue:Fe.baseQueue,queue:Fe.queue,next:null},Ve===null?Te.memoizedState=Ve=e:Ve=Ve.next=e}return Ve}function ro(e,t){return typeof t=="function"?t(e):t}function Ga(e){var t=Mt(),n=t.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=e;var r=Fe,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,c=null,u=o;do{var d=u.lane;if((cr&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,i=r):c=c.next=f,Te.lanes|=d,ur|=d}u=u.next}while(u!==null&&u!==o);c===null?i=r:c.next=l,Ht(r,t.memoizedState)||(lt=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do o=s.lane,Te.lanes|=o,ur|=o,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Xa(e){var t=Mt(),n=t.queue;if(n===null)throw Error(Y(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,o=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=e(o,i.action),i=i.next;while(i!==s);Ht(o,t.memoizedState)||(lt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Tp(){}function Pp(e,t){var n=Te,r=Mt(),s=t(),o=!Ht(r.memoizedState,s);if(o&&(r.memoizedState=s,lt=!0),r=r.queue,uu($p.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||Ve!==null&&Ve.memoizedState.tag&1){if(n.flags|=2048,so(9,Mp.bind(null,n,r,s,t),void 0,null),We===null)throw Error(Y(349));cr&30||Lp(n,t,s)}return s}function Lp(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Mp(e,t,n,r){t.value=n,t.getSnapshot=r,Ap(t)&&Dp(e)}function $p(e,t,n){return n(function(){Ap(t)&&Dp(e)})}function Ap(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ht(e,n)}catch{return!0}}function Dp(e){var t=yn(e,1);t!==null&&Bt(t,e,1,-1)}function Id(e){var t=Xt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ro,lastRenderedState:e},t.queue=e,e=e.dispatch=t0.bind(null,Te,e),[t.memoizedState,e]}function so(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Te.updateQueue,t===null?(t={lastEffect:null,stores:null},Te.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Op(){return Mt().memoizedState}function ui(e,t,n,r){var s=Xt();Te.flags|=e,s.memoizedState=so(1|t,n,void 0,r===void 0?null:r)}function la(e,t,n,r){var s=Mt();r=r===void 0?null:r;var o=void 0;if(Fe!==null){var i=Fe.memoizedState;if(o=i.destroy,r!==null&&au(r,i.deps)){s.memoizedState=so(t,n,o,r);return}}Te.flags|=e,s.memoizedState=so(1|t,n,o,r)}function zd(e,t){return ui(8390656,8,e,t)}function uu(e,t){return la(2048,8,e,t)}function Rp(e,t){return la(4,2,e,t)}function Ip(e,t){return la(4,4,e,t)}function zp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Fp(e,t,n){return n=n!=null?n.concat([e]):null,la(4,4,zp.bind(null,t,e),n)}function du(){}function Bp(e,t){var n=Mt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&au(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Hp(e,t){var n=Mt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&au(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Up(e,t,n){return cr&21?(Ht(n,t)||(n=Gh(),Te.lanes|=n,ur|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,lt=!0),e.memoizedState=n)}function qx(e,t){var n=ye;ye=n!==0&&4>n?n:4,e(!0);var r=Ka.transition;Ka.transition={};try{e(!1),t()}finally{ye=n,Ka.transition=r}}function Vp(){return Mt().memoizedState}function e0(e,t,n){var r=Bn(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Wp(e))Yp(t,n);else if(n=Ep(e,t,n,r),n!==null){var s=nt();Bt(n,e,r,s),Kp(n,t,r)}}function t0(e,t,n){var r=Bn(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wp(e))Yp(t,s);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var i=t.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,Ht(l,i)){var c=t.interleaved;c===null?(s.next=s,nu(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Ep(e,t,s,r),n!==null&&(s=nt(),Bt(n,e,r,s),Kp(n,t,r))}}function Wp(e){var t=e.alternate;return e===Te||t!==null&&t===Te}function Yp(e,t){zs=Ii=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Kp(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Hc(e,n)}}var zi={readContext:Lt,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useInsertionEffect:Je,useLayoutEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useMutableSource:Je,useSyncExternalStore:Je,useId:Je,unstable_isNewReconciler:!1},n0={readContext:Lt,useCallback:function(e,t){return Xt().memoizedState=[e,t===void 0?null:t],e},useContext:Lt,useEffect:zd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ui(4194308,4,zp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ui(4194308,4,e,t)},useInsertionEffect:function(e,t){return ui(4,2,e,t)},useMemo:function(e,t){var n=Xt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Xt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=e0.bind(null,Te,e),[r.memoizedState,e]},useRef:function(e){var t=Xt();return e={current:e},t.memoizedState=e},useState:Id,useDebugValue:du,useDeferredValue:function(e){return Xt().memoizedState=e},useTransition:function(){var e=Id(!1),t=e[0];return e=qx.bind(null,e[1]),Xt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Te,s=Xt();if(_e){if(n===void 0)throw Error(Y(407));n=n()}else{if(n=t(),We===null)throw Error(Y(349));cr&30||Lp(r,t,n)}s.memoizedState=n;var o={value:n,getSnapshot:t};return s.queue=o,zd($p.bind(null,r,o,e),[e]),r.flags|=2048,so(9,Mp.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Xt(),t=We.identifierPrefix;if(_e){var n=un,r=cn;n=(r&~(1<<32-Ft(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=no++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Zx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},r0={readContext:Lt,useCallback:Bp,useContext:Lt,useEffect:uu,useImperativeHandle:Fp,useInsertionEffect:Rp,useLayoutEffect:Ip,useMemo:Hp,useReducer:Ga,useRef:Op,useState:function(){return Ga(ro)},useDebugValue:du,useDeferredValue:function(e){var t=Mt();return Up(t,Fe.memoizedState,e)},useTransition:function(){var e=Ga(ro)[0],t=Mt().memoizedState;return[e,t]},useMutableSource:Tp,useSyncExternalStore:Pp,useId:Vp,unstable_isNewReconciler:!1},s0={readContext:Lt,useCallback:Bp,useContext:Lt,useEffect:uu,useImperativeHandle:Fp,useInsertionEffect:Rp,useLayoutEffect:Ip,useMemo:Hp,useReducer:Xa,useRef:Op,useState:function(){return Xa(ro)},useDebugValue:du,useDeferredValue:function(e){var t=Mt();return Fe===null?t.memoizedState=e:Up(t,Fe.memoizedState,e)},useTransition:function(){var e=Xa(ro)[0],t=Mt().memoizedState;return[e,t]},useMutableSource:Tp,useSyncExternalStore:Pp,useId:Vp,unstable_isNewReconciler:!1};function Dt(e,t){if(e&&e.defaultProps){t=Le({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Gl(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Le({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ca={isMounted:function(e){return(e=e._reactInternals)?mr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=nt(),s=Bn(e),o=fn(r,s);o.payload=t,n!=null&&(o.callback=n),t=zn(e,o,s),t!==null&&(Bt(t,e,s,r),li(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=nt(),s=Bn(e),o=fn(r,s);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=zn(e,o,s),t!==null&&(Bt(t,e,s,r),li(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=nt(),r=Bn(e),s=fn(n,r);s.tag=2,t!=null&&(s.callback=t),t=zn(e,s,r),t!==null&&(Bt(t,e,r,n),li(t,e,r))}};function Fd(e,t,n,r,s,o,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,i):t.prototype&&t.prototype.isPureReactComponent?!Js(n,r)||!Js(s,o):!0}function Gp(e,t,n){var r=!1,s=Wn,o=t.contextType;return typeof o=="object"&&o!==null?o=Lt(o):(s=dt(t)?ar:qe.current,r=t.contextTypes,o=(r=r!=null)?Gr(e,s):Wn),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ca,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=o),t}function Bd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ca.enqueueReplaceState(t,t.state,null)}function Xl(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},ru(e);var o=t.contextType;typeof o=="object"&&o!==null?s.context=Lt(o):(o=dt(t)?ar:qe.current,s.context=Gr(e,o)),s.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Gl(e,t,o,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&ca.enqueueReplaceState(s,s.state,null),Oi(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Zr(e,t){try{var n="",r=t;do n+=Mv(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:s,digest:null}}function Ja(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Jl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var o0=typeof WeakMap=="function"?WeakMap:Map;function Xp(e,t,n){n=fn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Bi||(Bi=!0,ic=r),Jl(e,t)},n}function Jp(e,t,n){n=fn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Jl(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Jl(e,t),typeof r!="function"&&(Fn===null?Fn=new Set([this]):Fn.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Hd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new o0;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=x0.bind(null,e,t,n),t.then(e,e))}function Ud(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Vd(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=fn(-1,1),t.tag=2,zn(n,t,1))),n.lanes|=1),e)}var i0=kn.ReactCurrentOwner,lt=!1;function tt(e,t,n,r){t.child=e===null?Np(t,null,n,r):Jr(t,e.child,n,r)}function Wd(e,t,n,r,s){n=n.render;var o=t.ref;return Br(t,s),r=lu(e,t,n,r,o,s),n=cu(),e!==null&&!lt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vn(e,t,s)):(_e&&n&&Jc(t),t.flags|=1,tt(e,t,r,s),t.child)}function Yd(e,t,n,r,s){if(e===null){var o=n.type;return typeof o=="function"&&!xu(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,Qp(e,t,o,r,s)):(e=pi(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Js,n(i,r)&&e.ref===t.ref)return vn(e,t,s)}return t.flags|=1,e=Hn(o,r),e.ref=t.ref,e.return=t,t.child=e}function Qp(e,t,n,r,s){if(e!==null){var o=e.memoizedProps;if(Js(o,r)&&e.ref===t.ref)if(lt=!1,t.pendingProps=r=o,(e.lanes&s)!==0)e.flags&131072&&(lt=!0);else return t.lanes=e.lanes,vn(e,t,s)}return Ql(e,t,n,r,s)}function Zp(e,t,n){var r=t.pendingProps,s=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Se(Dr,mt),mt|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Se(Dr,mt),mt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Se(Dr,mt),mt|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Se(Dr,mt),mt|=r;return tt(e,t,s,n),t.child}function qp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ql(e,t,n,r,s){var o=dt(n)?ar:qe.current;return o=Gr(t,o),Br(t,s),n=lu(e,t,n,r,o,s),r=cu(),e!==null&&!lt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vn(e,t,s)):(_e&&r&&Jc(t),t.flags|=1,tt(e,t,n,s),t.child)}function Kd(e,t,n,r,s){if(dt(n)){var o=!0;Li(t)}else o=!1;if(Br(t,s),t.stateNode===null)di(e,t),Gp(t,n,r),Xl(t,n,r,s),r=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Lt(u):(u=dt(n)?ar:qe.current,u=Gr(t,u));var d=n.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||c!==u)&&Bd(t,i,r,u),_n=!1;var p=t.memoizedState;i.state=p,Oi(t,r,i,s),c=t.memoizedState,l!==r||p!==c||ut.current||_n?(typeof d=="function"&&(Gl(t,n,d,r),c=t.memoizedState),(l=_n||Fd(t,n,l,r,p,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,_p(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Dt(t.type,l),i.props=u,f=t.pendingProps,p=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=Lt(c):(c=dt(n)?ar:qe.current,c=Gr(t,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==f||p!==c)&&Bd(t,i,r,c),_n=!1,p=t.memoizedState,i.state=p,Oi(t,r,i,s);var y=t.memoizedState;l!==f||p!==y||ut.current||_n?(typeof m=="function"&&(Gl(t,n,m,r),y=t.memoizedState),(u=_n||Fd(t,n,u,r,p,y,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),i.props=r,i.state=y,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Zl(e,t,n,r,o,s)}function Zl(e,t,n,r,s,o){qp(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return s&&Md(t,n,!1),vn(e,t,o);r=t.stateNode,i0.current=t;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Jr(t,e.child,null,o),t.child=Jr(t,null,l,o)):tt(e,t,l,o),t.memoizedState=r.state,s&&Md(t,n,!0),t.child}function em(e){var t=e.stateNode;t.pendingContext?Ld(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Ld(e,t.context,!1),su(e,t.containerInfo)}function Gd(e,t,n,r,s){return Xr(),Zc(s),t.flags|=256,tt(e,t,n,r),t.child}var ql={dehydrated:null,treeContext:null,retryLane:0};function ec(e){return{baseLanes:e,cachePool:null,transitions:null}}function tm(e,t,n){var r=t.pendingProps,s=be.current,o=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Se(be,s&1),e===null)return Yl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,o?(r=t.mode,o=t.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=fa(i,r,0,null),e=sr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=ec(n),t.memoizedState=ql,e):fu(t,i));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return a0(e,t,i,r,l,s,n);if(o){o=r.fallback,i=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Hn(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Hn(l,o):(o=sr(o,i,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,i=e.child.memoizedState,i=i===null?ec(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=e.childLanes&~n,t.memoizedState=ql,r}return o=e.child,e=o.sibling,r=Hn(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function fu(e,t){return t=fa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ho(e,t,n,r){return r!==null&&Zc(r),Jr(t,e.child,null,n),e=fu(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function a0(e,t,n,r,s,o,i){if(n)return t.flags&256?(t.flags&=-257,r=Ja(Error(Y(422))),Ho(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,s=t.mode,r=fa({mode:"visible",children:r.children},s,0,null),o=sr(o,s,i,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&Jr(t,e.child,null,i),t.child.memoizedState=ec(i),t.memoizedState=ql,o);if(!(t.mode&1))return Ho(e,t,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(Y(419)),r=Ja(o,r,void 0),Ho(e,t,i,r)}if(l=(i&e.childLanes)!==0,lt||l){if(r=We,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,yn(e,s),Bt(r,e,s,-1))}return vu(),r=Ja(Error(Y(421))),Ho(e,t,i,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=w0.bind(null,e),s._reactRetry=t,null):(e=o.treeContext,gt=In(s.nextSibling),yt=t,_e=!0,It=null,e!==null&&(jt[Nt++]=cn,jt[Nt++]=un,jt[Nt++]=lr,cn=e.id,un=e.overflow,lr=t),t=fu(t,r.children),t.flags|=4096,t)}function Xd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Kl(e.return,t,n)}function Qa(e,t,n,r,s){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function nm(e,t,n){var r=t.pendingProps,s=r.revealOrder,o=r.tail;if(tt(e,t,r.children,n),r=be.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Xd(e,n,t);else if(e.tag===19)Xd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Se(be,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ri(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Qa(t,!1,s,n,o);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ri(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Qa(t,!0,n,null,o);break;case"together":Qa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function di(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ur|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Y(153));if(t.child!==null){for(e=t.child,n=Hn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Hn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function l0(e,t,n){switch(t.tag){case 3:em(t),Xr();break;case 5:bp(t);break;case 1:dt(t.type)&&Li(t);break;case 4:su(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Se(Ai,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Se(be,be.current&1),t.flags|=128,null):n&t.child.childLanes?tm(e,t,n):(Se(be,be.current&1),e=vn(e,t,n),e!==null?e.sibling:null);Se(be,be.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return nm(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Se(be,be.current),r)break;return null;case 22:case 23:return t.lanes=0,Zp(e,t,n)}return vn(e,t,n)}var rm,tc,sm,om;rm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};tc=function(){};sm=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,er(Zt.current);var o=null;switch(n){case"input":s=Cl(e,s),r=Cl(e,r),o=[];break;case"select":s=Le({},s,{value:void 0}),r=Le({},r,{value:void 0}),o=[];break;case"textarea":s=El(e,s),r=El(e,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ti)}bl(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Us.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Us.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ce("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}};om=function(e,t,n,r){n!==r&&(t.flags|=4)};function vs(e,t){if(!_e)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Qe(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function c0(e,t,n){var r=t.pendingProps;switch(Qc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(t),null;case 1:return dt(t.type)&&Pi(),Qe(t),null;case 3:return r=t.stateNode,Qr(),je(ut),je(qe),iu(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Fo(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,It!==null&&(cc(It),It=null))),tc(e,t),Qe(t),null;case 5:ou(t);var s=er(to.current);if(n=t.type,e!==null&&t.stateNode!=null)sm(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Y(166));return Qe(t),null}if(e=er(Zt.current),Fo(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Jt]=t,r[qs]=o,e=(t.mode&1)!==0,n){case"dialog":Ce("cancel",r),Ce("close",r);break;case"iframe":case"object":case"embed":Ce("load",r);break;case"video":case"audio":for(s=0;s<Ts.length;s++)Ce(Ts[s],r);break;case"source":Ce("error",r);break;case"img":case"image":case"link":Ce("error",r),Ce("load",r);break;case"details":Ce("toggle",r);break;case"input":sd(r,o),Ce("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ce("invalid",r);break;case"textarea":id(r,o),Ce("invalid",r)}bl(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&zo(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&zo(r.textContent,l,e),s=["children",""+l]):Us.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Ce("scroll",r)}switch(n){case"input":Lo(r),od(r,o,!0);break;case"textarea":Lo(r),ad(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ti)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$h(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[Jt]=t,e[qs]=r,rm(e,t,!1,!1),t.stateNode=e;e:{switch(i=Tl(n,r),n){case"dialog":Ce("cancel",e),Ce("close",e),s=r;break;case"iframe":case"object":case"embed":Ce("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ts.length;s++)Ce(Ts[s],e);s=r;break;case"source":Ce("error",e),s=r;break;case"img":case"image":case"link":Ce("error",e),Ce("load",e),s=r;break;case"details":Ce("toggle",e),s=r;break;case"input":sd(e,r),s=Cl(e,r),Ce("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Le({},r,{value:void 0}),Ce("invalid",e);break;case"textarea":id(e,r),s=El(e,r),Ce("invalid",e);break;default:s=r}bl(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?Oh(e,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ah(e,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Vs(e,c):typeof c=="number"&&Vs(e,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Us.hasOwnProperty(o)?c!=null&&o==="onScroll"&&Ce("scroll",e):c!=null&&Oc(e,o,c,i))}switch(n){case"input":Lo(e),od(e,r,!1);break;case"textarea":Lo(e),ad(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Vn(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Rr(e,!!r.multiple,o,!1):r.defaultValue!=null&&Rr(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ti)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Qe(t),null;case 6:if(e&&t.stateNode!=null)om(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Y(166));if(n=er(to.current),er(Zt.current),Fo(t)){if(r=t.stateNode,n=t.memoizedProps,r[Jt]=t,(o=r.nodeValue!==n)&&(e=yt,e!==null))switch(e.tag){case 3:zo(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zo(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Jt]=t,t.stateNode=r}return Qe(t),null;case 13:if(je(be),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(_e&&gt!==null&&t.mode&1&&!(t.flags&128))Cp(),Xr(),t.flags|=98560,o=!1;else if(o=Fo(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(Y(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Y(317));o[Jt]=t}else Xr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Qe(t),o=!1}else It!==null&&(cc(It),It=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||be.current&1?Be===0&&(Be=3):vu())),t.updateQueue!==null&&(t.flags|=4),Qe(t),null);case 4:return Qr(),tc(e,t),e===null&&Qs(t.stateNode.containerInfo),Qe(t),null;case 10:return tu(t.type._context),Qe(t),null;case 17:return dt(t.type)&&Pi(),Qe(t),null;case 19:if(je(be),o=t.memoizedState,o===null)return Qe(t),null;if(r=(t.flags&128)!==0,i=o.rendering,i===null)if(r)vs(o,!1);else{if(Be!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Ri(e),i!==null){for(t.flags|=128,vs(o,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,e=i.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Se(be,be.current&1|2),t.child}e=e.sibling}o.tail!==null&&Oe()>qr&&(t.flags|=128,r=!0,vs(o,!1),t.lanes=4194304)}else{if(!r)if(e=Ri(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),vs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!_e)return Qe(t),null}else 2*Oe()-o.renderingStartTime>qr&&n!==1073741824&&(t.flags|=128,r=!0,vs(o,!1),t.lanes=4194304);o.isBackwards?(i.sibling=t.child,t.child=i):(n=o.last,n!==null?n.sibling=i:t.child=i,o.last=i)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Oe(),t.sibling=null,n=be.current,Se(be,r?n&1|2:n&1),t):(Qe(t),null);case 22:case 23:return yu(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?mt&1073741824&&(Qe(t),t.subtreeFlags&6&&(t.flags|=8192)):Qe(t),null;case 24:return null;case 25:return null}throw Error(Y(156,t.tag))}function u0(e,t){switch(Qc(t),t.tag){case 1:return dt(t.type)&&Pi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qr(),je(ut),je(qe),iu(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ou(t),null;case 13:if(je(be),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Y(340));Xr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return je(be),null;case 4:return Qr(),null;case 10:return tu(t.type._context),null;case 22:case 23:return yu(),null;case 24:return null;default:return null}}var Uo=!1,Ze=!1,d0=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Ar(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){$e(e,t,r)}else n.current=null}function nc(e,t,n){try{n()}catch(r){$e(e,t,r)}}var Jd=!1;function f0(e,t){if(zl=Ei,e=up(),Xc(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var m;f!==n||s!==0&&f.nodeType!==3||(l=i+s),f!==o||r!==0&&f.nodeType!==3||(c=i+r),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===e)break t;if(p===n&&++u===s&&(l=i),p===o&&++d===r&&(c=i),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fl={focusedElem:e,selectionRange:n},Ei=!1,Z=t;Z!==null;)if(t=Z,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Z=e;else for(;Z!==null;){t=Z;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,j=y.memoizedState,h=t.stateNode,g=h.getSnapshotBeforeUpdate(t.elementType===t.type?x:Dt(t.type,x),j);h.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Y(163))}}catch(k){$e(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Z=e;break}Z=t.return}return y=Jd,Jd=!1,y}function Fs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var o=s.destroy;s.destroy=void 0,o!==void 0&&nc(t,n,o)}s=s.next}while(s!==r)}}function ua(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function im(e){var t=e.alternate;t!==null&&(e.alternate=null,im(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Jt],delete t[qs],delete t[Ul],delete t[Gx],delete t[Xx])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function am(e){return e.tag===5||e.tag===3||e.tag===4}function Qd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||am(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function sc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ti));else if(r!==4&&(e=e.child,e!==null))for(sc(e,t,n),e=e.sibling;e!==null;)sc(e,t,n),e=e.sibling}function oc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(oc(e,t,n),e=e.sibling;e!==null;)oc(e,t,n),e=e.sibling}var Ke=null,Ot=!1;function jn(e,t,n){for(n=n.child;n!==null;)lm(e,t,n),n=n.sibling}function lm(e,t,n){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(na,n)}catch{}switch(n.tag){case 5:Ze||Ar(n,t);case 6:var r=Ke,s=Ot;Ke=null,jn(e,t,n),Ke=r,Ot=s,Ke!==null&&(Ot?(e=Ke,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ke.removeChild(n.stateNode));break;case 18:Ke!==null&&(Ot?(e=Ke,n=n.stateNode,e.nodeType===8?Va(e.parentNode,n):e.nodeType===1&&Va(e,n),Gs(e)):Va(Ke,n.stateNode));break;case 4:r=Ke,s=Ot,Ke=n.stateNode.containerInfo,Ot=!0,jn(e,t,n),Ke=r,Ot=s;break;case 0:case 11:case 14:case 15:if(!Ze&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&nc(n,t,i),s=s.next}while(s!==r)}jn(e,t,n);break;case 1:if(!Ze&&(Ar(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){$e(n,t,l)}jn(e,t,n);break;case 21:jn(e,t,n);break;case 22:n.mode&1?(Ze=(r=Ze)||n.memoizedState!==null,jn(e,t,n),Ze=r):jn(e,t,n);break;default:jn(e,t,n)}}function Zd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new d0),t.forEach(function(r){var s=S0.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function At(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ke=l.stateNode,Ot=!1;break e;case 3:Ke=l.stateNode.containerInfo,Ot=!0;break e;case 4:Ke=l.stateNode.containerInfo,Ot=!0;break e}l=l.return}if(Ke===null)throw Error(Y(160));lm(o,i,s),Ke=null,Ot=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){$e(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cm(t,e),t=t.sibling}function cm(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(At(t,e),Kt(e),r&4){try{Fs(3,e,e.return),ua(3,e)}catch(x){$e(e,e.return,x)}try{Fs(5,e,e.return)}catch(x){$e(e,e.return,x)}}break;case 1:At(t,e),Kt(e),r&512&&n!==null&&Ar(n,n.return);break;case 5:if(At(t,e),Kt(e),r&512&&n!==null&&Ar(n,n.return),e.flags&32){var s=e.stateNode;try{Vs(s,"")}catch(x){$e(e,e.return,x)}}if(r&4&&(s=e.stateNode,s!=null)){var o=e.memoizedProps,i=n!==null?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Lh(s,o),Tl(l,i);var u=Tl(l,o);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?Oh(s,f):d==="dangerouslySetInnerHTML"?Ah(s,f):d==="children"?Vs(s,f):Oc(s,d,f,u)}switch(l){case"input":jl(s,o);break;case"textarea":Mh(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Rr(s,!!o.multiple,m,!1):p!==!!o.multiple&&(o.defaultValue!=null?Rr(s,!!o.multiple,o.defaultValue,!0):Rr(s,!!o.multiple,o.multiple?[]:"",!1))}s[qs]=o}catch(x){$e(e,e.return,x)}}break;case 6:if(At(t,e),Kt(e),r&4){if(e.stateNode===null)throw Error(Y(162));s=e.stateNode,o=e.memoizedProps;try{s.nodeValue=o}catch(x){$e(e,e.return,x)}}break;case 3:if(At(t,e),Kt(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Gs(t.containerInfo)}catch(x){$e(e,e.return,x)}break;case 4:At(t,e),Kt(e);break;case 13:At(t,e),Kt(e),s=e.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(mu=Oe())),r&4&&Zd(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Ze=(u=Ze)||d,At(t,e),Ze=u):At(t,e),Kt(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Z=e,d=e.child;d!==null;){for(f=Z=d;Z!==null;){switch(p=Z,m=p.child,p.tag){case 0:case 11:case 14:case 15:Fs(4,p,p.return);break;case 1:Ar(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(x){$e(r,n,x)}}break;case 5:Ar(p,p.return);break;case 22:if(p.memoizedState!==null){ef(f);continue}}m!==null?(m.return=p,Z=m):ef(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Dh("display",i))}catch(x){$e(e,e.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){$e(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:At(t,e),Kt(e),r&4&&Zd(e);break;case 21:break;default:At(t,e),Kt(e)}}function Kt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(am(n)){var r=n;break e}n=n.return}throw Error(Y(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Vs(s,""),r.flags&=-33);var o=Qd(e);oc(e,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=Qd(e);sc(e,l,i);break;default:throw Error(Y(161))}}catch(c){$e(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function h0(e,t,n){Z=e,um(e)}function um(e,t,n){for(var r=(e.mode&1)!==0;Z!==null;){var s=Z,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Uo;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Ze;l=Uo;var u=Ze;if(Uo=i,(Ze=c)&&!u)for(Z=s;Z!==null;)i=Z,c=i.child,i.tag===22&&i.memoizedState!==null?tf(s):c!==null?(c.return=i,Z=c):tf(s);for(;o!==null;)Z=o,um(o),o=o.sibling;Z=s,Uo=l,Ze=u}qd(e)}else s.subtreeFlags&8772&&o!==null?(o.return=s,Z=o):qd(e)}}function qd(e){for(;Z!==null;){var t=Z;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ze||ua(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ze)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Dt(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&Rd(t,o,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Rd(t,i,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Gs(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Y(163))}Ze||t.flags&512&&rc(t)}catch(p){$e(t,t.return,p)}}if(t===e){Z=null;break}if(n=t.sibling,n!==null){n.return=t.return,Z=n;break}Z=t.return}}function ef(e){for(;Z!==null;){var t=Z;if(t===e){Z=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Z=n;break}Z=t.return}}function tf(e){for(;Z!==null;){var t=Z;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ua(4,t)}catch(c){$e(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){$e(t,s,c)}}var o=t.return;try{rc(t)}catch(c){$e(t,o,c)}break;case 5:var i=t.return;try{rc(t)}catch(c){$e(t,i,c)}}}catch(c){$e(t,t.return,c)}if(t===e){Z=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Z=l;break}Z=t.return}}var p0=Math.ceil,Fi=kn.ReactCurrentDispatcher,hu=kn.ReactCurrentOwner,Pt=kn.ReactCurrentBatchConfig,pe=0,We=null,ze=null,Ge=0,mt=0,Dr=Kn(0),Be=0,oo=null,ur=0,da=0,pu=0,Bs=null,at=null,mu=0,qr=1/0,an=null,Bi=!1,ic=null,Fn=null,Vo=!1,An=null,Hi=0,Hs=0,ac=null,fi=-1,hi=0;function nt(){return pe&6?Oe():fi!==-1?fi:fi=Oe()}function Bn(e){return e.mode&1?pe&2&&Ge!==0?Ge&-Ge:Qx.transition!==null?(hi===0&&(hi=Gh()),hi):(e=ye,e!==0||(e=window.event,e=e===void 0?16:tp(e.type)),e):1}function Bt(e,t,n,r){if(50<Hs)throw Hs=0,ac=null,Error(Y(185));vo(e,n,r),(!(pe&2)||e!==We)&&(e===We&&(!(pe&2)&&(da|=n),Be===4&&Ln(e,Ge)),ft(e,r),n===1&&pe===0&&!(t.mode&1)&&(qr=Oe()+500,aa&&Gn()))}function ft(e,t){var n=e.callbackNode;Qv(e,t);var r=Ni(e,e===We?Ge:0);if(r===0)n!==null&&ud(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ud(n),t===1)e.tag===0?Jx(nf.bind(null,e)):wp(nf.bind(null,e)),Yx(function(){!(pe&6)&&Gn()}),n=null;else{switch(Xh(r)){case 1:n=Bc;break;case 4:n=Yh;break;case 16:n=ji;break;case 536870912:n=Kh;break;default:n=ji}n=vm(n,dm.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function dm(e,t){if(fi=-1,hi=0,pe&6)throw Error(Y(327));var n=e.callbackNode;if(Hr()&&e.callbackNode!==n)return null;var r=Ni(e,e===We?Ge:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ui(e,r);else{t=r;var s=pe;pe|=2;var o=hm();(We!==e||Ge!==t)&&(an=null,qr=Oe()+500,rr(e,t));do try{y0();break}catch(l){fm(e,l)}while(1);eu(),Fi.current=o,pe=s,ze!==null?t=0:(We=null,Ge=0,t=Be)}if(t!==0){if(t===2&&(s=Al(e),s!==0&&(r=s,t=lc(e,s))),t===1)throw n=oo,rr(e,0),Ln(e,r),ft(e,Oe()),n;if(t===6)Ln(e,r);else{if(s=e.current.alternate,!(r&30)&&!m0(s)&&(t=Ui(e,r),t===2&&(o=Al(e),o!==0&&(r=o,t=lc(e,o))),t===1))throw n=oo,rr(e,0),Ln(e,r),ft(e,Oe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(Y(345));case 2:Jn(e,at,an);break;case 3:if(Ln(e,r),(r&130023424)===r&&(t=mu+500-Oe(),10<t)){if(Ni(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){nt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Hl(Jn.bind(null,e,at,an),t);break}Jn(e,at,an);break;case 4:if(Ln(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var i=31-Ft(r);o=1<<i,i=t[i],i>s&&(s=i),r&=~o}if(r=s,r=Oe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*p0(r/1960))-r,10<r){e.timeoutHandle=Hl(Jn.bind(null,e,at,an),r);break}Jn(e,at,an);break;case 5:Jn(e,at,an);break;default:throw Error(Y(329))}}}return ft(e,Oe()),e.callbackNode===n?dm.bind(null,e):null}function lc(e,t){var n=Bs;return e.current.memoizedState.isDehydrated&&(rr(e,t).flags|=256),e=Ui(e,t),e!==2&&(t=at,at=n,t!==null&&cc(t)),e}function cc(e){at===null?at=e:at.push.apply(at,e)}function m0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!Ht(o(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ln(e,t){for(t&=~pu,t&=~da,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ft(t),r=1<<n;e[n]=-1,t&=~r}}function nf(e){if(pe&6)throw Error(Y(327));Hr();var t=Ni(e,0);if(!(t&1))return ft(e,Oe()),null;var n=Ui(e,t);if(e.tag!==0&&n===2){var r=Al(e);r!==0&&(t=r,n=lc(e,r))}if(n===1)throw n=oo,rr(e,0),Ln(e,t),ft(e,Oe()),n;if(n===6)throw Error(Y(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Jn(e,at,an),ft(e,Oe()),null}function gu(e,t){var n=pe;pe|=1;try{return e(t)}finally{pe=n,pe===0&&(qr=Oe()+500,aa&&Gn())}}function dr(e){An!==null&&An.tag===0&&!(pe&6)&&Hr();var t=pe;pe|=1;var n=Pt.transition,r=ye;try{if(Pt.transition=null,ye=1,e)return e()}finally{ye=r,Pt.transition=n,pe=t,!(pe&6)&&Gn()}}function yu(){mt=Dr.current,je(Dr)}function rr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Wx(n)),ze!==null)for(n=ze.return;n!==null;){var r=n;switch(Qc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pi();break;case 3:Qr(),je(ut),je(qe),iu();break;case 5:ou(r);break;case 4:Qr();break;case 13:je(be);break;case 19:je(be);break;case 10:tu(r.type._context);break;case 22:case 23:yu()}n=n.return}if(We=e,ze=e=Hn(e.current,null),Ge=mt=t,Be=0,oo=null,pu=da=ur=0,at=Bs=null,qn!==null){for(t=0;t<qn.length;t++)if(n=qn[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}qn=null}return e}function fm(e,t){do{var n=ze;try{if(eu(),ci.current=zi,Ii){for(var r=Te.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ii=!1}if(cr=0,Ve=Fe=Te=null,zs=!1,no=0,hu.current=null,n===null||n.return===null){Be=1,oo=t,ze=null;break}e:{var o=e,i=n.return,l=n,c=t;if(t=Ge,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=Ud(i);if(m!==null){m.flags&=-257,Vd(m,i,l,o,t),m.mode&1&&Hd(o,u,t),t=m,c=u;var y=t.updateQueue;if(y===null){var x=new Set;x.add(c),t.updateQueue=x}else y.add(c);break e}else{if(!(t&1)){Hd(o,u,t),vu();break e}c=Error(Y(426))}}else if(_e&&l.mode&1){var j=Ud(i);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Vd(j,i,l,o,t),Zc(Zr(c,l));break e}}o=c=Zr(c,l),Be!==4&&(Be=2),Bs===null?Bs=[o]:Bs.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var h=Xp(o,c,t);Od(o,h);break e;case 1:l=c;var g=o.type,w=o.stateNode;if(!(o.flags&128)&&(typeof g.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Fn===null||!Fn.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t;var k=Jp(o,l,t);Od(o,k);break e}}o=o.return}while(o!==null)}mm(n)}catch(C){t=C,ze===n&&n!==null&&(ze=n=n.return);continue}break}while(1)}function hm(){var e=Fi.current;return Fi.current=zi,e===null?zi:e}function vu(){(Be===0||Be===3||Be===2)&&(Be=4),We===null||!(ur&268435455)&&!(da&268435455)||Ln(We,Ge)}function Ui(e,t){var n=pe;pe|=2;var r=hm();(We!==e||Ge!==t)&&(an=null,rr(e,t));do try{g0();break}catch(s){fm(e,s)}while(1);if(eu(),pe=n,Fi.current=r,ze!==null)throw Error(Y(261));return We=null,Ge=0,Be}function g0(){for(;ze!==null;)pm(ze)}function y0(){for(;ze!==null&&!Hv();)pm(ze)}function pm(e){var t=ym(e.alternate,e,mt);e.memoizedProps=e.pendingProps,t===null?mm(e):ze=t,hu.current=null}function mm(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=u0(n,t),n!==null){n.flags&=32767,ze=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Be=6,ze=null;return}}else if(n=c0(n,t,mt),n!==null){ze=n;return}if(t=t.sibling,t!==null){ze=t;return}ze=t=e}while(t!==null);Be===0&&(Be=5)}function Jn(e,t,n){var r=ye,s=Pt.transition;try{Pt.transition=null,ye=1,v0(e,t,n,r)}finally{Pt.transition=s,ye=r}return null}function v0(e,t,n,r){do Hr();while(An!==null);if(pe&6)throw Error(Y(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Y(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Zv(e,o),e===We&&(ze=We=null,Ge=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Vo||(Vo=!0,vm(ji,function(){return Hr(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Pt.transition,Pt.transition=null;var i=ye;ye=1;var l=pe;pe|=4,hu.current=null,f0(e,n),cm(n,e),Ix(Fl),Ei=!!zl,Fl=zl=null,e.current=n,h0(n),Uv(),pe=l,ye=i,Pt.transition=o}else e.current=n;if(Vo&&(Vo=!1,An=e,Hi=s),o=e.pendingLanes,o===0&&(Fn=null),Yv(n.stateNode),ft(e,Oe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Bi)throw Bi=!1,e=ic,ic=null,e;return Hi&1&&e.tag!==0&&Hr(),o=e.pendingLanes,o&1?e===ac?Hs++:(Hs=0,ac=e):Hs=0,Gn(),null}function Hr(){if(An!==null){var e=Xh(Hi),t=Pt.transition,n=ye;try{if(Pt.transition=null,ye=16>e?16:e,An===null)var r=!1;else{if(e=An,An=null,Hi=0,pe&6)throw Error(Y(331));var s=pe;for(pe|=4,Z=e.current;Z!==null;){var o=Z,i=o.child;if(Z.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Z=u;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:Fs(8,d,o)}var f=d.child;if(f!==null)f.return=d,Z=f;else for(;Z!==null;){d=Z;var p=d.sibling,m=d.return;if(im(d),d===u){Z=null;break}if(p!==null){p.return=m,Z=p;break}Z=m}}}var y=o.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var j=x.sibling;x.sibling=null,x=j}while(x!==null)}}Z=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,Z=i;else e:for(;Z!==null;){if(o=Z,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Fs(9,o,o.return)}var h=o.sibling;if(h!==null){h.return=o.return,Z=h;break e}Z=o.return}}var g=e.current;for(Z=g;Z!==null;){i=Z;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,Z=w;else e:for(i=g;Z!==null;){if(l=Z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ua(9,l)}}catch(C){$e(l,l.return,C)}if(l===i){Z=null;break e}var k=l.sibling;if(k!==null){k.return=l.return,Z=k;break e}Z=l.return}}if(pe=s,Gn(),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(na,e)}catch{}r=!0}return r}finally{ye=n,Pt.transition=t}}return!1}function rf(e,t,n){t=Zr(n,t),t=Xp(e,t,1),e=zn(e,t,1),t=nt(),e!==null&&(vo(e,1,t),ft(e,t))}function $e(e,t,n){if(e.tag===3)rf(e,e,n);else for(;t!==null;){if(t.tag===3){rf(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fn===null||!Fn.has(r))){e=Zr(n,e),e=Jp(t,e,1),t=zn(t,e,1),e=nt(),t!==null&&(vo(t,1,e),ft(t,e));break}}t=t.return}}function x0(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=nt(),e.pingedLanes|=e.suspendedLanes&n,We===e&&(Ge&n)===n&&(Be===4||Be===3&&(Ge&130023424)===Ge&&500>Oe()-mu?rr(e,0):pu|=n),ft(e,t)}function gm(e,t){t===0&&(e.mode&1?(t=Ao,Ao<<=1,!(Ao&130023424)&&(Ao=4194304)):t=1);var n=nt();e=yn(e,t),e!==null&&(vo(e,t,n),ft(e,n))}function w0(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),gm(e,n)}function S0(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Y(314))}r!==null&&r.delete(t),gm(e,n)}var ym;ym=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||ut.current)lt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return lt=!1,l0(e,t,n);lt=!!(e.flags&131072)}else lt=!1,_e&&t.flags&1048576&&Sp(t,$i,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;di(e,t),e=t.pendingProps;var s=Gr(t,qe.current);Br(t,n),s=lu(null,t,r,e,s,n);var o=cu();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dt(r)?(o=!0,Li(t)):o=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ru(t),s.updater=ca,t.stateNode=s,s._reactInternals=t,Xl(t,r,e,n),t=Zl(null,t,r,!0,o,n)):(t.tag=0,_e&&o&&Jc(t),tt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(di(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=C0(r),e=Dt(r,e),s){case 0:t=Ql(null,t,r,e,n);break e;case 1:t=Kd(null,t,r,e,n);break e;case 11:t=Wd(null,t,r,e,n);break e;case 14:t=Yd(null,t,r,Dt(r.type,e),n);break e}throw Error(Y(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),Ql(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),Kd(e,t,r,s,n);case 3:e:{if(em(t),e===null)throw Error(Y(387));r=t.pendingProps,o=t.memoizedState,s=o.element,_p(e,t),Oi(t,r,null,n);var i=t.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){s=Zr(Error(Y(423)),t),t=Gd(e,t,r,n,s);break e}else if(r!==s){s=Zr(Error(Y(424)),t),t=Gd(e,t,r,n,s);break e}else for(gt=In(t.stateNode.containerInfo.firstChild),yt=t,_e=!0,It=null,n=Np(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xr(),r===s){t=vn(e,t,n);break e}tt(e,t,r,n)}t=t.child}return t;case 5:return bp(t),e===null&&Yl(t),r=t.type,s=t.pendingProps,o=e!==null?e.memoizedProps:null,i=s.children,Bl(r,s)?i=null:o!==null&&Bl(r,o)&&(t.flags|=32),qp(e,t),tt(e,t,i,n),t.child;case 6:return e===null&&Yl(t),null;case 13:return tm(e,t,n);case 4:return su(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Jr(t,null,r,n):tt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),Wd(e,t,r,s,n);case 7:return tt(e,t,t.pendingProps,n),t.child;case 8:return tt(e,t,t.pendingProps.children,n),t.child;case 12:return tt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,o=t.memoizedProps,i=s.value,Se(Ai,r._currentValue),r._currentValue=i,o!==null)if(Ht(o.value,i)){if(o.children===s.children&&!ut.current){t=vn(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=fn(-1,n&-n),c.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Kl(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(o.tag===10)i=o.type===t.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(Y(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Kl(i,n,t),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===t){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}tt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Br(t,n),s=Lt(s),r=r(s),t.flags|=1,tt(e,t,r,n),t.child;case 14:return r=t.type,s=Dt(r,t.pendingProps),s=Dt(r.type,s),Yd(e,t,r,s,n);case 15:return Qp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Dt(r,s),di(e,t),t.tag=1,dt(r)?(e=!0,Li(t)):e=!1,Br(t,n),Gp(t,r,s),Xl(t,r,s,n),Zl(null,t,r,!0,e,n);case 19:return nm(e,t,n);case 22:return Zp(e,t,n)}throw Error(Y(156,t.tag))};function vm(e,t){return Wh(e,t)}function k0(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bt(e,t,n,r){return new k0(e,t,n,r)}function xu(e){return e=e.prototype,!(!e||!e.isReactComponent)}function C0(e){if(typeof e=="function")return xu(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ic)return 11;if(e===zc)return 14}return 2}function Hn(e,t){var n=e.alternate;return n===null?(n=bt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function pi(e,t,n,r,s,o){var i=2;if(r=e,typeof e=="function")xu(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Nr:return sr(n.children,s,o,t);case Rc:i=8,s|=8;break;case xl:return e=bt(12,n,t,s|2),e.elementType=xl,e.lanes=o,e;case wl:return e=bt(13,n,t,s),e.elementType=wl,e.lanes=o,e;case Sl:return e=bt(19,n,t,s),e.elementType=Sl,e.lanes=o,e;case bh:return fa(n,s,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Eh:i=10;break e;case _h:i=9;break e;case Ic:i=11;break e;case zc:i=14;break e;case En:i=16,r=null;break e}throw Error(Y(130,e==null?e:typeof e,""))}return t=bt(i,n,t,s),t.elementType=e,t.type=r,t.lanes=o,t}function sr(e,t,n,r){return e=bt(7,e,r,t),e.lanes=n,e}function fa(e,t,n,r){return e=bt(22,e,r,t),e.elementType=bh,e.lanes=n,e.stateNode={isHidden:!1},e}function Za(e,t,n){return e=bt(6,e,null,t),e.lanes=n,e}function qa(e,t,n){return t=bt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function j0(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$a(0),this.expirationTimes=$a(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$a(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function wu(e,t,n,r,s,o,i,l,c){return e=new j0(e,t,n,l,c),t===1?(t=1,o===!0&&(t|=8)):t=0,o=bt(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ru(o),e}function N0(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:jr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function xm(e){if(!e)return Wn;e=e._reactInternals;e:{if(mr(e)!==e||e.tag!==1)throw Error(Y(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Y(171))}if(e.tag===1){var n=e.type;if(dt(n))return xp(e,n,t)}return t}function wm(e,t,n,r,s,o,i,l,c){return e=wu(n,r,!0,e,s,o,i,l,c),e.context=xm(null),n=e.current,r=nt(),s=Bn(n),o=fn(r,s),o.callback=t??null,zn(n,o,s),e.current.lanes=s,vo(e,s,r),ft(e,r),e}function ha(e,t,n,r){var s=t.current,o=nt(),i=Bn(s);return n=xm(n),t.context===null?t.context=n:t.pendingContext=n,t=fn(o,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=zn(s,t,i),e!==null&&(Bt(e,s,i,o),li(e,s,i)),i}function Vi(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Su(e,t){sf(e,t),(e=e.alternate)&&sf(e,t)}function E0(){return null}var Sm=typeof reportError=="function"?reportError:function(e){console.error(e)};function ku(e){this._internalRoot=e}pa.prototype.render=ku.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Y(409));ha(e,t,null,null)};pa.prototype.unmount=ku.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;dr(function(){ha(null,e,null,null)}),t[gn]=null}};function pa(e){this._internalRoot=e}pa.prototype.unstable_scheduleHydration=function(e){if(e){var t=Zh();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pn.length&&t!==0&&t<Pn[n].priority;n++);Pn.splice(n,0,e),n===0&&ep(e)}};function Cu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ma(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function of(){}function _0(e,t,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=Vi(i);o.call(u)}}var i=wm(t,r,e,0,null,!1,!1,"",of);return e._reactRootContainer=i,e[gn]=i.current,Qs(e.nodeType===8?e.parentNode:e),dr(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Vi(c);l.call(u)}}var c=wu(e,0,!1,null,null,!1,!1,"",of);return e._reactRootContainer=c,e[gn]=c.current,Qs(e.nodeType===8?e.parentNode:e),dr(function(){ha(t,c,n,r)}),c}function ga(e,t,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var c=Vi(i);l.call(c)}}ha(t,i,e,s)}else i=_0(n,t,e,s,r);return Vi(i)}Jh=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=bs(t.pendingLanes);n!==0&&(Hc(t,n|1),ft(t,Oe()),!(pe&6)&&(qr=Oe()+500,Gn()))}break;case 13:dr(function(){var r=yn(e,1);if(r!==null){var s=nt();Bt(r,e,1,s)}}),Su(e,1)}};Uc=function(e){if(e.tag===13){var t=yn(e,134217728);if(t!==null){var n=nt();Bt(t,e,134217728,n)}Su(e,134217728)}};Qh=function(e){if(e.tag===13){var t=Bn(e),n=yn(e,t);if(n!==null){var r=nt();Bt(n,e,t,r)}Su(e,t)}};Zh=function(){return ye};qh=function(e,t){var n=ye;try{return ye=e,t()}finally{ye=n}};Ll=function(e,t,n){switch(t){case"input":if(jl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ia(r);if(!s)throw Error(Y(90));Ph(r),jl(r,s)}}}break;case"textarea":Mh(e,n);break;case"select":t=n.value,t!=null&&Rr(e,!!n.multiple,t,!1)}};zh=gu;Fh=dr;var b0={usingClientEntryPoint:!1,Events:[wo,Tr,ia,Rh,Ih,gu]},xs={findFiberByHostInstance:Zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},T0={bundleType:xs.bundleType,version:xs.version,rendererPackageName:xs.rendererPackageName,rendererConfig:xs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Uh(e),e===null?null:e.stateNode},findFiberByHostInstance:xs.findFiberByHostInstance||E0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wo.isDisabled&&Wo.supportsFiber)try{na=Wo.inject(T0),Qt=Wo}catch{}}wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b0;wt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cu(t))throw Error(Y(200));return N0(e,t,null,n)};wt.createRoot=function(e,t){if(!Cu(e))throw Error(Y(299));var n=!1,r="",s=Sm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=wu(e,1,!1,null,null,n,!1,r,s),e[gn]=t.current,Qs(e.nodeType===8?e.parentNode:e),new ku(t)};wt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Y(188)):(e=Object.keys(e).join(","),Error(Y(268,e)));return e=Uh(t),e=e===null?null:e.stateNode,e};wt.flushSync=function(e){return dr(e)};wt.hydrate=function(e,t,n){if(!ma(t))throw Error(Y(200));return ga(null,e,t,!0,n)};wt.hydrateRoot=function(e,t,n){if(!Cu(e))throw Error(Y(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=Sm;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=wm(t,null,e,1,n??null,s,!1,o,i),e[gn]=t.current,Qs(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new pa(t)};wt.render=function(e,t,n){if(!ma(t))throw Error(Y(200));return ga(null,e,t,!1,n)};wt.unmountComponentAtNode=function(e){if(!ma(e))throw Error(Y(40));return e._reactRootContainer?(dr(function(){ga(null,null,e,!1,function(){e._reactRootContainer=null,e[gn]=null})}),!0):!1};wt.unstable_batchedUpdates=gu;wt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ma(n))throw Error(Y(200));if(e==null||e._reactInternals===void 0)throw Error(Y(38));return ga(e,t,n,!1,r)};wt.version="18.3.1-next-f1338f8080-20240426";function km(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(km)}catch(e){console.error(e)}}km(),kh.exports=wt;var Cr=kh.exports,af=Cr;yl.createRoot=af.createRoot,yl.hydrateRoot=af.hydrateRoot;const P0="modulepreload",L0=function(e){return"/"+e},lf={},Cm=function(t,n,r){if(!n||n.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=L0(o),o in lf)return;lf[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const f=s[d];if(f.href===o&&(!i||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${l}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":P0,i||(u.as="script",u.crossOrigin=""),u.href=o,document.head.appendChild(u),i)return new Promise((d,f)=>{u.addEventListener("load",d),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>t()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};var cf="popstate";function M0(e={}){function t(r,s){let{pathname:o,search:i,hash:l}=r.location;return uc("",{pathname:o,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:io(s)}return A0(t,n,null,e)}function Pe(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function en(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function $0(){return Math.random().toString(36).substring(2,10)}function uf(e,t){return{usr:e.state,key:e.key,idx:t}}function uc(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?ls(t):t,state:n,key:t&&t.key||r||$0()}}function io({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function ls(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function A0(e,t,n,r={}){let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,l="POP",c=null,u=d();u==null&&(u=0,i.replaceState({...i.state,idx:u},""));function d(){return(i.state||{idx:null}).idx}function f(){l="POP";let j=d(),h=j==null?null:j-u;u=j,c&&c({action:l,location:x.location,delta:h})}function p(j,h){l="PUSH";let g=uc(x.location,j,h);n&&n(g,j),u=d()+1;let w=uf(g,u),k=x.createHref(g);try{i.pushState(w,"",k)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;s.location.assign(k)}o&&c&&c({action:l,location:x.location,delta:1})}function m(j,h){l="REPLACE";let g=uc(x.location,j,h);n&&n(g,j),u=d();let w=uf(g,u),k=x.createHref(g);i.replaceState(w,"",k),o&&c&&c({action:l,location:x.location,delta:0})}function y(j){return D0(j)}let x={get action(){return l},get location(){return e(s,i)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(cf,f),c=j,()=>{s.removeEventListener(cf,f),c=null}},createHref(j){return t(s,j)},createURL:y,encodeLocation(j){let h=y(j);return{pathname:h.pathname,search:h.search,hash:h.hash}},push:p,replace:m,go(j){return i.go(j)}};return x}function D0(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Pe(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:io(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function jm(e,t,n="/"){return O0(e,t,n,!1)}function O0(e,t,n,r){let s=typeof t=="string"?ls(t):t,o=xn(s.pathname||"/",n);if(o==null)return null;let i=Nm(e);R0(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let u=G0(o);l=Y0(i[c],u,r)}return l}function Nm(e,t=[],n=[],r="",s=!1){let o=(i,l,c=s,u)=>{let d={relativePath:u===void 0?i.path||"":u,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};if(d.relativePath.startsWith("/")){if(!d.relativePath.startsWith(r)&&c)return;Pe(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length)}let f=hn([r,d.relativePath]),p=n.concat(d);i.children&&i.children.length>0&&(Pe(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Nm(i.children,t,p,f,c)),!(i.path==null&&!i.index)&&t.push({path:f,score:V0(f,i.index),routesMeta:p})};return e.forEach((i,l)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))o(i,l);else for(let u of Em(i.path))o(i,l,!0,u)}),t}function Em(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=Em(r.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),s&&l.push(...i),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function R0(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:W0(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var I0=/^:[\w-]+$/,z0=3,F0=2,B0=1,H0=10,U0=-2,df=e=>e==="*";function V0(e,t){let n=e.split("/"),r=n.length;return n.some(df)&&(r+=U0),t&&(r+=F0),n.filter(s=>!df(s)).reduce((s,o)=>s+(I0.test(o)?z0:o===""?B0:H0),r)}function W0(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Y0(e,t,n=!1){let{routesMeta:r}=e,s={},o="/",i=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=o==="/"?t:t.slice(o.length)||"/",f=Wi({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!f&&u&&n&&!r[r.length-1].route.index&&(f=Wi({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:hn([o,f.pathname]),pathnameBase:Z0(hn([o,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(o=hn([o,f.pathnameBase]))}return i}function Wi(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=K0(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,{paramName:d,isOptional:f},p)=>{if(d==="*"){let y=l[p]||"";i=o.slice(0,o.length-y.length).replace(/(.)\/+$/,"$1")}const m=l[p];return f&&!m?u[d]=void 0:u[d]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:e}}function K0(e,t=!1,n=!0){en(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function G0(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return en(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function xn(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function X0(e,t="/"){let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?ls(e):e;return{pathname:n?n.startsWith("/")?n:J0(n,t):t,search:q0(r),hash:ew(s)}}function J0(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function el(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Q0(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function _m(e){let t=Q0(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function bm(e,t,n,r=!1){let s;typeof e=="string"?s=ls(e):(s={...e},Pe(!s.pathname||!s.pathname.includes("?"),el("?","pathname","search",s)),Pe(!s.pathname||!s.pathname.includes("#"),el("#","pathname","hash",s)),Pe(!s.search||!s.search.includes("#"),el("#","search","hash",s)));let o=e===""||s.pathname==="",i=o?"/":s.pathname,l;if(i==null)l=n;else{let f=t.length-1;if(!r&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}l=f>=0?t[f]:"/"}let c=X0(s,l),u=i&&i!=="/"&&i.endsWith("/"),d=(o||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}var hn=e=>e.join("/").replace(/\/\/+/g,"/"),Z0=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),q0=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ew=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function tw(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var Tm=["POST","PUT","PATCH","DELETE"];new Set(Tm);var nw=["GET",...Tm];new Set(nw);var cs=v.createContext(null);cs.displayName="DataRouter";var ya=v.createContext(null);ya.displayName="DataRouterState";v.createContext(!1);var Pm=v.createContext({isTransitioning:!1});Pm.displayName="ViewTransition";var rw=v.createContext(new Map);rw.displayName="Fetchers";var sw=v.createContext(null);sw.displayName="Await";var nn=v.createContext(null);nn.displayName="Navigation";var ko=v.createContext(null);ko.displayName="Location";var Cn=v.createContext({outlet:null,matches:[],isDataRoute:!1});Cn.displayName="Route";var ju=v.createContext(null);ju.displayName="RouteError";function ow(e,{relative:t}={}){Pe(Co(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=v.useContext(nn),{hash:s,pathname:o,search:i}=jo(e,{relative:t}),l=o;return n!=="/"&&(l=o==="/"?n:hn([n,o])),r.createHref({pathname:l,search:i,hash:s})}function Co(){return v.useContext(ko)!=null}function gr(){return Pe(Co(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(ko).location}var Lm="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Mm(e){v.useContext(nn).static||v.useLayoutEffect(e)}function iw(){let{isDataRoute:e}=v.useContext(Cn);return e?xw():aw()}function aw(){Pe(Co(),"useNavigate() may be used only in the context of a <Router> component.");let e=v.useContext(cs),{basename:t,navigator:n}=v.useContext(nn),{matches:r}=v.useContext(Cn),{pathname:s}=gr(),o=JSON.stringify(_m(r)),i=v.useRef(!1);return Mm(()=>{i.current=!0}),v.useCallback((c,u={})=>{if(en(i.current,Lm),!i.current)return;if(typeof c=="number"){n.go(c);return}let d=bm(c,JSON.parse(o),s,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:hn([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,o,s,e])}v.createContext(null);function jo(e,{relative:t}={}){let{matches:n}=v.useContext(Cn),{pathname:r}=gr(),s=JSON.stringify(_m(n));return v.useMemo(()=>bm(e,JSON.parse(s),r,t==="path"),[e,s,r,t])}function lw(e,t){return $m(e,t)}function $m(e,t,n,r,s){var g;Pe(Co(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=v.useContext(nn),{matches:i}=v.useContext(Cn),l=i[i.length-1],c=l?l.params:{},u=l?l.pathname:"/",d=l?l.pathnameBase:"/",f=l&&l.route;{let w=f&&f.path||"";Am(u,!f||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let p=gr(),m;if(t){let w=typeof t=="string"?ls(t):t;Pe(d==="/"||((g=w.pathname)==null?void 0:g.startsWith(d)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${w.pathname}" was given in the \`location\` prop.`),m=w}else m=p;let y=m.pathname||"/",x=y;if(d!=="/"){let w=d.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let j=jm(e,{pathname:x});en(f||j!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),en(j==null||j[j.length-1].route.element!==void 0||j[j.length-1].route.Component!==void 0||j[j.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let h=hw(j&&j.map(w=>Object.assign({},w,{params:Object.assign({},c,w.params),pathname:hn([d,o.encodeLocation?o.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?d:hn([d,o.encodeLocation?o.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,n,r,s);return t&&h?v.createElement(ko.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},h):h}function cw(){let e=vw(),t=tw(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:o},"ErrorBoundary")," or"," ",v.createElement("code",{style:o},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},t),n?v.createElement("pre",{style:s},n):null,i)}var uw=v.createElement(cw,null),dw=class extends v.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?v.createElement(Cn.Provider,{value:this.props.routeContext},v.createElement(ju.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fw({routeContext:e,match:t,children:n}){let r=v.useContext(cs);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),v.createElement(Cn.Provider,{value:e},n)}function hw(e,t=[],n=null,r=null,s=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,i=n==null?void 0:n.errors;if(i!=null){let u=o.findIndex(d=>d.route.id&&(i==null?void 0:i[d.route.id])!==void 0);Pe(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),o=o.slice(0,Math.min(o.length,u+1))}let l=!1,c=-1;if(n)for(let u=0;u<o.length;u++){let d=o[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:f,errors:p}=n,m=d.route.loader&&!f.hasOwnProperty(d.route.id)&&(!p||p[d.route.id]===void 0);if(d.route.lazy||m){l=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,d,f)=>{let p,m=!1,y=null,x=null;n&&(p=i&&d.route.id?i[d.route.id]:void 0,y=d.route.errorElement||uw,l&&(c<0&&f===0?(Am("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),m=!0,x=null):c===f&&(m=!0,x=d.route.hydrateFallbackElement||null)));let j=t.concat(o.slice(0,f+1)),h=()=>{let g;return p?g=y:m?g=x:d.route.Component?g=v.createElement(d.route.Component,null):d.route.element?g=d.route.element:g=u,v.createElement(fw,{match:d,routeContext:{outlet:u,matches:j,isDataRoute:n!=null},children:g})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?v.createElement(dw,{location:n.location,revalidation:n.revalidation,component:y,error:p,children:h(),routeContext:{outlet:null,matches:j,isDataRoute:!0},unstable_onError:r}):h()},null)}function Nu(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pw(e){let t=v.useContext(cs);return Pe(t,Nu(e)),t}function mw(e){let t=v.useContext(ya);return Pe(t,Nu(e)),t}function gw(e){let t=v.useContext(Cn);return Pe(t,Nu(e)),t}function Eu(e){let t=gw(e),n=t.matches[t.matches.length-1];return Pe(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function yw(){return Eu("useRouteId")}function vw(){var r;let e=v.useContext(ju),t=mw("useRouteError"),n=Eu("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function xw(){let{router:e}=pw("useNavigate"),t=Eu("useNavigate"),n=v.useRef(!1);return Mm(()=>{n.current=!0}),v.useCallback(async(s,o={})=>{en(n.current,Lm),n.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...o}))},[e,t])}var ff={};function Am(e,t,n){!t&&!ff[e]&&(ff[e]=!0,en(!1,n))}v.memo(ww);function ww({routes:e,future:t,state:n,unstable_onError:r}){return $m(e,void 0,n,r,t)}function Dm(e){Pe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Sw({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:s,static:o=!1}){Pe(!Co(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),l=v.useMemo(()=>({basename:i,navigator:s,static:o,future:{}}),[i,s,o]);typeof n=="string"&&(n=ls(n));let{pathname:c="/",search:u="",hash:d="",state:f=null,key:p="default"}=n,m=v.useMemo(()=>{let y=xn(c,i);return y==null?null:{location:{pathname:y,search:u,hash:d,state:f,key:p},navigationType:r}},[i,c,u,d,f,p,r]);return en(m!=null,`<Router basename="${i}"> is not able to match the URL "${c}${u}${d}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:v.createElement(nn.Provider,{value:l},v.createElement(ko.Provider,{children:t,value:m}))}function kw({children:e,location:t}){return lw(dc(e),t)}function dc(e,t=[]){let n=[];return v.Children.forEach(e,(r,s)=>{if(!v.isValidElement(r))return;let o=[...t,s];if(r.type===v.Fragment){n.push.apply(n,dc(r.props.children,o));return}Pe(r.type===Dm,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Pe(!r.props.index||!r.props.children,"An index route cannot have child routes.");let i={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=dc(r.props.children,o)),n.push(i)}),n}var mi="get",gi="application/x-www-form-urlencoded";function va(e){return e!=null&&typeof e.tagName=="string"}function Cw(e){return va(e)&&e.tagName.toLowerCase()==="button"}function jw(e){return va(e)&&e.tagName.toLowerCase()==="form"}function Nw(e){return va(e)&&e.tagName.toLowerCase()==="input"}function Ew(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _w(e,t){return e.button===0&&(!t||t==="_self")&&!Ew(e)}var Yo=null;function bw(){if(Yo===null)try{new FormData(document.createElement("form"),0),Yo=!1}catch{Yo=!0}return Yo}var Tw=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function tl(e){return e!=null&&!Tw.has(e)?(en(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gi}"`),null):e}function Pw(e,t){let n,r,s,o,i;if(jw(e)){let l=e.getAttribute("action");r=l?xn(l,t):null,n=e.getAttribute("method")||mi,s=tl(e.getAttribute("enctype"))||gi,o=new FormData(e)}else if(Cw(e)||Nw(e)&&(e.type==="submit"||e.type==="image")){let l=e.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=e.getAttribute("formaction")||l.getAttribute("action");if(r=c?xn(c,t):null,n=e.getAttribute("formmethod")||l.getAttribute("method")||mi,s=tl(e.getAttribute("formenctype"))||tl(l.getAttribute("enctype"))||gi,o=new FormData(l,e),!bw()){let{name:u,type:d,value:f}=e;if(d==="image"){let p=u?`${u}.`:"";o.append(`${p}x`,"0"),o.append(`${p}y`,"0")}else u&&o.append(u,f)}}else{if(va(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=mi,r=null,s=gi,i=e}return o&&s==="text/plain"&&(i=o,o=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:o,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function _u(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Lw(e,t,n){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname=`_root.${n}`:t&&xn(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function Mw(e,t){if(e.id in t)return t[e.id];try{let n=await Cm(()=>import(e.module),[]);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function $w(e){return e!=null&&typeof e.page=="string"}function Aw(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Dw(e,t,n){let r=await Promise.all(e.map(async s=>{let o=t.routes[s.route.id];if(o){let i=await Mw(o,n);return i.links?i.links():[]}return[]}));return zw(r.flat(1).filter(Aw).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function hf(e,t,n,r,s,o){let i=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>{var d;return n[u].pathname!==c.pathname||((d=n[u].route.path)==null?void 0:d.endsWith("*"))&&n[u].params["*"]!==c.params["*"]};return o==="assets"?t.filter((c,u)=>i(c,u)||l(c,u)):o==="data"?t.filter((c,u)=>{var f;let d=r.routes[c.route.id];if(!d||!d.hasLoader)return!1;if(i(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function Ow(e,t,{includeHydrateFallback:n}={}){return Rw(e.map(r=>{let s=t.routes[r.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function Rw(e){return[...new Set(e)]}function Iw(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function zw(e,t){let n=new Set,r=new Set(t);return e.reduce((s,o)=>{if(t&&!$w(o)&&o.as==="script"&&o.href&&r.has(o.href))return s;let l=JSON.stringify(Iw(o));return n.has(l)||(n.add(l),s.push({key:l,link:o})),s},[])}function Om(){let e=v.useContext(cs);return _u(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Fw(){let e=v.useContext(ya);return _u(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var bu=v.createContext(void 0);bu.displayName="FrameworkContext";function Rm(){let e=v.useContext(bu);return _u(e,"You must render this element inside a <HydratedRouter> element"),e}function Bw(e,t){let n=v.useContext(bu),[r,s]=v.useState(!1),[o,i]=v.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:f}=t,p=v.useRef(null);v.useEffect(()=>{if(e==="render"&&i(!0),e==="viewport"){let x=h=>{h.forEach(g=>{i(g.isIntersecting)})},j=new IntersectionObserver(x,{threshold:.5});return p.current&&j.observe(p.current),()=>{j.disconnect()}}},[e]),v.useEffect(()=>{if(r){let x=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(x)}}},[r]);let m=()=>{s(!0)},y=()=>{s(!1),i(!1)};return n?e!=="intent"?[o,p,{}]:[o,p,{onFocus:ws(l,m),onBlur:ws(c,y),onMouseEnter:ws(u,m),onMouseLeave:ws(d,y),onTouchStart:ws(f,m)}]:[!1,p,{}]}function ws(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Hw({page:e,...t}){let{router:n}=Om(),r=v.useMemo(()=>jm(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?v.createElement(Vw,{page:e,matches:r,...t}):null}function Uw(e){let{manifest:t,routeModules:n}=Rm(),[r,s]=v.useState([]);return v.useEffect(()=>{let o=!1;return Dw(e,t,n).then(i=>{o||s(i)}),()=>{o=!0}},[e,t,n]),r}function Vw({page:e,matches:t,...n}){let r=gr(),{manifest:s,routeModules:o}=Rm(),{basename:i}=Om(),{loaderData:l,matches:c}=Fw(),u=v.useMemo(()=>hf(e,t,c,s,r,"data"),[e,t,c,s,r]),d=v.useMemo(()=>hf(e,t,c,s,r,"assets"),[e,t,c,s,r]),f=v.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let y=new Set,x=!1;if(t.forEach(h=>{var w;let g=s.routes[h.route.id];!g||!g.hasLoader||(!u.some(k=>k.route.id===h.route.id)&&h.route.id in l&&((w=o[h.route.id])!=null&&w.shouldRevalidate)||g.hasClientLoader?x=!0:y.add(h.route.id))}),y.size===0)return[];let j=Lw(e,i,"data");return x&&y.size>0&&j.searchParams.set("_routes",t.filter(h=>y.has(h.route.id)).map(h=>h.route.id).join(",")),[j.pathname+j.search]},[i,l,r,s,u,t,e,o]),p=v.useMemo(()=>Ow(d,s),[d,s]),m=Uw(d);return v.createElement(v.Fragment,null,f.map(y=>v.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...n})),p.map(y=>v.createElement("link",{key:y,rel:"modulepreload",href:y,...n})),m.map(({key:y,link:x})=>v.createElement("link",{key:y,nonce:n.nonce,...x})))}function Ww(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var Im=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Im&&(window.__reactRouterVersion="7.8.2")}catch{}function Yw({basename:e,children:t,window:n}){let r=v.useRef();r.current==null&&(r.current=M0({window:n,v5Compat:!0}));let s=r.current,[o,i]=v.useState({action:s.action,location:s.location}),l=v.useCallback(c=>{v.startTransition(()=>i(c))},[i]);return v.useLayoutEffect(()=>s.listen(l),[s,l]),v.createElement(Sw,{basename:e,children:t,location:o.location,navigationType:o.action,navigator:s})}var zm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fm=v.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:s,reloadDocument:o,replace:i,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f,...p},m){let{basename:y}=v.useContext(nn),x=typeof u=="string"&&zm.test(u),j,h=!1;if(typeof u=="string"&&x&&(j=u,Im))try{let $=new URL(window.location.href),M=u.startsWith("//")?new URL($.protocol+u):new URL(u),B=xn(M.pathname,y);M.origin===$.origin&&B!=null?u=B+M.search+M.hash:h=!0}catch{en(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let g=ow(u,{relative:s}),[w,k,C]=Bw(r,p),N=Jw(u,{replace:i,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:f});function T($){t&&t($),$.defaultPrevented||N($)}let P=v.createElement("a",{...p,...C,href:j||g,onClick:h||o?t:T,ref:Ww(m,k),target:c,"data-discover":!x&&n==="render"?"true":void 0});return w&&!x?v.createElement(v.Fragment,null,P,v.createElement(Hw,{page:g})):P});Fm.displayName="Link";var Kw=v.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:s=!1,style:o,to:i,viewTransition:l,children:c,...u},d){let f=jo(i,{relative:u.relative}),p=gr(),m=v.useContext(ya),{navigator:y,basename:x}=v.useContext(nn),j=m!=null&&t1(f)&&l===!0,h=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,g=p.pathname,w=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;n||(g=g.toLowerCase(),w=w?w.toLowerCase():null,h=h.toLowerCase()),w&&x&&(w=xn(w,x)||w);const k=h!=="/"&&h.endsWith("/")?h.length-1:h.length;let C=g===h||!s&&g.startsWith(h)&&g.charAt(k)==="/",N=w!=null&&(w===h||!s&&w.startsWith(h)&&w.charAt(h.length)==="/"),T={isActive:C,isPending:N,isTransitioning:j},P=C?t:void 0,$;typeof r=="function"?$=r(T):$=[r,C?"active":null,N?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let M=typeof o=="function"?o(T):o;return v.createElement(Fm,{...u,"aria-current":P,className:$,ref:d,style:M,to:i,viewTransition:l},typeof c=="function"?c(T):c)});Kw.displayName="NavLink";var Gw=v.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:s,state:o,method:i=mi,action:l,onSubmit:c,relative:u,preventScrollReset:d,viewTransition:f,...p},m)=>{let y=qw(),x=e1(l,{relative:u}),j=i.toLowerCase()==="get"?"get":"post",h=typeof l=="string"&&zm.test(l),g=w=>{if(c&&c(w),w.defaultPrevented)return;w.preventDefault();let k=w.nativeEvent.submitter,C=(k==null?void 0:k.getAttribute("formmethod"))||i;y(k||w.currentTarget,{fetcherKey:t,method:C,navigate:n,replace:s,state:o,relative:u,preventScrollReset:d,viewTransition:f})};return v.createElement("form",{ref:m,method:j,action:x,onSubmit:r?c:g,...p,"data-discover":!h&&e==="render"?"true":void 0})});Gw.displayName="Form";function Xw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Bm(e){let t=v.useContext(cs);return Pe(t,Xw(e)),t}function Jw(e,{target:t,replace:n,state:r,preventScrollReset:s,relative:o,viewTransition:i}={}){let l=iw(),c=gr(),u=jo(e,{relative:o});return v.useCallback(d=>{if(_w(d,t)){d.preventDefault();let f=n!==void 0?n:io(c)===io(u);l(e,{replace:f,state:r,preventScrollReset:s,relative:o,viewTransition:i})}},[c,l,u,n,r,t,e,s,o,i])}var Qw=0,Zw=()=>`__${String(++Qw)}__`;function qw(){let{router:e}=Bm("useSubmit"),{basename:t}=v.useContext(nn),n=yw();return v.useCallback(async(r,s={})=>{let{action:o,method:i,encType:l,formData:c,body:u}=Pw(r,t);if(s.navigate===!1){let d=s.fetcherKey||Zw();await e.fetch(d,n,s.action||o,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||i,formEncType:s.encType||l,flushSync:s.flushSync})}else await e.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:c,body:u,formMethod:s.method||i,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,n])}function e1(e,{relative:t}={}){let{basename:n}=v.useContext(nn),r=v.useContext(Cn);Pe(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),o={...jo(e||".",{relative:t})},i=gr();if(e==null){o.search=i.search;let l=new URLSearchParams(o.search),c=l.getAll("index");if(c.some(d=>d==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let d=l.toString();o.search=d?`?${d}`:""}}return(!e||e===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:hn([n,o.pathname])),io(o)}function t1(e,{relative:t}={}){let n=v.useContext(Pm);Pe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Bm("useViewTransitionState"),s=jo(e,{relative:t});if(!n.isTransitioning)return!1;let o=xn(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=xn(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Wi(s.pathname,i)!=null||Wi(s.pathname,o)!=null}const Q=({}.VITE_API_BASE??"").replace(/\/$/,"");async function Hm(e,t="default"){const n=await fetch(`${Q}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,session_id:t})});if(!n.ok){const s=await n.text();throw new Error(`Chat request failed: ${n.status} ${s}`)}return(await n.json()).reply}async function n1(){const e=await fetch(`${Q}/characters`);if(!e.ok)throw new Error(`List characters failed: ${e.status}`);return e.json()}async function pf({name:e,description:t="",avatar_url:n=null}){const r=await fetch(`${Q}/characters`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,description:t,avatar_url:n})});if(!r.ok)throw new Error(`Create character failed: ${r.status}`);return r.json()}async function Um(e){const t=await fetch(`${Q}/characters/${e}`,{method:"DELETE"});if(!t.ok)throw new Error(`Delete character failed: ${t.status}`)}async function tn(){const e=await fetch(`${Q}/config`);if(!e.ok){const t=await e.text();throw new Error(`Get config failed: ${e.status} ${t}`)}return e.json()}async function Et(e){const t=await fetch(`${Q}/config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();try{const r=JSON.parse(n),s=typeof(r==null?void 0:r.detail)=="string"?r.detail:JSON.stringify((r==null?void 0:r.detail)??r);throw new Error(`Update config failed: ${t.status} ${s}`)}catch{throw new Error(`Update config failed: ${t.status} ${n}`)}}return t.json()}async function r1(e){const t=e?`?provider=${encodeURIComponent(e)}`:"",n=await fetch(`${Q}/models${t}`);if(!n.ok){const r=await n.text();try{const s=JSON.parse(r),o=typeof(s==null?void 0:s.detail)=="string"?s.detail:JSON.stringify((s==null?void 0:s.detail)??s);throw new Error(`Get models failed: ${n.status} ${o}`)}catch{throw new Error(`Get models failed: ${n.status} ${r}`)}}return n.json()}async function Tu(){const e=await fetch(`${Q}/lorebooks/`);if(!e.ok)throw new Error(`List lorebooks failed: ${e.status}`);return e.json()}async function s1({name:e,description:t="",entries:n=[]}){const r=await fetch(`${Q}/lorebooks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,description:t,entries:n})});if(!r.ok)throw new Error(`Create lorebook failed: ${r.status}`);return r.json()}async function o1(e){const t=new FormData;t.append("file",e);const n=await fetch(`${Q}/lorebooks/import`,{method:"POST",body:t});if(!n.ok)throw new Error(`Import lorebook failed: ${n.status}`);return n.json()}async function i1(e,t){const n=await fetch(`${Q}/characters/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Update character failed: ${n.status}`);return n.json()}async function a1(e){const t=await fetch(`${Q}/image/models?provider=${encodeURIComponent(e)}`);if(!t.ok)throw new Error(`Get image models failed: ${t.status}`);return t.json()}async function l1(e="default"){const t=await fetch(`${Q}/images/generate_from_chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e})});if(!t.ok)throw new Error(`Generate image failed: ${t.status}`);return t.json()}async function c1(e,t="default"){const n=await fetch(`${Q}/images/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:e,session_id:t})});if(!n.ok)throw new Error(`Generate image failed: ${n.status}`);return n.json()}async function Vm(e,t){const n=await fetch(`${Q}/lorebooks/entries/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Update lore failed: ${n.status}`);return n.json()}async function Wm(e,t){const n=await fetch(`${Q}/lorebooks/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Update lorebook failed: ${n.status}`);return n.json()}async function fc(e){const t=await fetch(`${Q}/lorebooks/${e}`);if(!t.ok)throw new Error(`Get lorebook failed: ${t.status}`);return t.json()}async function u1(e){const t=await fetch(`${Q}/lorebooks/entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Create lore entry failed: ${t.status}`);return t.json()}async function d1(e){const t=await fetch(`${Q}/lorebooks/entries/${e}`,{method:"DELETE"});if(!t.ok)throw new Error(`Delete lore entry failed: ${t.status}`);return t.json()}async function f1(e){const t=await fetch(`${Q}/lorebooks/${e}`,{method:"DELETE"});if(!t.ok)throw new Error(`Delete lorebook failed: ${t.status}`);return t.json()}async function h1(e,t=10,n=!1){const r=new URLSearchParams({q:e||"",limit:t.toString(),use_rag:n.toString()}),s=await fetch(`${Q}/lorebooks/search?${r}`);if(!s.ok)throw new Error(`Search lorebooks failed: ${s.status}`);return s.json()}async function p1(e,t){const n=await fetch(`${Q}/lorebooks/characters/${e}/lorebooks/${t}`,{method:"POST"});if(!n.ok)throw new Error(`Link character to lorebook failed: ${n.status}`);return n.json()}async function m1(e,t){const n=await fetch(`${Q}/lorebooks/characters/${e}/lorebooks/${t}`,{method:"DELETE"});if(!n.ok)throw new Error(`Unlink character from lorebook failed: ${n.status}`);return n.json()}async function g1(e){const t=await fetch(`${Q}/lorebooks/characters/${e}/lorebooks`);if(!t.ok)throw new Error(`Get character lorebooks failed: ${t.status}`);return t.json()}async function y1(e){const t=await fetch(`${Q}/lorebooks/inject_context`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Inject context failed: ${t.status}`);return t.json()}async function Ym(){const e=await fetch(`${Q}/chats`);if(!e.ok)throw new Error(`List chats failed: ${e.status}`);return e.json()}async function v1(e){const t=await fetch(`${Q}/chats/${encodeURIComponent(e)}`);if(!t.ok)throw new Error(`Get chat failed: ${t.status}`);return t.json()}async function Km(e){const t=await fetch(`${Q}/chats/${encodeURIComponent(e)}/reset`,{method:"POST"});if(!t.ok)throw new Error(`Reset chat failed: ${t.status}`);return t.json()}async function x1(){const e=await fetch(`${Q}/prompts`);if(!e.ok)throw new Error(`Get prompts failed: ${e.status}`);return e.json()}async function w1(e){const t=await fetch(`${Q}/prompts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Save prompts failed: ${t.status}`);return t.json()}async function S1(e="default"){const t=await fetch(`${Q}/lore/suggest_from_chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:e})});if(!t.ok)throw new Error(`Suggest lore failed: ${t.status}`);return t.json()}async function k1(){const e=await fetch(`${Q}/tools/mcp`);if(!e.ok)throw new Error(`Get MCP servers failed: ${e.status}`);return e.json()}async function C1(e){const t=await fetch(`${Q}/tools/mcp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`Save MCP servers failed: ${t.status}`);return t.json()}async function j1(){const e=await fetch(`${Q}/tools/mcp/awesome`);if(!e.ok)throw new Error(`Fetch MCP awesome failed: ${e.status}`);return e.json()}const me={backgroundAnimations:[],extensions:[],enabledExtensions:{},pluginDisposers:{},registeredStyles:{}};function No(){if(console.log("Plugin state updated"),Array.isArray(me._listeners))for(const e of me._listeners.slice())try{e()}catch(t){console.warn("pluginHost listener error",t)}}function N1(){window.coolChat||(window.coolChat={})}function mf(e,t){const n=document.createElement("style");n.textContent=t,document.head.appendChild(n),me.registeredStyles[e]=me.registeredStyles[e]||[],me.registeredStyles[e].push(n)}function gf(e,t){const n=(t||[]).map(r=>({...r,__pluginId:e}));me.backgroundAnimations=[...me.backgroundAnimations,...n],No()}function E1(){return me.backgroundAnimations.map(({__pluginId:e,...t})=>t)}function _1(){return me.extensions.map(e=>({...e,enabled:!!me.enabledExtensions[e.id]}))}function hc(e){me.enabledExtensions=e,No()}function b1(e){me.extensions=Array.isArray(e)?e:[],No()}async function yf(e){var t;N1(),window.coolChat.registerStyles=n=>{console.warn("window.coolChat.registerStyles is deprecated; use the init API argument instead"),mf("__global__",n)},window.coolChat.registerBackgroundAnimations=n=>{console.warn("window.coolChat.registerBackgroundAnimations is deprecated; use the init API argument instead"),gf("__global__",n)},window.coolChat.getExtensions=_1,window.coolChat.setEnabledExtensions=hc;try{let n=[],r={};if(e&&typeof e=="object")n=Array.isArray(e.plugins)?e.plugins:[],r=e.enabled||{};else{const o=await fetch(`${Q}/plugins`);if(!o.ok){console.warn("Failed to fetch /plugins");return}const i=await o.json();n=Array.isArray(i.plugins)?i.plugins:[],r=i.enabled||{}}const s=new Set(Object.keys(r).filter(o=>r[o]));for(const o of Object.keys(me.pluginDisposers||{}))if(!s.has(o))try{await T1(o)}catch(i){console.warn("Unload failed",o,i)}me.extensions=n,me.enabledExtensions={...me.enabledExtensions,...r||{}};for(const o of n){if(!me.enabledExtensions[o.id]){console.log(`Skipping disabled plugin: ${o.id}`);continue}try{const i=((t=o==null?void 0:o.client)==null?void 0:t.entry)||"plugin.js",l=`${Q}/plugins/static/${o.id}/${i}`;console.log("Loading plugin:",o.id,"from",l);const c=await Cm(()=>import(l),[]),u=(c==null?void 0:c.default)||(c==null?void 0:c.init);if(typeof u=="function"){const d=await u({registerStyles:f=>mf(o.id,f),registerBackgroundAnimations:f=>gf(o.id,f)});typeof d=="function"&&(me.pluginDisposers[o.id]=d)}}catch(i){console.warn("Plugin load failed:",o==null?void 0:o.id,i)}}No()}catch(n){console.warn("Plugin manifest load failed",n)}}async function T1(e){try{const t=me.pluginDisposers&&me.pluginDisposers[e];if(typeof t=="function"){try{await t()}catch(r){console.warn("Plugin disposer threw",e,r)}delete me.pluginDisposers[e]}const n=me.registeredStyles[e]||[];for(const r of n)try{r.remove()}catch{}delete me.registeredStyles[e],me.backgroundAnimations=me.backgroundAnimations.filter(r=>r.__pluginId!==e),No()}catch(t){console.warn("Failed to unload plugin",e,t)}}function P1(e){me._listeners=me._listeners||[],me._listeners.push(e)}function L1(e){me._listeners=me._listeners||[];const t=me._listeners.indexOf(e);t>=0&&me._listeners.splice(t,1)}const vf=e=>{let t;const n=new Set,r=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const p=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(m=>m(t,p))}},s=()=>t,l={setState:r,getState:s,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u))},c=t=e(r,s,l);return l},M1=e=>e?vf(e):vf,$1=e=>e;function A1(e,t=$1){const n=I.useSyncExternalStore(e.subscribe,I.useCallback(()=>t(e.getState()),[e,t]),I.useCallback(()=>t(e.getInitialState()),[e,t]));return I.useDebugValue(n),n}const xf=e=>{const t=M1(e),n=r=>A1(t,r);return Object.assign(n,t),n},yr=e=>e?xf(e):xf,it=yr((e,t)=>({messages:[],input:"",sending:!1,error:null,sessionId:"default",availableSessions:["default"],setMessages:n=>e(r=>({messages:typeof n=="function"?n(r.messages):n})),setInput:n=>e({input:n}),setSending:n=>e({sending:n}),setError:n=>e({error:n}),setSessionId:n=>e({sessionId:n}),setAvailableSessions:n=>e({availableSessions:n}),sendMessage:async n=>{if(!n.trim()||t().sending)return"";const{sessionId:r,messages:s}=t();n.trim(),e({sending:!0,error:null});try{const o=await Hm(n,r);return console.log("sendMessage: got reply:",o.slice(0,50)),e({sending:!1}),o}catch(o){throw e({error:o.message,sending:!1,messages:s}),o}},loadChat:async n=>{try{const{messages:r}=await v1(n);e({messages:r||[],sessionId:n,error:null})}catch(r){e({error:r.message})}},loadSessions:async()=>{try{const{sessions:n}=await Ym();e({availableSessions:n||["default"]})}catch(n){console.warn("Failed to load sessions:",n)}},resetChatSession:async n=>{try{await Km(n),await t().loadChat(n)}catch(r){e({error:r.message})}},createNewSession:n=>{const r=n.trim()||`session-${Date.now()}`;e({sessionId:r,messages:[],input:"",error:null})}})),D1=yr((e,t)=>({showConfig:!1,showCharacters:!1,showChats:!1,showTools:!1,showLorebooks:!1,showCircuits:!1,phoneOpen:!1,settingsTab:"connection",phoneUrl:"https://example.org",phoneStyle:"classic",suggestOpen:!1,suggests:[],showSOHint:!1,suppressSOHint:!1,expandedEntries:{},editorOpen:!1,editingChar:null,appTheme:{background_animations:[]},setShowConfig:n=>e({showConfig:n}),setShowCharacters:n=>e({showCharacters:n}),setShowChats:n=>e({showChats:n}),setShowTools:n=>e({showTools:n}),setShowLorebooks:n=>e({showLorebooks:n}),setShowCircuits:n=>e({showCircuits:n}),setPhoneOpen:n=>e({phoneOpen:n}),setSettingsTab:n=>e({settingsTab:n}),setPhoneUrl:n=>e({phoneUrl:n}),setPhoneStyle:n=>e({phoneStyle:n}),setSuggestOpen:n=>e({suggestOpen:n}),setSuggests:n=>e({suggests:n}),setShowSOHint:n=>e({showSOHint:n}),setSuppressSOHint:n=>e({suppressSOHint:n}),setExpandedEntries:n=>e({expandedEntries:n}),toggleExpandedEntry:n=>e(r=>({expandedEntries:{...r.expandedEntries,[n]:!r.expandedEntries[n]}})),setEditorOpen:n=>e({editorOpen:n}),setEditingChar:n=>e({editingChar:n}),closeAllPanels:()=>e({showConfig:!1,showCharacters:!1,showChats:!1,showTools:!1,showLorebooks:!1,showCircuits:!1}),togglePanel:(n,r)=>{const s=t()[n],o=r!==void 0?r:!s;o&&n!=="phoneOpen"&&t().closeAllPanels(),e({[n]:o})},applyPluginAnimations:n=>{!n||!Array.isArray(n)||e(r=>({...r,appTheme:{...r.appTheme,background_animations:n.map(s=>typeof s=="string"?s:s.id).filter(Boolean)}}))},setAppTheme:n=>{e(r=>({...r,appTheme:{...r.appTheme,...n}}))},updateAppTheme:n=>{e(r=>({...r,appTheme:{...r.appTheme,...n}}))}})),Pu=yr((e,t)=>({characters:[],selectedCharacterId:null,lorebooks:[],selectedLorebook:null,loreEntries:[],selectedLorebookId:null,userPersona:{name:"User",description:""},extensions:[],extensionsEnabled:{},extensionsInitialized:!1,setCharacters:n=>e({characters:n}),setSelectedCharacterId:n=>e({selectedCharacterId:n}),setLorebooks:n=>e({lorebooks:n}),setSelectedLorebook:n=>e({selectedLorebook:n}),setLoreEntries:n=>e({loreEntries:n}),setSelectedLorebookId:n=>e({selectedLorebookId:n}),setUserPersona:n=>e({userPersona:n}),setExtensions:n=>e({extensions:n}),setExtensionsEnabled:n=>e({extensionsEnabled:n}),setExtensionsInitialized:n=>e({extensionsInitialized:n}),loadCharacters:async()=>{try{const n=await n1();e({characters:n||[]})}catch(n){console.warn("Failed to load characters:",n)}},loadLorebooks:async()=>{try{const n=await Tu(),r=(n==null?void 0:n.lorebooks)||[];e({lorebooks:r}),(r==null?void 0:r.length)>0&&!t().selectedLorebook&&e({selectedLorebook:r[0]})}catch(n){console.warn("Failed to load lorebooks:",n)}},loadLoreEntries:async n=>{try{const r=await fc(n);e({loreEntries:r.entries||[]})}catch(r){console.warn("Failed to load lore entries:",r),e({loreEntries:[]})}},deleteCharacterAction:async n=>{try{await Um(n);const r=t().characters.filter(s=>s.id!==n);e({characters:r}),t().selectedCharacterId===n&&e({selectedCharacterId:null})}catch(r){throw console.error("Failed to delete character:",r),r}},updateLoreEntry:async(n,r)=>{try{await Vm(n,r);const o=t().loreEntries.map(i=>i.id===n?{...i,...r}:i);e({loreEntries:o})}catch(s){throw console.error("Failed to update lore entry:",s),s}},updateExtensionsEnabled:async(n,r={})=>{const{persist:s=!0}=r;try{if(e({extensionsEnabled:n}),s&&!(await fetch(`${Q}/plugins/enabled`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:n})})).ok)throw new Error("Failed to persist extensions")}catch(o){throw console.error("Failed to update extensions:",o),o}},findCharacterById:n=>t().characters.find(r=>r.id===n)||null,findLorebookById:n=>t().lorebooks.find(r=>r.id===n)||null})),Gm=yr((e,t)=>({activeProvider:"echo",providers:{},configDraft:{api_key:"",api_base:"",model:"",temperature:.7},modelList:[],loadingModels:!1,debugFlags:{log_prompts:!1,log_responses:!1},userPersona:{name:"",description:""},maxTokens:2048,structuredOutput:!1,setActiveProvider:n=>e({activeProvider:n}),setProviders:n=>e({providers:n}),setConfigDraft:n=>e({configDraft:n}),setModelList:n=>e({modelList:n}),setLoadingModels:n=>e({loadingModels:n}),setUserPersona:n=>e({userPersona:n}),setDebugFlags:n=>e({debugFlags:n}),setMaxTokens:n=>e({maxTokens:n}),setStructuredOutput:n=>e({structuredOutput:n}),loadConfig:async()=>{var n;try{const r=await tn();e({activeProvider:r.active_provider||"echo",providers:r.providers||{},debugFlags:r.debug||{log_prompts:!1,log_responses:!1},userPersona:r.user_persona||{name:"",description:""},maxTokens:r.max_context_tokens||2048,structuredOutput:r.structured_output||!1});const s=((n=r.providers)==null?void 0:n[r.active_provider])||{};e({configDraft:{api_key:"",api_base:s.api_base||"",model:s.model||"",temperature:s.temperature??.7}}),await t().loadModelsForProvider(r.active_provider)}catch(r){console.warn("Failed to load config:",r)}},updateMaxTokens:async n=>{try{await Et({max_context_tokens:n}),e({maxTokens:n})}catch(r){throw console.error("Failed to update max tokens:",r),r}},updateDebugFlags:async n=>{try{await Et({debug:n}),e({debugFlags:n})}catch(r){throw console.error("Failed to update debug flags:",r),r}},updateUserPersona:async n=>{try{await Et({user_persona:n}),e({userPersona:n})}catch(r){throw console.error("Failed to update user persona:",r),r}},updateStructuredOutput:async n=>{try{await Et({structured_output:n}),e({structuredOutput:n})}catch(r){throw console.error("Failed to update structured output:",r),r}},updateProviderConfig:async(n,r)=>{try{await Et({active_provider:n,providers:{[n]:r}}),e(s=>({providers:{...s.providers,[n]:r},configDraft:r}))}catch(s){throw console.error("Failed to update provider config:",s),s}},loadModels:async()=>{const n=t().activeProvider;await t().loadModelsForProvider(n)},loadModelsForProvider:async n=>{try{e({loadingModels:!0});const{models:r}=await r1(n);e({modelList:r||[],loadingModels:!1})}catch(r){console.error("Failed to load models:",r),e({modelList:[],loadingModels:!1})}}})),nl={primary:"#2563eb",secondary:"#374151",text1:"#e5e7eb",text2:"#cbd5e1",highlight:"#10b981",lowlight:"#111827",phone_style:"classic",background_animations:[]};yr((e,t)=>({appTheme:nl,availableThemes:[nl],currentThemeName:null,customThemes:{},setAppTheme:n=>{e({appTheme:n}),t().applyTheme(n)},updateThemeColors:n=>{e(r=>({appTheme:{...r.appTheme,...n}})),t().applyTheme(t().appTheme)},setPhoneStyle:n=>{e(r=>({appTheme:{...r.appTheme,phone_style:n}}))},addBackgroundAnimation:n=>{e(r=>({appTheme:{...r.appTheme,background_animations:[...r.appTheme.background_animations||[],n].filter((s,o,i)=>i.indexOf(s)===o)}}))},removeBackgroundAnimation:n=>{e(r=>({appTheme:{...r.appTheme,background_animations:(r.appTheme.background_animations||[]).filter(s=>s!==n)}}))},setBackgroundAnimations:n=>{e(r=>({appTheme:{...r.appTheme,background_animations:n}}))},saveCustomTheme:(n,r)=>{e(s=>({customThemes:{...s.customThemes,[n]:{...r}}}));try{const s=localStorage.getItem("coolchat-themes")||"{}",o=JSON.parse(s);o[n]=r,localStorage.setItem("coolchat-themes",JSON.stringify(o))}catch(s){console.warn("Failed to save theme to localStorage:",s)}},deleteCustomTheme:n=>{e(r=>{const s={...r.customThemes};delete s[n];try{const o=localStorage.getItem("coolchat-themes")||"{}",i=JSON.parse(o);delete i[n],localStorage.setItem("coolchat-themes",JSON.stringify(i))}catch(o){console.warn("Failed to delete theme from localStorage:",o)}return{customThemes:s}})},loadCustomTheme:n=>{const r=t().customThemes[n];r?(t().setAppTheme(r),e({currentThemeName:n})):console.warn("Theme not found:",n)},exportTheme:()=>{const n=t().appTheme,r=t().currentThemeName||"Exported Theme";return JSON.stringify({name:r,theme:n,exportedAt:new Date().toISOString(),version:"1.0"},null,2)},importTheme:n=>{try{const{name:r,theme:s}=JSON.parse(n);s&&typeof s=="object"&&t().saveCustomTheme(r,s)}catch(r){throw console.error("Failed to import theme:",r),new Error("Invalid theme format")}},applyTheme:n=>{const r=document.documentElement.style;n.primary&&r.setProperty("--primary",n.primary),n.secondary&&r.setProperty("--panel",n.secondary),n.text1&&r.setProperty("--text",n.text1),n.text2&&r.setProperty("--muted",n.text2),n.highlight&&r.setProperty("--assistant",n.highlight),n.lowlight&&r.setProperty("--bg",n.lowlight);const s=n.background_animations||[],o=new CustomEvent("coolchat:themeUpdate",{detail:{...n,background_animations:s}});window.dispatchEvent(o)},resetTheme:()=>{t().setAppTheme(nl),e({currentThemeName:null})}}));const O1=()=>{const e=it(),t=v.useCallback(async u=>await e.sendMessage(u),[e]),n=v.useCallback(async u=>{e.setSessionId(u),await e.loadChat(u)},[e]),r=it(u=>u.messages),s=it(u=>u.input),o=it(u=>u.sending),i=it(u=>u.error),l=it(u=>u.sessionId),c=it(u=>u.availableSessions);return{messages:r,input:s,sending:o,error:i,sessionId:l,availableSessions:c,sendMessage:t,setInput:e.setInput,setError:e.setError,setMessages:e.setMessages,setSending:e.setSending,switchSession:n,resetChat:e.resetChatSession,loadSessions:e.loadSessions,createSession:e.createNewSession}},R1=()=>{const e=it(),t=v.useCallback(async()=>{try{const r=await l1(e.sessionId);e.setMessages(s=>[...s,{role:"assistant",image_url:r.image_url,content:""}])}catch(r){throw new Error(r.message)}},[e]),n=v.useCallback(async r=>{try{const s=await c1(r,e.sessionId);e.setMessages(o=>[...o,{role:"assistant",image_url:s.image_url,content:r}])}catch(s){throw new Error(s.message)}},[e]);return{generateImageFromLastMessage:t,generateImage:n}},I1=()=>{const e=it();return{suggestLore:v.useCallback(async()=>{try{return await S1(e.sessionId)}catch(n){throw new Error(n.message)}},[e])}};class z1{constructor(){this.config=null,this.lastConfigCheck=0,this.configCacheTime=5e3,this.loadConfig()}async loadConfig(){const t=Date.now();if(this.config&&t-this.lastConfigCheck<this.configCacheTime)return await this.config;try{const n=await fetch(`${Q}/debug.json`);if(!n.ok)throw new Error(`HTTP ${n.status}`);this.config=await n.json(),this.lastConfigCheck=t}catch{this.config||console.warn("Failed to load debug.json - using defaults"),this.config={frontend:{tool_parsing:!0,llm_responses:!0,api_calls:!1,store_actions:!1,component_render:!1,performance:!1},enabled:!0}}return this.config}async isEnabled(t){const n=await this.loadConfig();return!n||!n.enabled?!1:(n.frontend||{})[t]===!0}async log(t,n,...r){await this.isEnabled(t)&&console.log(`[DEBUG ${t.toUpperCase()}] ${n}`,...r)}async debugToolParsing(t,...n){await this.log("tool_parsing",t,...n)}async debugLLMResponses(t,...n){await this.log("llm_responses",t,...n)}async debugAPICalls(t,...n){await this.log("api_calls",t,...n)}async debugStoreActions(t,...n){await this.log("store_actions",t,...n)}async debugComponentRender(t,...n){await this.log("component_render",t,...n)}async debugPerformance(t,...n){await this.log("performance",t,...n)}}let rl=null;function Xm(){return rl||(rl=new z1),rl}const Gt=(e,...t)=>Xm().debugToolParsing(e,...t),wf=(e,...t)=>Xm().debugLLMResponses(e,...t),ao=new Map,Ko=e=>{const t=ao.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([n,r])=>[n,r.getState()])):{}},F1=(e,t,n)=>{if(e===void 0)return{type:"untracked",connection:t.connect(n)};const r=ao.get(n.name);if(r)return{type:"tracked",store:e,...r};const s={connection:t.connect(n),stores:{}};return ao.set(n.name,s),{type:"tracked",store:e,...s}},B1=(e,t)=>{if(t===void 0)return;const n=ao.get(e);n&&(delete n.stores[t],Object.keys(n.stores).length===0&&ao.delete(e))},H1=e=>{var t,n;if(!e)return;const r=e.split(`
`),s=r.findIndex(i=>i.includes("api.setState"));if(s<0)return;const o=((t=r[s+1])==null?void 0:t.trim())||"";return(n=/.+ (.+) .+/.exec(o))==null?void 0:n[1]},U1=(e,t={})=>(n,r,s)=>{const{enabled:o,anonymousActionType:i,store:l,...c}=t;let u;try{u=(o??!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return e(n,r,s);const{connection:d,...f}=F1(l,u,c);let p=!0;s.setState=(x,j,h)=>{const g=n(x,j);if(!p)return g;const w=h===void 0?{type:i||H1(new Error().stack)||"anonymous"}:typeof h=="string"?{type:h}:h;return l===void 0?(d==null||d.send(w,r()),g):(d==null||d.send({...w,type:`${l}/${w.type}`},{...Ko(c.name),[l]:s.getState()}),g)},s.devtools={cleanup:()=>{d&&typeof d.unsubscribe=="function"&&d.unsubscribe(),B1(c.name,l)}};const m=(...x)=>{const j=p;p=!1,n(...x),p=j},y=e(s.setState,r,s);if(f.type==="untracked"?d==null||d.init(y):(f.stores[f.store]=s,d==null||d.init(Object.fromEntries(Object.entries(f.stores).map(([x,j])=>[x,x===f.store?y:j.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let x=!1;const j=s.dispatch;s.dispatch=(...h)=>{j(...h)}}return d.subscribe(x=>{var j;switch(x.type){case"ACTION":if(typeof x.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return sl(x.payload,h=>{if(h.type==="__setState"){if(l===void 0){m(h.state);return}Object.keys(h.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const g=h.state[l];if(g==null)return;JSON.stringify(s.getState())!==JSON.stringify(g)&&m(g);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(h)});case"DISPATCH":switch(x.payload.type){case"RESET":return m(y),l===void 0?d==null?void 0:d.init(s.getState()):d==null?void 0:d.init(Ko(c.name));case"COMMIT":if(l===void 0){d==null||d.init(s.getState());return}return d==null?void 0:d.init(Ko(c.name));case"ROLLBACK":return sl(x.state,h=>{if(l===void 0){m(h),d==null||d.init(s.getState());return}m(h[l]),d==null||d.init(Ko(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return sl(x.state,h=>{if(l===void 0){m(h);return}JSON.stringify(s.getState())!==JSON.stringify(h[l])&&m(h[l])});case"IMPORT_STATE":{const{nextLiftedState:h}=x.payload,g=(j=h.computedStates.slice(-1)[0])==null?void 0:j.state;if(!g)return;m(l===void 0?g:g[l]),d==null||d.send(null,h);return}case"PAUSE_RECORDING":return p=!p}return}}),y},V1=U1,sl=(e,t)=>{let n;try{n=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&t(n)},Lu=yr()(V1((e,t)=>({lorebooks:[],selectedLorebook:null,lorebookLoading:!1,loreEntries:[],selectedEntries:new Set,entryLoading:!1,currentPage:0,pageSize:50,totalEntries:0,hasMoreEntries:!1,searchQuery:"",searchResults:[],searchFilters:{keywords:[],secondary_keywords:[]},isSearching:!1,showEditor:!1,editingEntry:null,showBulkOps:!1,showImport:!1,linkedCharacters:[],availableCharacters:[],cache:new Map,fetchLorebooks:async()=>{console.log("[DEBUG] fetchLorebooks called");try{e({lorebookLoading:!0});const n=await Tu(),r=n&&n.lorebooks?n.lorebooks:[];console.log("[DEBUG] Fetch completed, found",r.length,"lorebooks"),e({lorebooks:r,lorebookLoading:!1}),r.length>0&&!t().selectedLorebook&&t().selectLorebook(r[0])}catch(n){console.error("Failed to fetch lorebooks:",n),e({lorebookLoading:!1})}},selectLorebook:n=>{e({selectedLorebook:n}),n?t().refreshLoreEntries():e({loreEntries:[],totalEntries:0,currentPage:0,hasMoreEntries:!1})},createLorebookAction:async n=>{try{const r=await s1({name:n.name,description:n.description||"",entries:n.entries||[]});return t().fetchLorebooks(),r}catch(r){throw console.error("Failed to create lorebook:",r),r}},updateLorebookAction:async(n,r)=>{try{await Wm(n,r);const s=t().lorebooks.map(i=>i.id===n?{...i,...r}:i);e({lorebooks:s});const o=t().selectedLorebook;o&&o.id===n&&e({selectedLorebook:{...o,...r}})}catch(s){throw console.error("Failed to update lorebook:",s),s}},deleteLorebookAction:async n=>{try{await f1(n);const r=t().lorebooks.filter(o=>o.id!==n);e({lorebooks:r});const s=t().selectedLorebook;s&&s.id===n&&e({selectedLorebook:null,loreEntries:[]})}catch(r){throw console.error("Failed to delete lorebook:",r),r}},refreshLoreEntries:async()=>{const n=t().selectedLorebook;if(n)try{e({entryLoading:!0});const s=(await fc(n.id)).entries||[];e({loreEntries:s,totalEntries:s.length,currentPage:0,hasMoreEntries:!1,entryLoading:!1})}catch(r){console.error("Failed to refresh lore entries:",r),e({entryLoading:!1})}},loadLoreEntriesPaginated:async(n=0,r=50)=>{const s=t().selectedLorebook;if(s)try{e({entryLoading:!0});const i=(await fc(s.id)).entries||[],l=n*r,c=l+r;e({loreEntries:i.slice(l,c),currentPage:n,pageSize:r,totalEntries:i.length,hasMoreEntries:c<i.length,entryLoading:!1})}catch(o){console.error("Failed to load lore entries:",o),e({entryLoading:!1})}},createLoreEntryAction:async n=>{try{const r=t().selectedLorebook;if(!r)throw new Error("No lorebook selected");const s={...n,lorebook_id:r.id},o=await u1(s),i=t().loreEntries;return e({loreEntries:[...i,o],totalEntries:t().totalEntries+1}),o}catch(r){throw console.error("Failed to create lore entry:",r),r}},updateLoreEntryAction:async(n,r)=>{try{await Vm(n,r);const o=t().loreEntries.map(i=>i.id===n?{...i,...r}:i);e({loreEntries:o})}catch(s){throw console.error("Failed to update lore entry:",s),s}},deleteLoreEntryAction:async(n,r=!0)=>{try{if(await d1(n),r){const o=t().loreEntries.filter(i=>i.id!==n);e({loreEntries:o,totalEntries:t().totalEntries-1,selectedEntries:new Set([...t().selectedEntries].filter(i=>i!==n))})}}catch(s){throw console.error("Failed to delete lore entry:",s),s}},searchLoreAction:async(n,r={},s=!1)=>{try{e({isSearching:!0,searchQuery:n});const o=await h1(n,100,s);e({searchResults:o.results||[],isSearching:!1})}catch(o){console.error("Search failed:",o),e({isSearching:!1})}},clearSearch:()=>{e({searchQuery:"",searchResults:[],searchFilters:{keywords:[],secondary_keywords:[]}})},toggleEntrySelection:n=>{const r=new Set(t().selectedEntries);r.has(n)?r.delete(n):r.add(n),e({selectedEntries:r})},selectAllEntries:()=>{const n=t().loreEntries.map(s=>s.id);if(new Set([...n].filter(s=>!t().selectedEntries.has(s))).size>0){const s=new Set([...t().selectedEntries,...n]);e({selectedEntries:s})}else e({selectedEntries:new Set})},clearSelection:()=>{e({selectedEntries:new Set})},bulkUpdateEntries:async n=>{const r=Array.from(t().selectedEntries);try{for(const s of r)n.type==="update"&&await t().updateLoreEntryAction(s,n.data);t().clearSelection()}catch(s){throw console.error("Bulk update failed:",s),s}},bulkDeleteEntries:async()=>{const n=Array.from(t().selectedEntries);try{for(const o of n)await t().deleteLoreEntryAction(o,!1);const s=t().loreEntries.filter(o=>!n.includes(o.id));e({loreEntries:s,selectedEntries:new Set,totalEntries:t().totalEntries-n.length})}catch(r){throw console.error("Bulk delete failed:",r),r}},loadLinkedCharacters:async n=>{try{const r=await g1(n);e({linkedCharacters:r.lorebooks||[]})}catch(r){throw console.error("Failed to load linked characters:",r),r}},linkCharacterAction:async n=>{const r=t().selectedLorebook;if(r)try{await p1(n,r.id),t().loadLinkedCharacters(n)}catch(s){throw console.error("Failed to link character:",s),s}},unlinkCharacterAction:async n=>{const r=t().selectedLorebook;if(r)try{await m1(n,r.id),t().loadLinkedCharacters(n)}catch(s){throw console.error("Failed to unlink character:",s),s}},importLorebookAction:async n=>{try{await o1(n),t().fetchLorebooks()}catch(r){throw console.error("Import failed:",r),r}},injectContextForChat:async(n,r={})=>{const s=t().selectedLorebook;if(!s)throw new Error("No lorebook selected");const o=n.slice(-3).join(" "),i={session_id:r.sessionId||"default",max_tokens:r.maxTokens||1e3,lorebook_ids:s?[s.id]:[],recent_text:o};try{return await y1(i)}catch(l){throw console.error("Context injection failed:",l),l}},setShowEditor:(n,r=null)=>{e({showEditor:n,editingEntry:r})},setShowBulkOps:n=>{e({showBulkOps:n})},setShowImport:n=>{e({showImport:n})},getCached:n=>t().cache.get(n),setCached:(n,r)=>{const s=new Map(t().cache);s.set(n,r),e({cache:s})},reset:()=>{e({selectedLorebook:null,loreEntries:[],selectedEntries:new Set,currentPage:0,searchQuery:"",searchResults:[],showEditor:!1,editingEntry:null,showBulkOps:!1,showImport:!1,linkedCharacters:[],availableCharacters:[]})}}),{name:"lorebook-store"})),W1=({lorebooks:e,viewMode:t,selectedLorebookId:n,onSelectLorebook:r,onEditLorebook:s,onDeleteLorebook:o,onCreateLorebook:i})=>{const[l,c]=v.useState(""),[u,d]=v.useState(""),f=async p=>{p.preventDefault(),l.trim()&&(await i({name:l,description:u,entries:[]}),c(""),d(""))};return e.length===0?a.jsxs("div",{className:"empty-state",children:[a.jsx("div",{className:"empty-icon",children:""}),a.jsx("h3",{children:"No Lorebooks Yet"}),a.jsx("p",{children:"Create your first lorebook to get started with organizing your game world."}),a.jsxs("form",{onSubmit:f,className:"quick-create-form",children:[a.jsx("input",{type:"text",placeholder:"Lorebook name",value:l,onChange:p=>c(p.target.value),required:!0}),a.jsx("input",{type:"text",placeholder:"Description (optional)",value:u,onChange:p=>d(p.target.value)}),a.jsx("button",{type:"submit",className:"primary",children:"Create Lorebook"})]})]}):t==="table"?a.jsx("div",{className:"lorebook-table-container",children:a.jsxs("table",{className:"lorebook-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Name"}),a.jsx("th",{children:"Description"}),a.jsx("th",{children:"Entries"}),a.jsx("th",{children:"Last Updated"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:e.map(p=>a.jsxs("tr",{className:n===p.id?"selected":"",onClick:()=>r(p),children:[a.jsx("td",{className:"lorebook-name",children:p.name}),a.jsx("td",{className:"lorebook-description",children:p.description||""}),a.jsx("td",{className:"entry-count",children:p.entry_count}),a.jsx("td",{className:"updated-at",children:new Date(p.updated_at).toLocaleDateString()}),a.jsxs("td",{className:"actions",children:[a.jsx("button",{onClick:m=>{m.stopPropagation(),s(p)},title:"Edit lorebook",children:""}),a.jsx("button",{onClick:m=>{m.stopPropagation(),o(p.id)},title:"Delete lorebook",className:"delete-btn",children:""})]})]},p.id))})]})}):a.jsxs("div",{className:"lorebook-grid",children:[e.map(p=>a.jsx(Y1,{lorebook:p,isSelected:n===p.id,onSelect:()=>r(p),onEdit:()=>s(p),onDelete:()=>o(p.id)},p.id)),a.jsxs("div",{className:"lorebook-card quick-create-card",children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-icon add-icon",children:""}),a.jsx("h3",{children:"Create New"})]}),a.jsx("div",{className:"card-content",children:a.jsxs("form",{onSubmit:f,children:[a.jsx("input",{type:"text",placeholder:"Lorebook title",value:l,onChange:p=>c(p.target.value),required:!0}),a.jsx("textarea",{placeholder:"Brief description...",value:u,onChange:p=>d(p.target.value),rows:2}),a.jsx("button",{type:"submit",className:"primary create-btn",children:"Create Lorebook"})]})})]})]})},Y1=({lorebook:e,isSelected:t,onSelect:n,onEdit:r,onDelete:s})=>{const[o,i]=v.useState(!1),l=c=>{const u=new Date(c),f=Math.abs(new Date().getTime()-u.getTime()),p=Math.ceil(f/(1e3*60*60*24));return p===1?"Today":p===2?"Yesterday":p<=7?`${p-1} days ago`:u.toLocaleDateString()};return a.jsxs("div",{className:`lorebook-card ${t?"selected":""} ${o?"show-actions":""}`,onClick:n,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[a.jsxs("div",{className:"card-header",children:[a.jsx("div",{className:"card-icon",children:""}),a.jsx("h3",{className:"card-title",children:e.name}),a.jsxs("div",{className:"card-actions",children:[a.jsx("button",{onClick:c=>{c.stopPropagation(),r()},title:"Edit lorebook",children:""}),a.jsx("button",{onClick:c=>{c.stopPropagation(),window.confirm(`Delete "${e.name}"?`)&&s()},title:"Delete lorebook",className:"delete-btn",children:""})]})]}),a.jsxs("div",{className:"card-content",children:[a.jsx("p",{className:"card-description",children:e.description||"No description"}),a.jsxs("div",{className:"card-stats",children:[a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-label",children:"Entries:"}),a.jsx("span",{className:"stat-value",children:e.entry_count})]}),a.jsxs("div",{className:"stat",children:[a.jsx("span",{className:"stat-label",children:"Updated:"}),a.jsx("span",{className:"stat-value",children:l(e.updated_at)})]})]})]}),t&&a.jsx("div",{className:"selection-indicator",children:" Selected"})]})},K1=({onSearch:e,onClear:t,isSearching:n,searchResults:r})=>{const[s,o]=v.useState(""),[i,l]=v.useState(null),[c,u]=v.useState(!1),[d,f]=v.useState({keywords:[],secondaryKeywords:[],logic:"AND ANY",minTrigger:"",maxTrigger:"",limit:50}),[p,m]=v.useState(!1),y=v.useCallback(k=>{i&&clearTimeout(i);const C=setTimeout(async()=>{k.trim()?await e(k,p):t()},300);l(C)},[e,t,i,p]),x=k=>{const C=k.target.value;o(C),y(C)},j=async()=>{(s||d.keywords.length>0)&&await e(s,p)},h=()=>{o(""),f({keywords:[],secondaryKeywords:[],logic:"AND ANY",minTrigger:"",maxTrigger:"",limit:50}),t()},g=(k,C)=>{C.trim()&&f(N=>({...N,[k]:[...N[k],C.trim()].filter((T,P,$)=>$.indexOf(T)===P)}))},w=(k,C)=>{f(N=>({...N,[k]:N[k].filter(T=>T!==C)}))};return a.jsxs("div",{className:"lorebook-search",children:[a.jsxs("div",{className:"search-input-container",children:[a.jsxs("div",{className:"search-input-wrapper",children:[a.jsx("input",{type:"text",placeholder:"Search lore entries...",value:s,onChange:x,className:"search-input"}),s&&a.jsx("button",{onClick:h,className:"clear-search-btn",title:"Clear search",children:""}),a.jsx("button",{onClick:()=>u(!c),className:`advanced-search-btn ${c?"active":""}`,title:"Advanced search",children:""})]}),r.length>0&&s&&a.jsxs("div",{className:"search-stats",children:["Found ",r.length,' entries matching "',s,'"']})]}),c&&a.jsx("div",{className:"advanced-search-panel",children:a.jsxs("div",{className:"advanced-search-content",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("h4",{children:"Primary Keywords"}),a.jsxs("div",{className:"keyword-input-group",children:[d.keywords.map((k,C)=>a.jsxs("span",{className:"keyword-tag",children:[k,a.jsx("button",{onClick:()=>w("keywords",k),className:"remove-keyword",children:""})]},C)),a.jsx("input",{type:"text",placeholder:"Add keyword...",onKeyPress:k=>{k.key==="Enter"&&(g("keywords",k.target.value),k.target.value="")},className:"keyword-input"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("h4",{children:"Secondary Keywords"}),a.jsxs("div",{className:"keyword-input-group",children:[d.secondaryKeywords.map((k,C)=>a.jsxs("span",{className:"keyword-tag",children:[k,a.jsx("button",{onClick:()=>w("secondaryKeywords",k),className:"remove-keyword",children:""})]},C)),a.jsx("input",{type:"text",placeholder:"Add secondary keyword...",onKeyPress:k=>{k.key==="Enter"&&(g("secondaryKeywords",k.target.value),k.target.value="")},className:"keyword-input"})]})]}),a.jsxs("div",{className:"filter-row",children:[a.jsxs("div",{className:"filter-group",children:[a.jsx("div",{className:"filter-row",children:a.jsxs("div",{className:"filter-group",children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:p,onChange:k=>m(k.target.checked)}),"Enable Semantic Search (RAG)"]}),a.jsx("div",{className:"rag-info",children:a.jsx("small",{children:"Use semantic search for better results based on meaning rather than exact keywords"})})]})}),a.jsx("h4",{children:"Logic"}),a.jsxs("select",{value:d.logic,onChange:k=>f(C=>({...C,logic:k.target.value})),className:"logic-select",children:[a.jsx("option",{value:"AND ANY",children:"AND ANY"}),a.jsx("option",{value:"AND ALL",children:"AND ALL"}),a.jsx("option",{value:"NOT ANY",children:"NOT ANY"}),a.jsx("option",{value:"NOT ALL",children:"NOT ALL"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("h4",{children:"Trigger Range"}),a.jsxs("div",{className:"trigger-range",children:[a.jsx("input",{type:"number",placeholder:"Min%",value:d.minTrigger,onChange:k=>f(C=>({...C,minTrigger:k.target.value})),min:"0",max:"100"}),a.jsx("span",{children:"to"}),a.jsx("input",{type:"number",placeholder:"Max%",value:d.maxTrigger,onChange:k=>f(C=>({...C,maxTrigger:k.target.value})),min:"0",max:"100"})]})]}),a.jsxs("div",{className:"filter-group",children:[a.jsx("h4",{children:"Limit Results"}),a.jsx("input",{type:"number",value:d.limit,onChange:k=>f(C=>({...C,limit:parseInt(k.target.value,10)||50})),min:"1",max:"1000",className:"limit-input"})]})]}),a.jsxs("div",{className:"advanced-search-actions",children:[a.jsx("button",{onClick:j,disabled:n,className:"primary",children:n?"Searching...":"Search"}),a.jsx("button",{onClick:h,className:"secondary",children:"Clear All"}),a.jsx("button",{onClick:()=>u(!1),className:"secondary",children:"Close"})]})]})}),s&&a.jsx("div",{className:"search-results-summary",children:n?a.jsxs("div",{className:"searching-indicator",children:[a.jsx("div",{className:"spinner"}),"Searching..."]}):r.length>0?a.jsx(G1,{results:r.slice(0,3)}):s&&a.jsxs("div",{className:"no-results",children:['No entries found matching "',s,'"']})})]})},G1=({results:e})=>a.jsxs("div",{className:"search-results-preview",children:[e.map((t,n)=>{var r;return a.jsxs("div",{className:"search-result-item",children:[a.jsxs("div",{className:"result-header",children:[a.jsx("h4",{children:t.title||"Untitled Entry"}),a.jsxs("span",{className:"result-score",children:["Score: ",Math.round(t.score)]})]}),a.jsxs("div",{className:"result-content",children:[t.content.substring(0,100),"..."]}),a.jsxs("div",{className:"result-meta",children:[t.lorebook_name,"  Keywords: ",((r=t.keywords)==null?void 0:r.join(", "))||"none"]})]},n)}),e.length>=3&&a.jsxs("div",{className:"view-all-results",children:["+ ",e.length," more results..."]})]}),X1=({selectedCount:e,onBulkDelete:t,onBulkEdit:n,onClearSelection:r,onBulkTag:s,onBulkMove:o})=>{const[i,l]=v.useState("idle"),[c,u]=v.useState("");if(e===0)return null;const d=async()=>{if(i!=="deleting"){l("deleting");return}if(window.confirm(`Delete ${e} entry${e===1?"":"ies"}? This action cannot be undone.`))try{await t(),l("idle")}catch(m){console.error("Bulk delete failed:",m),l("idle")}else l("idle")},f=async()=>{if(c.trim()&&s)try{await s(c.trim()),u("")}catch(m){console.error("Bulk tagging failed:",m)}},p=m=>i===m?"active":"";return a.jsxs("div",{className:"bulk-actions-panel",children:[a.jsxs("div",{className:"bulk-selection-info",children:[a.jsxs("span",{className:"selection-count",children:[e," entr",e===1?"y":"ies"," selected"]}),a.jsx("button",{onClick:r,className:"clear-selection-btn",title:"Clear selection",children:""})]}),a.jsxs("div",{className:"bulk-action-buttons",children:[a.jsx("button",{onClick:()=>l("editing"),className:`bulk-action-btn edit-btn ${p("editing")}`,title:"Bulk edit selected entries",children:" Edit"}),s&&a.jsx("button",{onClick:()=>{},className:"bulk-action-btn tag-btn",title:"Add tag to selected entries",children:" Tag"}),o&&a.jsx("button",{onClick:()=>{},className:"bulk-action-btn move-btn",title:"Move selected entries",children:" Move"}),a.jsxs("button",{onClick:d,className:`bulk-action-btn delete-btn ${p("deleting")}`,title:"Delete selected entries",children:[" ",i==="deleting"?"Confirm Delete":"Delete"]})]}),i==="editing"&&a.jsx(J1,{selectedCount:e,onSave:()=>{n(),l("idle")},onCancel:()=>l("idle")}),i==="tagging"&&s&&a.jsx("div",{className:"bulk-tagging-panel",children:a.jsxs("div",{className:"tag-input-group",children:[a.jsx("input",{type:"text",placeholder:"Add tag to selected entries...",value:c,onChange:m=>u(m.target.value),onKeyPress:m=>{m.key==="Enter"&&f()},autoFocus:!0}),a.jsx("button",{onClick:f,disabled:!c.trim(),className:"add-tag-btn",children:"Add Tag"}),a.jsx("button",{onClick:()=>{l("idle"),u("")},className:"cancel-tag-btn",children:"Cancel"})]})}),i==="deleting"&&a.jsxs("div",{className:"bulk-delete-confirm",children:[a.jsxs("div",{className:"confirm-message",children:["This will permanently delete ",e," selected entr",e===1?"y":"ies",". This action cannot be undone."]}),a.jsxs("div",{className:"confirm-actions",children:[a.jsx("button",{onClick:d,className:"confirm-delete-btn danger",children:"Yes, Delete All"}),a.jsx("button",{onClick:()=>l("idle"),className:"cancel-delete-btn",children:"Cancel"})]})]})]})},J1=({selectedCount:e,onSave:t,onCancel:n})=>{const[r,s]=v.useState("logic"),[o,i]=v.useState(""),l=()=>{t()};return a.jsxs("div",{className:"bulk-edit-panel",children:[a.jsxs("div",{className:"panel-header",children:[a.jsxs("h3",{children:["Bulk Edit ",e," Entr",e===1?"y":"ies"]}),a.jsx("button",{onClick:n,className:"close-btn",title:"Close bulk edit",children:""})]}),a.jsxs("div",{className:"bulk-edit-content",children:[a.jsxs("div",{className:"field-selector",children:[a.jsx("label",{children:"Field to edit:"}),a.jsxs("select",{value:r,onChange:c=>s(c.target.value),children:[a.jsx("option",{value:"logic",children:"Logic"}),a.jsx("option",{value:"trigger",children:"Trigger"}),a.jsx("option",{value:"order",children:"Order"}),a.jsx("option",{value:"addKeyword",children:"Add Keyword"}),a.jsx("option",{value:"removeKeyword",children:"Remove Keyword"})]})]}),a.jsxs("div",{className:"value-input",children:[r==="logic"&&a.jsxs("select",{value:o||"AND ANY",onChange:c=>i(c.target.value),children:[a.jsx("option",{value:"AND ANY",children:"AND ANY"}),a.jsx("option",{value:"AND ALL",children:"AND ALL"}),a.jsx("option",{value:"NOT ANY",children:"NOT ANY"}),a.jsx("option",{value:"NOT ALL",children:"NOT ALL"})]}),r==="trigger"&&a.jsxs("div",{className:"range-input",children:[a.jsx("input",{type:"range",min:"0",max:"100",step:"10",value:o||50,onChange:c=>i(parseInt(c.target.value,10))}),a.jsxs("span",{children:[o||50,"%"]})]}),r==="order"&&a.jsx("input",{type:"number",value:o||0,onChange:c=>i(parseFloat(c.target.value)),step:"0.1",placeholder:"0.0"}),(r==="addKeyword"||r==="removeKeyword")&&a.jsx("input",{type:"text",value:o||"",onChange:c=>i(c.target.value),placeholder:"Enter keyword..."})]}),a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Preview:"}),a.jsxs("div",{className:"preview-text",children:["Set ",a.jsx("strong",{children:r})," to ",a.jsx("strong",{children:o||"value"})," for selected entries"]})]})]}),a.jsxs("div",{className:"panel-actions",children:[a.jsx("button",{onClick:l,className:"primary",children:"Apply Changes"}),a.jsx("button",{onClick:n,className:"secondary",children:"Cancel"})]})]})},Q1=({onImport:e,onCancel:t})=>{const[n,r]=v.useState(!1),[s,o]=v.useState(null),[i,l]=v.useState(!1),[c,u]=v.useState(null),[d,f]=v.useState(null),p=C=>{C.preventDefault(),r(!0)},m=C=>{C.preventDefault(),r(!1)},y=C=>{C.preventDefault(),r(!1),u(null);const N=Array.from(C.dataTransfer.files);N.length>0&&j(N[0])},x=C=>{const N=C.target.files;N&&N.length>0&&j(N[0])},j=async C=>{if(!C.name.toLowerCase().endsWith(".json")){u("Only JSON files are supported");return}const N=10*1024*1024;if(C.size>N){u("File size must be less than 10MB");return}o(C),u(null);try{const T=await C.text(),P=JSON.parse(T),$=h(P);f($)}catch{u("Invalid JSON format"),f(null)}},h=C=>{var N;try{let T=[];if(C&&typeof C=="object"){C.entries?T=Array.isArray(C.entries)?C.entries:Object.values(C.entries||{}):Array.isArray(C)&&(T=C);const P={name:C.name||((N=s==null?void 0:s.name)==null?void 0:N.replace(".json","")),description:C.description||"",totalEntries:T.length,keywords:[],logicTypes:{},averageTrigger:0,previewEntries:T.slice(0,3),format:g(C)};let $=0;const M=new Set,B=new Set;return T.forEach(W=>{W.keywords&&Array.isArray(W.keywords)&&W.keywords.forEach(V=>M.add(V)),W.logic&&(P.logicTypes[W.logic]=(P.logicTypes[W.logic]||0)+1),typeof W.trigger=="number"&&($+=W.trigger)}),P.keywords=Array.from(M),P.averageTrigger=T.length>0?Math.round($/T.length):0,P}}catch(T){console.error("Preview generation error:",T)}return null},g=C=>C.entries&&C.name?"SillyTavern":Array.isArray(C)?"Compact Array":C.lastUpdate?"AidanAI":"Unknown",w=async()=>{if(s){l(!0),u(null);try{await e(s)}catch(C){u(C.message||"Import failed")}finally{l(!1)}}},k=()=>{o(null),f(null),u(null)};return a.jsxs("div",{className:"lorebook-import-panel",children:[a.jsxs("div",{className:"panel-header",children:[a.jsx("h3",{children:"Import Lorebook"}),a.jsx("button",{onClick:t,className:"close-btn",title:"Close import panel",children:""})]}),a.jsxs("div",{className:"import-content",children:[s?a.jsxs("div",{className:"file-preview",children:[a.jsxs("div",{className:"file-header",children:[a.jsxs("div",{className:"file-info",children:[a.jsxs("h4",{children:[" ",s.name]}),a.jsxs("span",{className:"file-size",children:[(s.size/1024).toFixed(1)," KB"]})]}),a.jsx("div",{className:"file-actions",children:a.jsx("button",{onClick:k,className:"secondary",children:"Choose Different File"})})]}),c&&a.jsxs("div",{className:"error-message",children:[a.jsx("span",{className:"error-icon",children:""}),c]}),d&&a.jsxs("div",{className:"import-preview",children:[a.jsx("h4",{children:"Import Preview"}),a.jsxs("div",{className:"preview-grid",children:[a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Lorebook Name:"}),a.jsx("span",{children:d.name||"Untitled"})]}),a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Format:"}),a.jsx("span",{children:d.format})]}),a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Entries:"}),a.jsx("span",{children:d.totalEntries})]}),a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Keywords:"}),a.jsxs("span",{children:[d.keywords.length," unique"]})]}),Object.keys(d.logicTypes).length>0&&a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Logic Types:"}),a.jsx("span",{children:Object.entries(d.logicTypes).map(([C,N])=>`${C}: ${N}`).join(", ")})]}),d.averageTrigger>0&&a.jsxs("div",{className:"preview-section",children:[a.jsx("label",{children:"Avg. Trigger:"}),a.jsxs("span",{children:[d.averageTrigger,"%"]})]})]}),d.previewEntries&&d.previewEntries.length>0&&a.jsxs("div",{className:"sample-entries",children:[a.jsx("h5",{children:"Sample Entries:"}),a.jsx("div",{className:"entry-preview",children:d.previewEntries.slice(0,3).map((C,N)=>{var T;return a.jsxs("div",{className:"entry-summary",children:[a.jsx("div",{className:"entry-title",children:C.title||C.comment||"Untitled"}),a.jsxs("div",{className:"entry-content",children:[(T=C.content)==null?void 0:T.substring(0,100),"..."]}),C.keywords&&C.keywords.length>0&&a.jsxs("div",{className:"entry-keywords",children:["Keywords: ",C.keywords.slice(0,3).join(", "),C.keywords.length>3&&` +${C.keywords.length-3} more`]})]},N)})})]})]}),a.jsxs("div",{className:"import-actions",children:[a.jsx("button",{onClick:w,disabled:i||!!c,className:"primary import-btn",children:i?"Importing...":"Import Lorebook"}),a.jsx("button",{onClick:t,className:"secondary",disabled:i,children:"Cancel"})]})]}):a.jsx("div",{className:`file-dropzone ${n?"dragging":""}`,onDragOver:p,onDragLeave:m,onDrop:y,children:a.jsxs("div",{className:"dropzone-content",children:[a.jsx("div",{className:"upload-icon",children:""}),a.jsx("p",{children:"Drop JSON file here"}),a.jsx("p",{children:"or"}),a.jsxs("label",{className:"file-input-label",children:["Browse Files",a.jsx("input",{type:"file",accept:"application/json,.json",onChange:x,hidden:!0})]}),a.jsx("small",{className:"file-info",children:"Supports SillyTavern, AidanAI, and compact JSON formats (max 10MB)"})]})}),a.jsxs("div",{className:"import-help",children:[a.jsx("h5",{children:"Supported Formats:"}),a.jsxs("ul",{children:[a.jsxs("li",{children:[a.jsx("strong",{children:"SillyTavern:"})," Standard lorebook JSON with name, description, and entries"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"AidanAI:"})," Lore export with specific field mappings"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Compact Array:"})," Simple array of entry objects"]})]}),a.jsx("p",{children:"All formats are automatically converted to the internal structure."})]})]})]})},Z1=({lorebooks:e})=>{const[t,n]=v.useState([]);v.useEffect(()=>{(async()=>{try{const i=await fetch(`${Q}/config`);if(i.ok){const l=await i.json();n(l.active_lorebook_ids||[])}}catch(i){console.error("Failed to load active lorebook IDs:",i)}})()},[]);const r=async o=>{if(t.includes(o))return;const i=[...t,o];n(i);try{await fetch(`${Q}/config/active_lorebook_ids`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:i})})}catch(l){console.error("Failed to add active lorebook:",l)}},s=async o=>{const i=t.filter(l=>l!==o);n(i);try{await fetch(`${Q}/config/active_lorebook_ids`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:i})})}catch(l){console.error("Failed to remove active lorebook:",l)}};return a.jsxs("div",{style:{padding:"16px",background:"var(--panel)",borderRadius:"8px",marginBottom:"16px"},children:[a.jsx("h3",{style:{margin:"0 0 12px 0",color:"var(--text)"},children:"Active Lorebooks for Chat Context"}),a.jsx("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap",marginBottom:"8px"},children:a.jsxs("select",{onChange:o=>{o.target.value&&(r(parseInt(o.target.value)),o.target.value="")},value:"",style:{padding:"4px 8px",borderRadius:"4px",background:"var(--bg)",color:"var(--text)",border:"1px solid var(--muted)"},children:[a.jsx("option",{value:"",children:"+ Add to Active"}),e.filter(o=>!t.includes(o.id)).map(o=>a.jsx("option",{value:o.id,children:o.name},o.id))]})}),a.jsx("div",{style:{display:"flex",gap:"6px",flexWrap:"wrap"},children:t.map(o=>{const i=e.find(l=>l.id===o);return a.jsxs("span",{style:{padding:"4px 8px",borderRadius:"12px",background:"var(--primary)",color:"var(--text)",fontSize:"12px",display:"flex",alignItems:"center",gap:"4px",cursor:"pointer"},title:`Active in chat: ${(i==null?void 0:i.name)||`#${o}`}`,children:[i?i.name:`#${o}`,a.jsx("button",{onClick:()=>s(o),style:{border:"none",background:"transparent",color:"var(--text)",cursor:"pointer",fontSize:"14px",lineHeight:1,padding:"0",marginLeft:"4px"},children:""})]},o)})}),t.length===0&&a.jsx("p",{style:{margin:"8px 0 0 0",color:"var(--muted)",fontSize:"14px"},children:"No active lorebooks. Select one above to add it to your current chat context."})]})},q1=()=>{var j;const e=Lu(),[t,n]=v.useState("cards"),[r,s]=v.useState("single"),[o,i]=v.useState(null),[l,c]=v.useState([]);v.useEffect(()=>{console.log("[DEBUG] LorebookDashboard useEffect triggered, calling fetchLorebooks"),e.fetchLorebooks()},[]);const u=I.useMemo(()=>e.lorebooks,[e.lorebooks]),d=async h=>{try{await e.createLorebookAction(h),s("single")}catch(g){console.error("Failed to create lorebook:",g)}},f=async h=>{for(const g of h)await d(g);s("single")},p=async h=>{try{await e.importLorebookAction(h),s("single")}catch(g){console.error("Import failed:",g)}},m=async h=>{i(h);try{const g=await fetch(`${Q}/lorebooks/${h.id}`);if(g.ok){const w=await g.json();c(w.entries||[])}else c([])}catch(g){console.error("Failed to load lorebook entries:",g),c([])}},y=async()=>{if(o)try{await e.updateLorebookAction(o.id,{name:o.name,description:o.description});const h=l,g=await fetch(`${Q}/lorebooks/${o.id}`);if(!g.ok)throw new Error("Failed to load current entries");const k=(await g.json()).entries||[],C=new Map(k.map(M=>[M.id,M])),N=new Map(h.map(M=>[M.id,M])),T=[],P=[],$=[];for(const M of l)!M.id||M.id.toString().includes(".")?T.push(M):P.push(M);for(const M of k)l.some(W=>W.id===M.id)||$.push(M.id);console.log("Entry operations:",{toCreate:T.length,toUpdate:P.length,toDelete:$.length});for(const M of T)try{const B={lorebook_id:o.id,title:M.title,content:M.content,keywords:M.keywords,secondary_keywords:M.secondary_keywords,logic:M.logic,trigger:M.trigger,order:M.order};await fetch(`${Q}/lorebooks/entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})}catch(B){console.error("Failed to create entry:",B)}for(const M of P)try{const B={title:M.title,content:M.content,keywords:M.keywords,secondary_keywords:M.secondary_keywords,logic:M.logic,trigger:M.trigger,order:M.order};await fetch(`${Q}/lorebooks/entries/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})}catch(B){console.error("Failed to update entry:",B)}for(const M of $)try{await fetch(`${Q}/lorebooks/entries/${M}`,{method:"DELETE"})}catch(B){console.error("Failed to delete entry:",B)}await e.fetchLorebooks(),i(null),c([]),console.log("Lorebook updated successfully")}catch(h){console.error("Failed to update lorebook:",h)}},x=()=>{i(null)};return e.lorebookLoading&&e.lorebooks.length===0?a.jsxs("div",{className:"lorebook-dashboard loading",children:[a.jsx("div",{className:"loading-spinner"}),a.jsx("p",{children:"Loading lorebooks..."})]}):a.jsxs("div",{className:"lorebook-dashboard",children:[a.jsx("div",{className:"dashboard-header",children:a.jsx("h1",{children:"Lorebook Management"})}),a.jsx(Z1,{lorebooks:e.lorebooks}),a.jsx(K1,{onSearch:(h,g)=>e.searchLoreAction(h,{},g),onClear:()=>e.clearSearch(),isSearching:e.isSearching,searchResults:e.searchResults}),a.jsx(X1,{selectedCount:e.selectedEntries.size,onBulkDelete:()=>e.bulkDeleteEntries(),onBulkEdit:()=>{},onClearSelection:()=>e.clearSelection()}),a.jsx("div",{className:"lorebook-stats",children:a.jsxs("span",{className:"stats",children:[e.lorebooks.length," lorebooks, ",e.lorebooks.reduce((h,g)=>h+g.entry_count,0)," total entries"]})}),a.jsxs("div",{className:"dashboard-actions",children:[a.jsx("button",{className:`action-btn ${t==="cards"?"active":""}`,onClick:()=>n("cards"),children:" Cards"}),a.jsx("button",{className:`action-btn ${t==="table"?"active":""}`,onClick:()=>n("table"),children:" Table"}),a.jsxs("div",{className:"dropdown-menu",children:[a.jsx("button",{className:"primary",children:"+ Create"}),a.jsxs("div",{className:"dropdown-content",children:[a.jsx("button",{onClick:()=>s("single"),children:"New Lorebook"}),a.jsx("button",{onClick:()=>s("bulk"),children:"Bulk Create"}),a.jsx("button",{onClick:()=>s("import"),children:"Import JSON"})]})]})]}),a.jsxs("div",{className:"dashboard-content",children:[r==="import"?a.jsx(Q1,{onImport:p,onCancel:()=>s("single")}):r==="bulk"?a.jsx(eS,{onCreate:f,onCancel:()=>s("single")}):a.jsx(W1,{lorebooks:u,viewMode:t,onSelectLorebook:e.selectLorebook,selectedLorebookId:(j=e.selectedLorebook)==null?void 0:j.id,onEditLorebook:m,onDeleteLorebook:h=>{window.confirm("Delete this lorebook? This action cannot be undone.")&&e.deleteLorebookAction(h)},onCreateLorebook:d}),o&&a.jsx("div",{className:"modal-overlay",children:a.jsxs("div",{className:"modal-content large-modal",children:[a.jsxs("div",{className:"modal-header",children:[a.jsxs("h2",{children:["Edit Lorebook: ",o.name]}),a.jsx("button",{className:"close-btn",onClick:x,children:""})]}),a.jsx("div",{className:"modal-body",children:a.jsxs("div",{className:"lorebook-editor",children:[a.jsxs("div",{className:"editor-section",children:[a.jsx("h3",{children:"Lorebook Details"}),a.jsx("div",{className:"metadata-form",children:a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-name",children:"Name:"}),a.jsx("input",{id:"edit-name",name:"name",type:"text",defaultValue:o.name,required:!0,maxLength:255,onChange:h=>{i(g=>g?{...g,name:h.target.value}:null)}})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"edit-description",children:"Description:"}),a.jsx("textarea",{id:"edit-description",name:"description",rows:3,defaultValue:o.description||"",placeholder:"Describe this lorebook...",onChange:h=>{i(g=>g?{...g,description:h.target.value}:null)}})]})]})})]}),a.jsxs("div",{className:"editor-section",children:[a.jsxs("div",{className:"section-header",children:[a.jsx("h3",{children:"Lorebook Entries"}),a.jsx("button",{type:"button",className:"primary",onClick:()=>{const h={id:Date.now()+Math.random(),title:"",content:"",keywords:[],secondary_keywords:[],logic:"AND ANY",trigger:100,order:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c([...l,h])},children:"+ Add Entry"})]}),a.jsxs("div",{className:"entries-editor",children:[l.map((h,g)=>a.jsxs("div",{className:"entry-editor",children:[a.jsxs("div",{className:"entry-header",children:[a.jsx("input",{type:"text",placeholder:"Entry title...",value:h.title,onChange:w=>{const k=[...l];k[g]={...h,title:w.target.value},c(k)}}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Trigger (%):"}),a.jsx("input",{type:"number",min:"0",max:"100",value:h.trigger,onChange:w=>{const k=[...l];k[g]={...h,trigger:parseInt(w.target.value)||0},c(k)}})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Order:"}),a.jsx("input",{type:"number",value:h.order,onChange:w=>{const k=[...l];k[g]={...h,order:parseFloat(w.target.value)||0},c(k)}})]}),a.jsx("button",{type:"button",className:"delete-btn",onClick:()=>{const w=l.filter((k,C)=>C!==g);c(w)},children:""})]}),a.jsxs("div",{className:"form-row",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Keywords:"}),a.jsx("input",{type:"text",placeholder:"keyword1, keyword2",value:h.keywords.join(", "),onChange:w=>{const k=[...l];k[g]={...h,keywords:w.target.value.split(",").map(C=>C.trim()).filter(C=>C)},c(k)}})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Logic:"}),a.jsxs("select",{value:h.logic,onChange:w=>{const k=[...l];k[g]={...h,logic:w.target.value},c(k)},children:[a.jsx("option",{value:"AND ANY",children:"AND ANY"}),a.jsx("option",{value:"AND ALL",children:"AND ALL"}),a.jsx("option",{value:"NOT ANY",children:"NOT ANY"}),a.jsx("option",{value:"NOT ALL",children:"NOT ALL"})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Secondary Keywords:"}),a.jsx("input",{type:"text",placeholder:"secondary1, secondary2",value:h.secondary_keywords.join(", "),onChange:w=>{const k=[...l];k[g]={...h,secondary_keywords:w.target.value.split(",").map(C=>C.trim()).filter(C=>C)},c(k)}})]})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Content:"}),a.jsx("textarea",{rows:4,placeholder:"Entry content...",value:h.content,onChange:w=>{const k=[...l];k[g]={...h,content:w.target.value},c(k)},required:!0})]})]},h.id||g)),l.length===0&&a.jsxs("div",{className:"no-entries",children:[a.jsx("p",{children:"No entries in this lorebook yet."}),a.jsx("button",{type:"button",className:"primary",onClick:()=>{const h={id:Date.now()+Math.random(),title:"",content:"",keywords:[],secondary_keywords:[],logic:"AND ANY",trigger:100,order:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};c([h])},children:"Add First Entry"})]})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{type:"button",className:"primary",onClick:y,children:"Save All Changes"}),a.jsx("button",{type:"button",className:"secondary",onClick:x,children:"Cancel"})]})]})})]})})]})]})},eS=({onCreate:e,onCancel:t})=>{const[n,r]=v.useState(""),s=async()=>{const i=n.split(`
`).filter(l=>l.trim()).map(l=>({name:l.trim(),description:"",entries:[]}));await e(i),r("")};return a.jsxs("div",{className:"bulk-creation-panel",children:[a.jsx("h3",{children:"Create Multiple Lorebooks"}),a.jsx("p",{children:"Enter one lorebook name per line:"}),a.jsx("textarea",{value:n,onChange:o=>r(o.target.value),placeholder:`Fantasy World
Sci-Fi Universe
Historical Era`,rows:6}),a.jsxs("div",{className:"panel-actions",children:[a.jsx("button",{onClick:s,children:"Create"}),a.jsx("button",{className:"secondary",onClick:t,children:"Cancel"})]})]})},Ur=yr((e,t)=>({circuits:[],isExecuting:!1,modalState:{isOpen:!1},promptCircuitAssociations:{main:{promptType:"main"},tool_call:{promptType:"tool_call"},lore_suggest:{promptType:"lore_suggest"},image_summary:{promptType:"image_summary"}},async fetchCircuits(){const r=await(await fetch(`${Q}/circuits/`)).json();e({circuits:r})},async saveCircuit(n){const r=await fetch(`${Q}/circuits/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok)throw new Error("Failed to save");const s=await r.json();e({circuits:[...t().circuits,s],current:s})},async executeCircuit(n,r){e({isExecuting:!0,executionResult:void 0});try{const s=await fetch(`${Q}/circuits/${n}/execute`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context_data:r})});if(!s.ok)throw new Error(`Execution failed: ${s.statusText}`);const o=await s.json();return e({executionResult:o,isExecuting:!1}),o}catch(s){const o={execution_id:"",success:!1,outputs:{},logs:[],errors:[s instanceof Error?s.message:"Unknown error"]};throw e({executionResult:o,isExecuting:!1}),s}},openCircuitModal(n,r){e({modalState:{isOpen:!0,promptType:n,selectedCircuitId:r}})},closeCircuitModal(){e({modalState:{isOpen:!1}})},setPromptCircuitAssociation(n,r,s){const o=t().promptCircuitAssociations,l=t().circuits.find(c=>c.id===r);e({promptCircuitAssociations:{...o,[n]:{promptType:n,circuitId:r,circuitName:s||(l==null?void 0:l.name)}}})},getPromptCircuitAssociation(n){return t().promptCircuitAssociations[n]}}));function et(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=et(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Jm={exports:{}},Qm={},Zm={exports:{}},qm={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var es=v;function tS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nS=typeof Object.is=="function"?Object.is:tS,rS=es.useState,sS=es.useEffect,oS=es.useLayoutEffect,iS=es.useDebugValue;function aS(e,t){var n=t(),r=rS({inst:{value:n,getSnapshot:t}}),s=r[0].inst,o=r[1];return oS(function(){s.value=n,s.getSnapshot=t,ol(s)&&o({inst:s})},[e,n,t]),sS(function(){return ol(s)&&o({inst:s}),e(function(){ol(s)&&o({inst:s})})},[e]),iS(n),n}function ol(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!nS(e,n)}catch{return!0}}function lS(e,t){return t()}var cS=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?lS:aS;qm.useSyncExternalStore=es.useSyncExternalStore!==void 0?es.useSyncExternalStore:cS;Zm.exports=qm;var uS=Zm.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xa=v,dS=uS;function fS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hS=typeof Object.is=="function"?Object.is:fS,pS=dS.useSyncExternalStore,mS=xa.useRef,gS=xa.useEffect,yS=xa.useMemo,vS=xa.useDebugValue;Qm.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var o=mS(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=yS(function(){function c(m){if(!u){if(u=!0,d=m,m=r(m),s!==void 0&&i.hasValue){var y=i.value;if(s(y,m))return f=y}return f=m}if(y=f,hS(d,m))return y;var x=r(m);return s!==void 0&&s(y,x)?(d=m,y):(d=m,f=x)}var u=!1,d,f,p=n===void 0?null:n;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,n,r,s]);var l=pS(e,o[0],o[1]);return gS(function(){i.hasValue=!0,i.value=l},[l]),vS(l),l};Jm.exports=Qm;var xS=Jm.exports;const wS=uh(xS),Sf=e=>{let t;const n=new Set,r=(d,f)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const m=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(y=>y(t,m))}},s=()=>t,c={setState:r,getState:s,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{n.clear()}},u=t=e(r,s,c);return c},SS=e=>e?Sf(e):Sf,{useDebugValue:kS}=I,{useSyncExternalStoreWithSelector:CS}=wS,jS=e=>e;function eg(e,t=jS,n){const r=CS(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return kS(r),r}const kf=(e,t)=>{const n=SS(e),r=(s,o=t)=>eg(n,s,o);return Object.assign(r,n),r},NS=(e,t)=>e?kf(e,t):kf;function ht(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}var ES={value:()=>{}};function wa(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new yi(n)}function yi(e){this._=e}function _S(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}yi.prototype=wa.prototype={constructor:yi,on:function(e,t){var n=this._,r=_S(e+"",n),s,o=-1,i=r.length;if(arguments.length<2){for(;++o<i;)if((s=(e=r[o]).type)&&(s=bS(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<i;)if(s=(e=r[o]).type)n[s]=Cf(n[s],e.name,t);else if(t==null)for(s in n)n[s]=Cf(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new yi(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,o;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],r=0,s=o.length;r<s;++r)o[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,o=r.length;s<o;++s)r[s].value.apply(t,n)}};function bS(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function Cf(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=ES,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var pc="http://www.w3.org/1999/xhtml";const jf={svg:"http://www.w3.org/2000/svg",xhtml:pc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Sa(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),jf.hasOwnProperty(t)?{space:jf[t],local:e}:e}function TS(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===pc&&t.documentElement.namespaceURI===pc?t.createElement(e):t.createElementNS(n,e)}}function PS(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function tg(e){var t=Sa(e);return(t.local?PS:TS)(t)}function LS(){}function Mu(e){return e==null?LS:function(){return this.querySelector(e)}}function MS(e){typeof e!="function"&&(e=Mu(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var o=t[s],i=o.length,l=r[s]=new Array(i),c,u,d=0;d<i;++d)(c=o[d])&&(u=e.call(c,c.__data__,d,o))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new xt(r,this._parents)}function $S(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function AS(){return[]}function ng(e){return e==null?AS:function(){return this.querySelectorAll(e)}}function DS(e){return function(){return $S(e.apply(this,arguments))}}function OS(e){typeof e=="function"?e=DS(e):e=ng(e);for(var t=this._groups,n=t.length,r=[],s=[],o=0;o<n;++o)for(var i=t[o],l=i.length,c,u=0;u<l;++u)(c=i[u])&&(r.push(e.call(c,c.__data__,u,i)),s.push(c));return new xt(r,s)}function rg(e){return function(){return this.matches(e)}}function sg(e){return function(t){return t.matches(e)}}var RS=Array.prototype.find;function IS(e){return function(){return RS.call(this.children,e)}}function zS(){return this.firstElementChild}function FS(e){return this.select(e==null?zS:IS(typeof e=="function"?e:sg(e)))}var BS=Array.prototype.filter;function HS(){return Array.from(this.children)}function US(e){return function(){return BS.call(this.children,e)}}function VS(e){return this.selectAll(e==null?HS:US(typeof e=="function"?e:sg(e)))}function WS(e){typeof e!="function"&&(e=rg(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var o=t[s],i=o.length,l=r[s]=[],c,u=0;u<i;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&l.push(c);return new xt(r,this._parents)}function og(e){return new Array(e.length)}function YS(){return new xt(this._enter||this._groups.map(og),this._parents)}function Yi(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Yi.prototype={constructor:Yi,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function KS(e){return function(){return e}}function GS(e,t,n,r,s,o){for(var i=0,l,c=t.length,u=o.length;i<u;++i)(l=t[i])?(l.__data__=o[i],r[i]=l):n[i]=new Yi(e,o[i]);for(;i<c;++i)(l=t[i])&&(s[i]=l)}function XS(e,t,n,r,s,o,i){var l,c,u=new Map,d=t.length,f=o.length,p=new Array(d),m;for(l=0;l<d;++l)(c=t[l])&&(p[l]=m=i.call(c,c.__data__,l,t)+"",u.has(m)?s[l]=c:u.set(m,c));for(l=0;l<f;++l)m=i.call(e,o[l],l,o)+"",(c=u.get(m))?(r[l]=c,c.__data__=o[l],u.delete(m)):n[l]=new Yi(e,o[l]);for(l=0;l<d;++l)(c=t[l])&&u.get(p[l])===c&&(s[l]=c)}function JS(e){return e.__data__}function QS(e,t){if(!arguments.length)return Array.from(this,JS);var n=t?XS:GS,r=this._parents,s=this._groups;typeof e!="function"&&(e=KS(e));for(var o=s.length,i=new Array(o),l=new Array(o),c=new Array(o),u=0;u<o;++u){var d=r[u],f=s[u],p=f.length,m=ZS(e.call(d,d&&d.__data__,u,r)),y=m.length,x=l[u]=new Array(y),j=i[u]=new Array(y),h=c[u]=new Array(p);n(d,f,x,j,h,m,t);for(var g=0,w=0,k,C;g<y;++g)if(k=x[g]){for(g>=w&&(w=g+1);!(C=j[w])&&++w<y;);k._next=C||null}}return i=new xt(i,r),i._enter=l,i._exit=c,i}function ZS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function qS(){return new xt(this._exit||this._groups.map(og),this._parents)}function ek(e,t,n){var r=this.enter(),s=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?o.remove():n(o),r&&s?r.merge(s).order():s}function tk(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,o=r.length,i=Math.min(s,o),l=new Array(s),c=0;c<i;++c)for(var u=n[c],d=r[c],f=u.length,p=l[c]=new Array(f),m,y=0;y<f;++y)(m=u[y]||d[y])&&(p[y]=m);for(;c<s;++c)l[c]=n[c];return new xt(l,this._parents)}function nk(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,o=r[s],i;--s>=0;)(i=r[s])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function rk(e){e||(e=sk);function t(f,p){return f&&p?e(f.__data__,p.__data__):!f-!p}for(var n=this._groups,r=n.length,s=new Array(r),o=0;o<r;++o){for(var i=n[o],l=i.length,c=s[o]=new Array(l),u,d=0;d<l;++d)(u=i[d])&&(c[d]=u);c.sort(t)}return new xt(s,this._parents).order()}function sk(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ok(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ik(){return Array.from(this)}function ak(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,o=r.length;s<o;++s){var i=r[s];if(i)return i}return null}function lk(){let e=0;for(const t of this)++e;return e}function ck(){return!this.node()}function uk(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],o=0,i=s.length,l;o<i;++o)(l=s[o])&&e.call(l,l.__data__,o,s);return this}function dk(e){return function(){this.removeAttribute(e)}}function fk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function hk(e,t){return function(){this.setAttribute(e,t)}}function pk(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function mk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function gk(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function yk(e,t){var n=Sa(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?fk:dk:typeof t=="function"?n.local?gk:mk:n.local?pk:hk)(n,t))}function ig(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function vk(e){return function(){this.style.removeProperty(e)}}function xk(e,t,n){return function(){this.style.setProperty(e,t,n)}}function wk(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Sk(e,t,n){return arguments.length>1?this.each((t==null?vk:typeof t=="function"?wk:xk)(e,t,n??"")):ts(this.node(),e)}function ts(e,t){return e.style.getPropertyValue(t)||ig(e).getComputedStyle(e,null).getPropertyValue(t)}function kk(e){return function(){delete this[e]}}function Ck(e,t){return function(){this[e]=t}}function jk(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Nk(e,t){return arguments.length>1?this.each((t==null?kk:typeof t=="function"?jk:Ck)(e,t)):this.node()[e]}function ag(e){return e.trim().split(/^|\s+/)}function $u(e){return e.classList||new lg(e)}function lg(e){this._node=e,this._names=ag(e.getAttribute("class")||"")}lg.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function cg(e,t){for(var n=$u(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function ug(e,t){for(var n=$u(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function Ek(e){return function(){cg(this,e)}}function _k(e){return function(){ug(this,e)}}function bk(e,t){return function(){(t.apply(this,arguments)?cg:ug)(this,e)}}function Tk(e,t){var n=ag(e+"");if(arguments.length<2){for(var r=$u(this.node()),s=-1,o=n.length;++s<o;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?bk:t?Ek:_k)(n,t))}function Pk(){this.textContent=""}function Lk(e){return function(){this.textContent=e}}function Mk(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function $k(e){return arguments.length?this.each(e==null?Pk:(typeof e=="function"?Mk:Lk)(e)):this.node().textContent}function Ak(){this.innerHTML=""}function Dk(e){return function(){this.innerHTML=e}}function Ok(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Rk(e){return arguments.length?this.each(e==null?Ak:(typeof e=="function"?Ok:Dk)(e)):this.node().innerHTML}function Ik(){this.nextSibling&&this.parentNode.appendChild(this)}function zk(){return this.each(Ik)}function Fk(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bk(){return this.each(Fk)}function Hk(e){var t=typeof e=="function"?e:tg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Uk(){return null}function Vk(e,t){var n=typeof e=="function"?e:tg(e),r=t==null?Uk:typeof t=="function"?t:Mu(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Wk(){var e=this.parentNode;e&&e.removeChild(this)}function Yk(){return this.each(Wk)}function Kk(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Gk(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Xk(e){return this.select(e?Gk:Kk)}function Jk(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Qk(e){return function(t){e.call(this,t,this.__data__)}}function Zk(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function qk(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,o;n<s;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function eC(e,t,n){return function(){var r=this.__on,s,o=Qk(t);if(r){for(var i=0,l=r.length;i<l;++i)if((s=r[i]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=o,s.options=n),s.value=t;return}}this.addEventListener(e.type,o,n),s={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(s):this.__on=[s]}}function tC(e,t,n){var r=Zk(e+""),s,o=r.length,i;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(s=0,d=l[c];s<o;++s)if((i=r[s]).type===d.type&&i.name===d.name)return d.value}return}for(l=t?eC:qk,s=0;s<o;++s)this.each(l(r[s],t,n));return this}function dg(e,t,n){var r=ig(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function nC(e,t){return function(){return dg(this,e,t)}}function rC(e,t){return function(){return dg(this,e,t.apply(this,arguments))}}function sC(e,t){return this.each((typeof t=="function"?rC:nC)(e,t))}function*oC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,o=r.length,i;s<o;++s)(i=r[s])&&(yield i)}var fg=[null];function xt(e,t){this._groups=e,this._parents=t}function Eo(){return new xt([[document.documentElement]],fg)}function iC(){return this}xt.prototype=Eo.prototype={constructor:xt,select:MS,selectAll:OS,selectChild:FS,selectChildren:VS,filter:WS,data:QS,enter:YS,exit:qS,join:ek,merge:tk,selection:iC,order:nk,sort:rk,call:ok,nodes:ik,node:ak,size:lk,empty:ck,each:uk,attr:yk,style:Sk,property:Nk,classed:Tk,text:$k,html:Rk,raise:zk,lower:Bk,append:Hk,insert:Vk,remove:Yk,clone:Xk,datum:Jk,on:tC,dispatch:sC,[Symbol.iterator]:oC};function _t(e){return typeof e=="string"?new xt([[document.querySelector(e)]],[document.documentElement]):new xt([[e]],fg)}function aC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Rt(e,t){if(e=aC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const lC={passive:!1},lo={capture:!0,passive:!1};function il(e){e.stopImmediatePropagation()}function Vr(e){e.preventDefault(),e.stopImmediatePropagation()}function hg(e){var t=e.document.documentElement,n=_t(e).on("dragstart.drag",Vr,lo);"onselectstart"in t?n.on("selectstart.drag",Vr,lo):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function pg(e,t){var n=e.document.documentElement,r=_t(e).on("dragstart.drag",null);t&&(r.on("click.drag",Vr,lo),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Go=e=>()=>e;function mc(e,{sourceEvent:t,subject:n,target:r,identifier:s,active:o,x:i,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}mc.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function cC(e){return!e.ctrlKey&&!e.button}function uC(){return this.parentNode}function dC(e,t){return t??{x:e.x,y:e.y}}function fC(){return navigator.maxTouchPoints||"ontouchstart"in this}function hC(){var e=cC,t=uC,n=dC,r=fC,s={},o=wa("start","drag","end"),i=0,l,c,u,d,f=0;function p(k){k.on("mousedown.drag",m).filter(r).on("touchstart.drag",j).on("touchmove.drag",h,lC).on("touchend.drag touchcancel.drag",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(k,C){if(!(d||!e.call(this,k,C))){var N=w(this,t.call(this,k,C),k,C,"mouse");N&&(_t(k.view).on("mousemove.drag",y,lo).on("mouseup.drag",x,lo),hg(k.view),il(k),u=!1,l=k.clientX,c=k.clientY,N("start",k))}}function y(k){if(Vr(k),!u){var C=k.clientX-l,N=k.clientY-c;u=C*C+N*N>f}s.mouse("drag",k)}function x(k){_t(k.view).on("mousemove.drag mouseup.drag",null),pg(k.view,u),Vr(k),s.mouse("end",k)}function j(k,C){if(e.call(this,k,C)){var N=k.changedTouches,T=t.call(this,k,C),P=N.length,$,M;for($=0;$<P;++$)(M=w(this,T,k,C,N[$].identifier,N[$]))&&(il(k),M("start",k,N[$]))}}function h(k){var C=k.changedTouches,N=C.length,T,P;for(T=0;T<N;++T)(P=s[C[T].identifier])&&(Vr(k),P("drag",k,C[T]))}function g(k){var C=k.changedTouches,N=C.length,T,P;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),T=0;T<N;++T)(P=s[C[T].identifier])&&(il(k),P("end",k,C[T]))}function w(k,C,N,T,P,$){var M=o.copy(),B=Rt($||N,C),W,V,E;if((E=n.call(k,new mc("beforestart",{sourceEvent:N,target:p,identifier:P,active:i,x:B[0],y:B[1],dx:0,dy:0,dispatch:M}),T))!=null)return W=E.x-B[0]||0,V=E.y-B[1]||0,function O(L,F,A){var b=B,D;switch(L){case"start":s[P]=O,D=i++;break;case"end":delete s[P],--i;case"drag":B=Rt(A||F,C),D=i;break}M.call(L,k,new mc(L,{sourceEvent:F,subject:E,target:p,identifier:P,active:D,x:B[0]+W,y:B[1]+V,dx:B[0]-b[0],dy:B[1]-b[1],dispatch:M}),T)}}return p.filter=function(k){return arguments.length?(e=typeof k=="function"?k:Go(!!k),p):e},p.container=function(k){return arguments.length?(t=typeof k=="function"?k:Go(k),p):t},p.subject=function(k){return arguments.length?(n=typeof k=="function"?k:Go(k),p):n},p.touchable=function(k){return arguments.length?(r=typeof k=="function"?k:Go(!!k),p):r},p.on=function(){var k=o.on.apply(o,arguments);return k===o?p:k},p.clickDistance=function(k){return arguments.length?(f=(k=+k)*k,p):Math.sqrt(f)},p}function Au(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function mg(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function _o(){}var co=.7,Ki=1/co,Wr="\\s*([+-]?\\d+)\\s*",uo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pC=/^#([0-9a-f]{3,8})$/,mC=new RegExp(`^rgb\\(${Wr},${Wr},${Wr}\\)$`),gC=new RegExp(`^rgb\\(${qt},${qt},${qt}\\)$`),yC=new RegExp(`^rgba\\(${Wr},${Wr},${Wr},${uo}\\)$`),vC=new RegExp(`^rgba\\(${qt},${qt},${qt},${uo}\\)$`),xC=new RegExp(`^hsl\\(${uo},${qt},${qt}\\)$`),wC=new RegExp(`^hsla\\(${uo},${qt},${qt},${uo}\\)$`),Nf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Au(_o,fo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ef,formatHex:Ef,formatHex8:SC,formatHsl:kC,formatRgb:_f,toString:_f});function Ef(){return this.rgb().formatHex()}function SC(){return this.rgb().formatHex8()}function kC(){return gg(this).formatHsl()}function _f(){return this.rgb().formatRgb()}function fo(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=pC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?bf(t):n===3?new ct(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Xo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Xo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mC.exec(e))?new ct(t[1],t[2],t[3],1):(t=gC.exec(e))?new ct(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yC.exec(e))?Xo(t[1],t[2],t[3],t[4]):(t=vC.exec(e))?Xo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xC.exec(e))?Lf(t[1],t[2]/100,t[3]/100,1):(t=wC.exec(e))?Lf(t[1],t[2]/100,t[3]/100,t[4]):Nf.hasOwnProperty(e)?bf(Nf[e]):e==="transparent"?new ct(NaN,NaN,NaN,0):null}function bf(e){return new ct(e>>16&255,e>>8&255,e&255,1)}function Xo(e,t,n,r){return r<=0&&(e=t=n=NaN),new ct(e,t,n,r)}function CC(e){return e instanceof _o||(e=fo(e)),e?(e=e.rgb(),new ct(e.r,e.g,e.b,e.opacity)):new ct}function gc(e,t,n,r){return arguments.length===1?CC(e):new ct(e,t,n,r??1)}function ct(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Au(ct,gc,mg(_o,{brighter(e){return e=e==null?Ki:Math.pow(Ki,e),new ct(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?co:Math.pow(co,e),new ct(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ct(or(this.r),or(this.g),or(this.b),Gi(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tf,formatHex:Tf,formatHex8:jC,formatRgb:Pf,toString:Pf}));function Tf(){return`#${tr(this.r)}${tr(this.g)}${tr(this.b)}`}function jC(){return`#${tr(this.r)}${tr(this.g)}${tr(this.b)}${tr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Pf(){const e=Gi(this.opacity);return`${e===1?"rgb(":"rgba("}${or(this.r)}, ${or(this.g)}, ${or(this.b)}${e===1?")":`, ${e})`}`}function Gi(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function or(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function tr(e){return e=or(e),(e<16?"0":"")+e.toString(16)}function Lf(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new zt(e,t,n,r)}function gg(e){if(e instanceof zt)return new zt(e.h,e.s,e.l,e.opacity);if(e instanceof _o||(e=fo(e)),!e)return new zt;if(e instanceof zt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),o=Math.max(t,n,r),i=NaN,l=o-s,c=(o+s)/2;return l?(t===o?i=(n-r)/l+(n<r)*6:n===o?i=(r-t)/l+2:i=(t-n)/l+4,l/=c<.5?o+s:2-o-s,i*=60):l=c>0&&c<1?0:i,new zt(i,l,c,e.opacity)}function NC(e,t,n,r){return arguments.length===1?gg(e):new zt(e,t,n,r??1)}function zt(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Au(zt,NC,mg(_o,{brighter(e){return e=e==null?Ki:Math.pow(Ki,e),new zt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?co:Math.pow(co,e),new zt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new ct(al(e>=240?e-240:e+120,s,r),al(e,s,r),al(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new zt(Mf(this.h),Jo(this.s),Jo(this.l),Gi(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gi(this.opacity);return`${e===1?"hsl(":"hsla("}${Mf(this.h)}, ${Jo(this.s)*100}%, ${Jo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Mf(e){return e=(e||0)%360,e<0?e+360:e}function Jo(e){return Math.max(0,Math.min(1,e||0))}function al(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const yg=e=>()=>e;function EC(e,t){return function(n){return e+n*t}}function _C(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function bC(e){return(e=+e)==1?vg:function(t,n){return n-t?_C(t,n,e):yg(isNaN(t)?n:t)}}function vg(e,t){var n=t-e;return n?EC(e,n):yg(isNaN(e)?t:e)}const $f=function e(t){var n=bC(t);function r(s,o){var i=n((s=gc(s)).r,(o=gc(o)).r),l=n(s.g,o.g),c=n(s.b,o.b),u=vg(s.opacity,o.opacity);return function(d){return s.r=i(d),s.g=l(d),s.b=c(d),s.opacity=u(d),s+""}}return r.gamma=e,r}(1);function bn(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var yc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ll=new RegExp(yc.source,"g");function TC(e){return function(){return e}}function PC(e){return function(t){return e(t)+""}}function LC(e,t){var n=yc.lastIndex=ll.lastIndex=0,r,s,o,i=-1,l=[],c=[];for(e=e+"",t=t+"";(r=yc.exec(e))&&(s=ll.exec(t));)(o=s.index)>n&&(o=t.slice(n,o),l[i]?l[i]+=o:l[++i]=o),(r=r[0])===(s=s[0])?l[i]?l[i]+=s:l[++i]=s:(l[++i]=null,c.push({i,x:bn(r,s)})),n=ll.lastIndex;return n<t.length&&(o=t.slice(n),l[i]?l[i]+=o:l[++i]=o),l.length<2?c[0]?PC(c[0].x):TC(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}var Af=180/Math.PI,vc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xg(e,t,n,r,s,o){var i,l,c;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,c/=l),e*r<t*n&&(e=-e,t=-t,c=-c,i=-i),{translateX:s,translateY:o,rotate:Math.atan2(t,e)*Af,skewX:Math.atan(c)*Af,scaleX:i,scaleY:l}}var Qo;function MC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vc:xg(t.a,t.b,t.c,t.d,t.e,t.f)}function $C(e){return e==null||(Qo||(Qo=document.createElementNS("http://www.w3.org/2000/svg","g")),Qo.setAttribute("transform",e),!(e=Qo.transform.baseVal.consolidate()))?vc:(e=e.matrix,xg(e.a,e.b,e.c,e.d,e.e,e.f))}function wg(e,t,n,r){function s(u){return u.length?u.pop()+" ":""}function o(u,d,f,p,m,y){if(u!==f||d!==p){var x=m.push("translate(",null,t,null,n);y.push({i:x-4,x:bn(u,f)},{i:x-2,x:bn(d,p)})}else(f||p)&&m.push("translate("+f+t+p+n)}function i(u,d,f,p){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),p.push({i:f.push(s(f)+"rotate(",null,r)-2,x:bn(u,d)})):d&&f.push(s(f)+"rotate("+d+r)}function l(u,d,f,p){u!==d?p.push({i:f.push(s(f)+"skewX(",null,r)-2,x:bn(u,d)}):d&&f.push(s(f)+"skewX("+d+r)}function c(u,d,f,p,m,y){if(u!==f||d!==p){var x=m.push(s(m)+"scale(",null,",",null,")");y.push({i:x-4,x:bn(u,f)},{i:x-2,x:bn(d,p)})}else(f!==1||p!==1)&&m.push(s(m)+"scale("+f+","+p+")")}return function(u,d){var f=[],p=[];return u=e(u),d=e(d),o(u.translateX,u.translateY,d.translateX,d.translateY,f,p),i(u.rotate,d.rotate,f,p),l(u.skewX,d.skewX,f,p),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,p),u=d=null,function(m){for(var y=-1,x=p.length,j;++y<x;)f[(j=p[y]).i]=j.x(m);return f.join("")}}}var AC=wg(MC,"px, ","px)","deg)"),DC=wg($C,", ",")",")"),OC=1e-12;function Df(e){return((e=Math.exp(e))+1/e)/2}function RC(e){return((e=Math.exp(e))-1/e)/2}function IC(e){return((e=Math.exp(2*e))-1)/(e+1)}const zC=function e(t,n,r){function s(o,i){var l=o[0],c=o[1],u=o[2],d=i[0],f=i[1],p=i[2],m=d-l,y=f-c,x=m*m+y*y,j,h;if(x<OC)h=Math.log(p/u)/t,j=function(T){return[l+T*m,c+T*y,u*Math.exp(t*T*h)]};else{var g=Math.sqrt(x),w=(p*p-u*u+r*x)/(2*u*n*g),k=(p*p-u*u-r*x)/(2*p*n*g),C=Math.log(Math.sqrt(w*w+1)-w),N=Math.log(Math.sqrt(k*k+1)-k);h=(N-C)/t,j=function(T){var P=T*h,$=Df(C),M=u/(n*g)*($*IC(t*P+C)-RC(C));return[l+M*m,c+M*y,u*$/Df(t*P+C)]}}return j.duration=h*1e3*t/Math.SQRT2,j}return s.rho=function(o){var i=Math.max(.001,+o),l=i*i,c=l*l;return e(i,l,c)},s}(Math.SQRT2,2,4);var ns=0,Ps=0,Ss=0,Sg=1e3,Xi,Ls,Ji=0,fr=0,ka=0,ho=typeof performance=="object"&&performance.now?performance:Date,kg=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Du(){return fr||(kg(FC),fr=ho.now()+ka)}function FC(){fr=0}function Qi(){this._call=this._time=this._next=null}Qi.prototype=Cg.prototype={constructor:Qi,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Du():+n)+(t==null?0:+t),!this._next&&Ls!==this&&(Ls?Ls._next=this:Xi=this,Ls=this),this._call=e,this._time=n,xc()},stop:function(){this._call&&(this._call=null,this._time=1/0,xc())}};function Cg(e,t,n){var r=new Qi;return r.restart(e,t,n),r}function BC(){Du(),++ns;for(var e=Xi,t;e;)(t=fr-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ns}function Of(){fr=(Ji=ho.now())+ka,ns=Ps=0;try{BC()}finally{ns=0,UC(),fr=0}}function HC(){var e=ho.now(),t=e-Ji;t>Sg&&(ka-=t,Ji=e)}function UC(){for(var e,t=Xi,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Xi=n);Ls=e,xc(r)}function xc(e){if(!ns){Ps&&(Ps=clearTimeout(Ps));var t=e-fr;t>24?(e<1/0&&(Ps=setTimeout(Of,e-ho.now()-ka)),Ss&&(Ss=clearInterval(Ss))):(Ss||(Ji=ho.now(),Ss=setInterval(HC,Sg)),ns=1,kg(Of))}}function Rf(e,t,n){var r=new Qi;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var VC=wa("start","end","cancel","interrupt"),WC=[],jg=0,If=1,wc=2,vi=3,zf=4,Sc=5,xi=6;function Ca(e,t,n,r,s,o){var i=e.__transition;if(!i)e.__transition={};else if(n in i)return;YC(e,n,{name:t,index:r,group:s,on:VC,tween:WC,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:jg})}function Ou(e,t){var n=Ut(e,t);if(n.state>jg)throw new Error("too late; already scheduled");return n}function rn(e,t){var n=Ut(e,t);if(n.state>vi)throw new Error("too late; already running");return n}function Ut(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function YC(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=Cg(o,0,n.time);function o(u){n.state=If,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var d,f,p,m;if(n.state!==If)return c();for(d in r)if(m=r[d],m.name===n.name){if(m.state===vi)return Rf(i);m.state===zf?(m.state=xi,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[d]):+d<t&&(m.state=xi,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[d])}if(Rf(function(){n.state===vi&&(n.state=zf,n.timer.restart(l,n.delay,n.time),l(u))}),n.state=wc,n.on.call("start",e,e.__data__,n.index,n.group),n.state===wc){for(n.state=vi,s=new Array(p=n.tween.length),d=0,f=-1;d<p;++d)(m=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(s[++f]=m);s.length=f+1}}function l(u){for(var d=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Sc,1),f=-1,p=s.length;++f<p;)s[f].call(e,d);n.state===Sc&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=xi,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function wi(e,t){var n=e.__transition,r,s,o=!0,i;if(n){t=t==null?null:t+"";for(i in n){if((r=n[i]).name!==t){o=!1;continue}s=r.state>wc&&r.state<Sc,r.state=xi,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[i]}o&&delete e.__transition}}function KC(e){return this.each(function(){wi(this,e)})}function GC(e,t){var n,r;return function(){var s=rn(this,e),o=s.tween;if(o!==n){r=n=o;for(var i=0,l=r.length;i<l;++i)if(r[i].name===t){r=r.slice(),r.splice(i,1);break}}s.tween=r}}function XC(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var o=rn(this,e),i=o.tween;if(i!==r){s=(r=i).slice();for(var l={name:t,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===t){s[c]=l;break}c===u&&s.push(l)}o.tween=s}}function JC(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Ut(this.node(),n).tween,s=0,o=r.length,i;s<o;++s)if((i=r[s]).name===e)return i.value;return null}return this.each((t==null?GC:XC)(n,e,t))}function Ru(e,t,n){var r=e._id;return e.each(function(){var s=rn(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return Ut(s,r).value[t]}}function Ng(e,t){var n;return(typeof t=="number"?bn:t instanceof fo?$f:(n=fo(t))?(t=n,$f):LC)(e,t)}function QC(e){return function(){this.removeAttribute(e)}}function ZC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function qC(e,t,n){var r,s=n+"",o;return function(){var i=this.getAttribute(e);return i===s?null:i===r?o:o=t(r=i,n)}}function ej(e,t,n){var r,s=n+"",o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===s?null:i===r?o:o=t(r=i,n)}}function tj(e,t,n){var r,s,o;return function(){var i,l=n(this),c;return l==null?void this.removeAttribute(e):(i=this.getAttribute(e),c=l+"",i===c?null:i===r&&c===s?o:(s=c,o=t(r=i,l)))}}function nj(e,t,n){var r,s,o;return function(){var i,l=n(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),c=l+"",i===c?null:i===r&&c===s?o:(s=c,o=t(r=i,l)))}}function rj(e,t){var n=Sa(e),r=n==="transform"?DC:Ng;return this.attrTween(e,typeof t=="function"?(n.local?nj:tj)(n,r,Ru(this,"attr."+e,t)):t==null?(n.local?ZC:QC)(n):(n.local?ej:qC)(n,r,t))}function sj(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function oj(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ij(e,t){var n,r;function s(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&oj(e,o)),n}return s._value=t,s}function aj(e,t){var n,r;function s(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&sj(e,o)),n}return s._value=t,s}function lj(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Sa(e);return this.tween(n,(r.local?ij:aj)(r,t))}function cj(e,t){return function(){Ou(this,e).delay=+t.apply(this,arguments)}}function uj(e,t){return t=+t,function(){Ou(this,e).delay=t}}function dj(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?cj:uj)(t,e)):Ut(this.node(),t).delay}function fj(e,t){return function(){rn(this,e).duration=+t.apply(this,arguments)}}function hj(e,t){return t=+t,function(){rn(this,e).duration=t}}function pj(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fj:hj)(t,e)):Ut(this.node(),t).duration}function mj(e,t){if(typeof t!="function")throw new Error;return function(){rn(this,e).ease=t}}function gj(e){var t=this._id;return arguments.length?this.each(mj(t,e)):Ut(this.node(),t).ease}function yj(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;rn(this,e).ease=n}}function vj(e){if(typeof e!="function")throw new Error;return this.each(yj(this._id,e))}function xj(e){typeof e!="function"&&(e=rg(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var o=t[s],i=o.length,l=r[s]=[],c,u=0;u<i;++u)(c=o[u])&&e.call(c,c.__data__,u,o)&&l.push(c);return new wn(r,this._parents,this._name,this._id)}function wj(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,o=Math.min(r,s),i=new Array(r),l=0;l<o;++l)for(var c=t[l],u=n[l],d=c.length,f=i[l]=new Array(d),p,m=0;m<d;++m)(p=c[m]||u[m])&&(f[m]=p);for(;l<r;++l)i[l]=t[l];return new wn(i,this._parents,this._name,this._id)}function Sj(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function kj(e,t,n){var r,s,o=Sj(t)?Ou:rn;return function(){var i=o(this,e),l=i.on;l!==r&&(s=(r=l).copy()).on(t,n),i.on=s}}function Cj(e,t){var n=this._id;return arguments.length<2?Ut(this.node(),n).on.on(e):this.each(kj(n,e,t))}function jj(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Nj(){return this.on("end.remove",jj(this._id))}function Ej(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Mu(e));for(var r=this._groups,s=r.length,o=new Array(s),i=0;i<s;++i)for(var l=r[i],c=l.length,u=o[i]=new Array(c),d,f,p=0;p<c;++p)(d=l[p])&&(f=e.call(d,d.__data__,p,l))&&("__data__"in d&&(f.__data__=d.__data__),u[p]=f,Ca(u[p],t,n,p,u,Ut(d,n)));return new wn(o,this._parents,t,n)}function _j(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ng(e));for(var r=this._groups,s=r.length,o=[],i=[],l=0;l<s;++l)for(var c=r[l],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var p=e.call(d,d.__data__,f,c),m,y=Ut(d,n),x=0,j=p.length;x<j;++x)(m=p[x])&&Ca(m,t,n,x,p,y);o.push(p),i.push(d)}return new wn(o,i,t,n)}var bj=Eo.prototype.constructor;function Tj(){return new bj(this._groups,this._parents)}function Pj(e,t){var n,r,s;return function(){var o=ts(this,e),i=(this.style.removeProperty(e),ts(this,e));return o===i?null:o===n&&i===r?s:s=t(n=o,r=i)}}function Eg(e){return function(){this.style.removeProperty(e)}}function Lj(e,t,n){var r,s=n+"",o;return function(){var i=ts(this,e);return i===s?null:i===r?o:o=t(r=i,n)}}function Mj(e,t,n){var r,s,o;return function(){var i=ts(this,e),l=n(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),ts(this,e))),i===c?null:i===r&&c===s?o:(s=c,o=t(r=i,l))}}function $j(e,t){var n,r,s,o="style."+t,i="end."+o,l;return function(){var c=rn(this,e),u=c.on,d=c.value[o]==null?l||(l=Eg(t)):void 0;(u!==n||s!==d)&&(r=(n=u).copy()).on(i,s=d),c.on=r}}function Aj(e,t,n){var r=(e+="")=="transform"?AC:Ng;return t==null?this.styleTween(e,Pj(e,r)).on("end.style."+e,Eg(e)):typeof t=="function"?this.styleTween(e,Mj(e,r,Ru(this,"style."+e,t))).each($j(this._id,e)):this.styleTween(e,Lj(e,r,t),n).on("end.style."+e,null)}function Dj(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Oj(e,t,n){var r,s;function o(){var i=t.apply(this,arguments);return i!==s&&(r=(s=i)&&Dj(e,i,n)),r}return o._value=t,o}function Rj(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Oj(e,t,n??""))}function Ij(e){return function(){this.textContent=e}}function zj(e){return function(){var t=e(this);this.textContent=t??""}}function Fj(e){return this.tween("text",typeof e=="function"?zj(Ru(this,"text",e)):Ij(e==null?"":e+""))}function Bj(e){return function(t){this.textContent=e.call(this,t)}}function Hj(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Bj(s)),t}return r._value=e,r}function Uj(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Hj(e))}function Vj(){for(var e=this._name,t=this._id,n=_g(),r=this._groups,s=r.length,o=0;o<s;++o)for(var i=r[o],l=i.length,c,u=0;u<l;++u)if(c=i[u]){var d=Ut(c,t);Ca(c,e,n,u,i,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new wn(r,this._parents,e,n)}function Wj(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(o,i){var l={value:i},c={value:function(){--s===0&&o()}};n.each(function(){var u=rn(this,r),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),s===0&&o()})}var Yj=0;function wn(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function _g(){return++Yj}var sn=Eo.prototype;wn.prototype={constructor:wn,select:Ej,selectAll:_j,selectChild:sn.selectChild,selectChildren:sn.selectChildren,filter:xj,merge:wj,selection:Tj,transition:Vj,call:sn.call,nodes:sn.nodes,node:sn.node,size:sn.size,empty:sn.empty,each:sn.each,on:Cj,attr:rj,attrTween:lj,style:Aj,styleTween:Rj,text:Fj,textTween:Uj,remove:Nj,tween:JC,delay:dj,duration:pj,ease:gj,easeVarying:vj,end:Wj,[Symbol.iterator]:sn[Symbol.iterator]};function Kj(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Gj={time:null,delay:0,duration:250,ease:Kj};function Xj(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Jj(e){var t,n;e instanceof wn?(t=e._id,e=e._name):(t=_g(),(n=Gj).time=Du(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,o=0;o<s;++o)for(var i=r[o],l=i.length,c,u=0;u<l;++u)(c=i[u])&&Ca(c,e,t,u,i,n||Xj(c,t));return new wn(r,this._parents,e,t)}Eo.prototype.interrupt=KC;Eo.prototype.transition=Jj;const Zo=e=>()=>e;function Qj(e,{sourceEvent:t,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function dn(e,t,n){this.k=e,this.x=t,this.y=n}dn.prototype={constructor:dn,scale:function(e){return e===1?this:new dn(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new dn(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var pn=new dn(1,0,0);dn.prototype;function cl(e){e.stopImmediatePropagation()}function ks(e){e.preventDefault(),e.stopImmediatePropagation()}function Zj(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function qj(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Ff(){return this.__zoom||pn}function eN(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function tN(){return navigator.maxTouchPoints||"ontouchstart"in this}function nN(e,t,n){var r=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],o=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}function bg(){var e=Zj,t=qj,n=nN,r=eN,s=tN,o=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],l=250,c=zC,u=wa("start","zoom","end"),d,f,p,m=500,y=150,x=0,j=10;function h(E){E.property("__zoom",Ff).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",M).filter(s).on("touchstart.zoom",B).on("touchmove.zoom",W).on("touchend.zoom touchcancel.zoom",V).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(E,O,L,F){var A=E.selection?E.selection():E;A.property("__zoom",Ff),E!==A?C(E,O,L,F):A.interrupt().each(function(){N(this,arguments).event(F).start().zoom(null,typeof O=="function"?O.apply(this,arguments):O).end()})},h.scaleBy=function(E,O,L,F){h.scaleTo(E,function(){var A=this.__zoom.k,b=typeof O=="function"?O.apply(this,arguments):O;return A*b},L,F)},h.scaleTo=function(E,O,L,F){h.transform(E,function(){var A=t.apply(this,arguments),b=this.__zoom,D=L==null?k(A):typeof L=="function"?L.apply(this,arguments):L,z=b.invert(D),H=typeof O=="function"?O.apply(this,arguments):O;return n(w(g(b,H),D,z),A,i)},L,F)},h.translateBy=function(E,O,L,F){h.transform(E,function(){return n(this.__zoom.translate(typeof O=="function"?O.apply(this,arguments):O,typeof L=="function"?L.apply(this,arguments):L),t.apply(this,arguments),i)},null,F)},h.translateTo=function(E,O,L,F,A){h.transform(E,function(){var b=t.apply(this,arguments),D=this.__zoom,z=F==null?k(b):typeof F=="function"?F.apply(this,arguments):F;return n(pn.translate(z[0],z[1]).scale(D.k).translate(typeof O=="function"?-O.apply(this,arguments):-O,typeof L=="function"?-L.apply(this,arguments):-L),b,i)},F,A)};function g(E,O){return O=Math.max(o[0],Math.min(o[1],O)),O===E.k?E:new dn(O,E.x,E.y)}function w(E,O,L){var F=O[0]-L[0]*E.k,A=O[1]-L[1]*E.k;return F===E.x&&A===E.y?E:new dn(E.k,F,A)}function k(E){return[(+E[0][0]+ +E[1][0])/2,(+E[0][1]+ +E[1][1])/2]}function C(E,O,L,F){E.on("start.zoom",function(){N(this,arguments).event(F).start()}).on("interrupt.zoom end.zoom",function(){N(this,arguments).event(F).end()}).tween("zoom",function(){var A=this,b=arguments,D=N(A,b).event(F),z=t.apply(A,b),H=L==null?k(z):typeof L=="function"?L.apply(A,b):L,X=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),G=A.__zoom,q=typeof O=="function"?O.apply(A,b):O,te=c(G.invert(H).concat(X/G.k),q.invert(H).concat(X/q.k));return function(re){if(re===1)re=q;else{var ue=te(re),se=X/ue[2];re=new dn(se,H[0]-ue[0]*se,H[1]-ue[1]*se)}D.zoom(null,re)}})}function N(E,O,L){return!L&&E.__zooming||new T(E,O)}function T(E,O){this.that=E,this.args=O,this.active=0,this.sourceEvent=null,this.extent=t.apply(E,O),this.taps=0}T.prototype={event:function(E){return E&&(this.sourceEvent=E),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(E,O){return this.mouse&&E!=="mouse"&&(this.mouse[1]=O.invert(this.mouse[0])),this.touch0&&E!=="touch"&&(this.touch0[1]=O.invert(this.touch0[0])),this.touch1&&E!=="touch"&&(this.touch1[1]=O.invert(this.touch1[0])),this.that.__zoom=O,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(E){var O=_t(this.that).datum();u.call(E,this.that,new Qj(E,{sourceEvent:this.sourceEvent,target:h,type:E,transform:this.that.__zoom,dispatch:u}),O)}};function P(E,...O){if(!e.apply(this,arguments))return;var L=N(this,O).event(E),F=this.__zoom,A=Math.max(o[0],Math.min(o[1],F.k*Math.pow(2,r.apply(this,arguments)))),b=Rt(E);if(L.wheel)(L.mouse[0][0]!==b[0]||L.mouse[0][1]!==b[1])&&(L.mouse[1]=F.invert(L.mouse[0]=b)),clearTimeout(L.wheel);else{if(F.k===A)return;L.mouse=[b,F.invert(b)],wi(this),L.start()}ks(E),L.wheel=setTimeout(D,y),L.zoom("mouse",n(w(g(F,A),L.mouse[0],L.mouse[1]),L.extent,i));function D(){L.wheel=null,L.end()}}function $(E,...O){if(p||!e.apply(this,arguments))return;var L=E.currentTarget,F=N(this,O,!0).event(E),A=_t(E.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",X,!0),b=Rt(E,L),D=E.clientX,z=E.clientY;hg(E.view),cl(E),F.mouse=[b,this.__zoom.invert(b)],wi(this),F.start();function H(G){if(ks(G),!F.moved){var q=G.clientX-D,te=G.clientY-z;F.moved=q*q+te*te>x}F.event(G).zoom("mouse",n(w(F.that.__zoom,F.mouse[0]=Rt(G,L),F.mouse[1]),F.extent,i))}function X(G){A.on("mousemove.zoom mouseup.zoom",null),pg(G.view,F.moved),ks(G),F.event(G).end()}}function M(E,...O){if(e.apply(this,arguments)){var L=this.__zoom,F=Rt(E.changedTouches?E.changedTouches[0]:E,this),A=L.invert(F),b=L.k*(E.shiftKey?.5:2),D=n(w(g(L,b),F,A),t.apply(this,O),i);ks(E),l>0?_t(this).transition().duration(l).call(C,D,F,E):_t(this).call(h.transform,D,F,E)}}function B(E,...O){if(e.apply(this,arguments)){var L=E.touches,F=L.length,A=N(this,O,E.changedTouches.length===F).event(E),b,D,z,H;for(cl(E),D=0;D<F;++D)z=L[D],H=Rt(z,this),H=[H,this.__zoom.invert(H),z.identifier],A.touch0?!A.touch1&&A.touch0[2]!==H[2]&&(A.touch1=H,A.taps=0):(A.touch0=H,b=!0,A.taps=1+!!d);d&&(d=clearTimeout(d)),b&&(A.taps<2&&(f=H[0],d=setTimeout(function(){d=null},m)),wi(this),A.start())}}function W(E,...O){if(this.__zooming){var L=N(this,O).event(E),F=E.changedTouches,A=F.length,b,D,z,H;for(ks(E),b=0;b<A;++b)D=F[b],z=Rt(D,this),L.touch0&&L.touch0[2]===D.identifier?L.touch0[0]=z:L.touch1&&L.touch1[2]===D.identifier&&(L.touch1[0]=z);if(D=L.that.__zoom,L.touch1){var X=L.touch0[0],G=L.touch0[1],q=L.touch1[0],te=L.touch1[1],re=(re=q[0]-X[0])*re+(re=q[1]-X[1])*re,ue=(ue=te[0]-G[0])*ue+(ue=te[1]-G[1])*ue;D=g(D,Math.sqrt(re/ue)),z=[(X[0]+q[0])/2,(X[1]+q[1])/2],H=[(G[0]+te[0])/2,(G[1]+te[1])/2]}else if(L.touch0)z=L.touch0[0],H=L.touch0[1];else return;L.zoom("touch",n(w(D,z,H),L.extent,i))}}function V(E,...O){if(this.__zooming){var L=N(this,O).event(E),F=E.changedTouches,A=F.length,b,D;for(cl(E),p&&clearTimeout(p),p=setTimeout(function(){p=null},m),b=0;b<A;++b)D=F[b],L.touch0&&L.touch0[2]===D.identifier?delete L.touch0:L.touch1&&L.touch1[2]===D.identifier&&delete L.touch1;if(L.touch1&&!L.touch0&&(L.touch0=L.touch1,delete L.touch1),L.touch0)L.touch0[1]=this.__zoom.invert(L.touch0[0]);else if(L.end(),L.taps===2&&(D=Rt(D,this),Math.hypot(f[0]-D[0],f[1]-D[1])<j)){var z=_t(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return h.wheelDelta=function(E){return arguments.length?(r=typeof E=="function"?E:Zo(+E),h):r},h.filter=function(E){return arguments.length?(e=typeof E=="function"?E:Zo(!!E),h):e},h.touchable=function(E){return arguments.length?(s=typeof E=="function"?E:Zo(!!E),h):s},h.extent=function(E){return arguments.length?(t=typeof E=="function"?E:Zo([[+E[0][0],+E[0][1]],[+E[1][0],+E[1][1]]]),h):t},h.scaleExtent=function(E){return arguments.length?(o[0]=+E[0],o[1]=+E[1],h):[o[0],o[1]]},h.translateExtent=function(E){return arguments.length?(i[0][0]=+E[0][0],i[1][0]=+E[1][0],i[0][1]=+E[0][1],i[1][1]=+E[1][1],h):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},h.constrain=function(E){return arguments.length?(n=E,h):n},h.duration=function(E){return arguments.length?(l=+E,h):l},h.interpolate=function(E){return arguments.length?(c=E,h):c},h.on=function(){var E=u.on.apply(u,arguments);return E===u?h:E},h.clickDistance=function(E){return arguments.length?(x=(E=+E)*E,h):Math.sqrt(x)},h.tapDistance=function(E){return arguments.length?(j=+E,h):j},h}const ja=v.createContext(null),rN=ja.Provider,Sn={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Tg=Sn.error001();function Ne(e,t){const n=v.useContext(ja);if(n===null)throw new Error(Tg);return eg(n,e,t)}const He=()=>{const e=v.useContext(ja);if(e===null)throw new Error(Tg);return v.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},sN=e=>e.userSelectionActive?"none":"all";function Iu({position:e,children:t,className:n,style:r,...s}){const o=Ne(sN),i=`${e}`.split("-");return I.createElement("div",{className:et(["react-flow__panel",n,...i]),style:{...r,pointerEvents:o},...s},t)}function oN({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:I.createElement(Iu,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},I.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const iN=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:s=!0,labelBgStyle:o={},labelBgPadding:i=[2,4],labelBgBorderRadius:l=2,children:c,className:u,...d})=>{const f=v.useRef(null),[p,m]=v.useState({x:0,y:0,width:0,height:0}),y=et(["react-flow__edge-textwrapper",u]);return v.useEffect(()=>{if(f.current){const x=f.current.getBBox();m({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),typeof n>"u"||!n?null:I.createElement("g",{transform:`translate(${e-p.width/2} ${t-p.height/2})`,className:y,visibility:p.width?"visible":"hidden",...d},s&&I.createElement("rect",{width:p.width+2*i[0],x:-i[0],y:-i[1],height:p.height+2*i[1],className:"react-flow__edge-textbg",style:o,rx:l,ry:l}),I.createElement("text",{className:"react-flow__edge-text",y:p.height/2,dy:"0.3em",ref:f,style:r},n),c)};var aN=v.memo(iN);const zu=e=>({width:e.offsetWidth,height:e.offsetHeight}),rs=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Fu=(e={x:0,y:0},t)=>({x:rs(e.x,t[0][0],t[1][0]),y:rs(e.y,t[0][1],t[1][1])}),Bf=(e,t,n)=>e<t?rs(Math.abs(e-t),1,50)/50:e>n?-rs(Math.abs(e-n),1,50)/50:0,Pg=(e,t)=>{const n=Bf(e.x,35,t.width-35)*20,r=Bf(e.y,35,t.height-35)*20;return[n,r]},Lg=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Mg=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),po=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),$g=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Hf=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),lN=(e,t)=>$g(Mg(po(e),po(t))),kc=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},cN=e=>Tt(e.width)&&Tt(e.height)&&Tt(e.x)&&Tt(e.y),Tt=e=>!isNaN(e)&&isFinite(e),Ae=Symbol.for("internals"),Ag=["Enter"," ","Escape"],uN=(e,t)=>{},dN=e=>"nativeEvent"in e;function Cc(e){var s,o;const t=dN(e)?e.nativeEvent:e,n=((o=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:o[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const Dg=e=>"clientX"in e,Un=(e,t)=>{var o,i;const n=Dg(e),r=n?e.clientX:(o=e.touches)==null?void 0:o[0].clientX,s=n?e.clientY:(i=e.touches)==null?void 0:i[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},Zi=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},bo=({id:e,path:t,labelX:n,labelY:r,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:m=20})=>I.createElement(I.Fragment,null,I.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:p}),m&&I.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),s&&Tt(n)&&Tt(r)?I.createElement(aN,{x:n,y:r,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u}):null);bo.displayName="BaseEdge";function Cs(e,t,n){return n===void 0?n:r=>{const s=t().edges.find(o=>o.id===e);s&&n(r,{...s})}}function Og({sourceX:e,sourceY:t,targetX:n,targetY:r}){const s=Math.abs(n-e)/2,o=n<e?n+s:n-s,i=Math.abs(r-t)/2,l=r<t?r+i:r-i;return[o,l,s,i]}function Rg({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:s,sourceControlY:o,targetControlX:i,targetControlY:l}){const c=e*.125+s*.375+i*.375+n*.125,u=t*.125+o*.375+l*.375+r*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var hr;(function(e){e.Strict="strict",e.Loose="loose"})(hr||(hr={}));var nr;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(nr||(nr={}));var mo;(function(e){e.Partial="partial",e.Full="full"})(mo||(mo={}));var Mn;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Mn||(Mn={}));var qi;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(qi||(qi={}));var ne;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(ne||(ne={}));function Uf({pos:e,x1:t,y1:n,x2:r,y2:s}){return e===ne.Left||e===ne.Right?[.5*(t+r),n]:[t,.5*(n+s)]}function Ig({sourceX:e,sourceY:t,sourcePosition:n=ne.Bottom,targetX:r,targetY:s,targetPosition:o=ne.Top}){const[i,l]=Uf({pos:n,x1:e,y1:t,x2:r,y2:s}),[c,u]=Uf({pos:o,x1:r,y1:s,x2:e,y2:t}),[d,f,p,m]=Rg({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:i,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${i},${l} ${c},${u} ${r},${s}`,d,f,p,m]}const Bu=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=ne.Bottom,targetPosition:o=ne.Top,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:y,interactionWidth:x})=>{const[j,h,g]=Ig({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:o});return I.createElement(bo,{path:j,labelX:h,labelY:g,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:y,interactionWidth:x})});Bu.displayName="SimpleBezierEdge";const Vf={[ne.Left]:{x:-1,y:0},[ne.Right]:{x:1,y:0},[ne.Top]:{x:0,y:-1},[ne.Bottom]:{x:0,y:1}},fN=({source:e,sourcePosition:t=ne.Bottom,target:n})=>t===ne.Left||t===ne.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Wf=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function hN({source:e,sourcePosition:t=ne.Bottom,target:n,targetPosition:r=ne.Top,center:s,offset:o}){const i=Vf[t],l=Vf[r],c={x:e.x+i.x*o,y:e.y+i.y*o},u={x:n.x+l.x*o,y:n.y+l.y*o},d=fN({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",p=d[f];let m=[],y,x;const j={x:0,y:0},h={x:0,y:0},[g,w,k,C]=Og({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*l[f]===-1){y=s.x??g,x=s.y??w;const T=[{x:y,y:c.y},{x:y,y:u.y}],P=[{x:c.x,y:x},{x:u.x,y:x}];i[f]===p?m=f==="x"?T:P:m=f==="x"?P:T}else{const T=[{x:c.x,y:u.y}],P=[{x:u.x,y:c.y}];if(f==="x"?m=i.x===p?P:T:m=i.y===p?T:P,t===r){const V=Math.abs(e[f]-n[f]);if(V<=o){const E=Math.min(o-1,o-V);i[f]===p?j[f]=(c[f]>e[f]?-1:1)*E:h[f]=(u[f]>n[f]?-1:1)*E}}if(t!==r){const V=f==="x"?"y":"x",E=i[f]===l[V],O=c[V]>u[V],L=c[V]<u[V];(i[f]===1&&(!E&&O||E&&L)||i[f]!==1&&(!E&&L||E&&O))&&(m=f==="x"?T:P)}const $={x:c.x+j.x,y:c.y+j.y},M={x:u.x+h.x,y:u.y+h.y},B=Math.max(Math.abs($.x-m[0].x),Math.abs(M.x-m[0].x)),W=Math.max(Math.abs($.y-m[0].y),Math.abs(M.y-m[0].y));B>=W?(y=($.x+M.x)/2,x=m[0].y):(y=m[0].x,x=($.y+M.y)/2)}return[[e,{x:c.x+j.x,y:c.y+j.y},...m,{x:u.x+h.x,y:u.y+h.y},n],y,x,k,C]}function pN(e,t,n,r){const s=Math.min(Wf(e,t)/2,Wf(t,n)/2,r),{x:o,y:i}=t;if(e.x===o&&o===n.x||e.y===i&&i===n.y)return`L${o} ${i}`;if(e.y===i){const u=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${o+s*u},${i}Q ${o},${i} ${o},${i+s*d}`}const l=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${o},${i+s*c}Q ${o},${i} ${o+s*l},${i}`}function jc({sourceX:e,sourceY:t,sourcePosition:n=ne.Bottom,targetX:r,targetY:s,targetPosition:o=ne.Top,borderRadius:i=5,centerX:l,centerY:c,offset:u=20}){const[d,f,p,m,y]=hN({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:s},targetPosition:o,center:{x:l,y:c},offset:u});return[d.reduce((j,h,g)=>{let w="";return g>0&&g<d.length-1?w=pN(d[g-1],h,d[g+1],i):w=`${g===0?"M":"L"}${h.x} ${h.y}`,j+=w,j},""),f,p,m,y]}const Na=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=ne.Bottom,targetPosition:p=ne.Top,markerEnd:m,markerStart:y,pathOptions:x,interactionWidth:j})=>{const[h,g,w]=jc({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:p,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return I.createElement(bo,{path:h,labelX:g,labelY:w,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:m,markerStart:y,interactionWidth:j})});Na.displayName="SmoothStepEdge";const Hu=v.memo(e=>{var t;return I.createElement(Na,{...e,pathOptions:v.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Hu.displayName="StepEdge";function mN({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[s,o,i,l]=Og({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,s,o,i,l]}const Uu=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:m})=>{const[y,x,j]=mN({sourceX:e,sourceY:t,targetX:n,targetY:r});return I.createElement(bo,{path:y,labelX:x,labelY:j,label:s,labelStyle:o,labelShowBg:i,labelBgStyle:l,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:p,interactionWidth:m})});Uu.displayName="StraightEdge";function qo(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Yf({pos:e,x1:t,y1:n,x2:r,y2:s,c:o}){switch(e){case ne.Left:return[t-qo(t-r,o),n];case ne.Right:return[t+qo(r-t,o),n];case ne.Top:return[t,n-qo(n-s,o)];case ne.Bottom:return[t,n+qo(s-n,o)]}}function zg({sourceX:e,sourceY:t,sourcePosition:n=ne.Bottom,targetX:r,targetY:s,targetPosition:o=ne.Top,curvature:i=.25}){const[l,c]=Yf({pos:n,x1:e,y1:t,x2:r,y2:s,c:i}),[u,d]=Yf({pos:o,x1:r,y1:s,x2:e,y2:t,c:i}),[f,p,m,y]=Rg({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${l},${c} ${u},${d} ${r},${s}`,f,p,m,y]}const ea=v.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=ne.Bottom,targetPosition:o=ne.Top,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:y,pathOptions:x,interactionWidth:j})=>{const[h,g,w]=zg({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:o,curvature:x==null?void 0:x.curvature});return I.createElement(bo,{path:h,labelX:g,labelY:w,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:p,markerEnd:m,markerStart:y,interactionWidth:j})});ea.displayName="BezierEdge";const Vu=v.createContext(null),gN=Vu.Provider;Vu.Consumer;const yN=()=>v.useContext(Vu),vN=e=>"id"in e&&"source"in e&&"target"in e,xN=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,Nc=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,wN=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Fg=(e,t)=>{if(!e.source||!e.target)return t;let n;return vN(e)?n={...e}:n={...e,id:xN(e)},wN(n,t)?t:t.concat(n)},Ec=({x:e,y:t},[n,r,s],o,[i,l])=>{const c={x:(e-n)/s,y:(t-r)/s};return o?{x:i*Math.round(c.x/i),y:l*Math.round(c.y/l)}:c},Bg=({x:e,y:t},[n,r,s])=>({x:e*s+n,y:t*s+r}),ir=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-r};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:s}},Ea=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,s)=>{const{x:o,y:i}=ir(s,t).positionAbsolute;return Mg(r,po({x:o,y:i,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return $g(n)},Hg=(e,t,[n,r,s]=[0,0,1],o=!1,i=!1,l=[0,0])=>{const c={x:(t.x-n)/s,y:(t.y-r)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(d=>{const{width:f,height:p,selectable:m=!0,hidden:y=!1}=d;if(i&&!m||y)return!1;const{positionAbsolute:x}=ir(d,l),j={x:x.x,y:x.y,width:f||0,height:p||0},h=kc(c,j),g=typeof f>"u"||typeof p>"u"||f===null||p===null,w=o&&h>0,k=(f||0)*(p||0);(g||w||h>=k||d.dragging)&&u.push(d)}),u},Ug=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},Vg=(e,t,n,r,s,o=.1)=>{const i=t/(e.width*(1+o)),l=n/(e.height*(1+o)),c=Math.min(i,l),u=rs(c,r,s),d=e.x+e.width/2,f=e.y+e.height/2,p=t/2-d*u,m=n/2-f*u;return{x:p,y:m,zoom:u}},Qn=(e,t=0)=>e.transition().duration(t);function Kf(e,t,n,r){return(t[n]||[]).reduce((s,o)=>{var i,l;return`${e.id}-${o.id}-${n}`!==r&&s.push({id:o.id||null,type:n,nodeId:e.id,x:(((i=e.positionAbsolute)==null?void 0:i.x)??0)+o.x+o.width/2,y:(((l=e.positionAbsolute)==null?void 0:l.y)??0)+o.y+o.height/2}),s},[])}function SN(e,t,n,r,s,o){const{x:i,y:l}=Un(e),u=t.elementsFromPoint(i,l).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const x=Wu(void 0,u),j=u.getAttribute("data-handleid"),h=o({nodeId:y,id:j,type:x});if(h){const g=s.find(w=>w.nodeId===y&&w.type===x&&w.id===j);return{handle:{id:j,type:x,nodeId:y,x:(g==null?void 0:g.x)||n.x,y:(g==null?void 0:g.y)||n.y},validHandleResult:h}}}}let d=[],f=1/0;if(s.forEach(y=>{const x=Math.sqrt((y.x-n.x)**2+(y.y-n.y)**2);if(x<=r){const j=o(y);x<=f&&(x<f?d=[{handle:y,validHandleResult:j}]:x===f&&d.push({handle:y,validHandleResult:j}),f=x)}}),!d.length)return{handle:null,validHandleResult:Wg()};if(d.length===1)return d[0];const p=d.some(({validHandleResult:y})=>y.isValid),m=d.some(({handle:y})=>y.type==="target");return d.find(({handle:y,validHandleResult:x})=>m?y.type==="target":p?x.isValid:!0)||d[0]}const kN={source:null,target:null,sourceHandle:null,targetHandle:null},Wg=()=>({handleDomNode:null,isValid:!1,connection:kN,endHandle:null});function Yg(e,t,n,r,s,o,i){const l=s==="target",c=i.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...Wg(),handleDomNode:c};if(c){const d=Wu(void 0,c),f=c.getAttribute("data-nodeid"),p=c.getAttribute("data-handleid"),m=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),x={source:l?f:n,sourceHandle:l?p:r,target:l?n:f,targetHandle:l?r:p};u.connection=x,m&&y&&(t===hr.Strict?l&&d==="source"||!l&&d==="target":f!==n||p!==r)&&(u.endHandle={nodeId:f,handleId:p,type:d},u.isValid=o(x))}return u}function CN({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((s,o)=>{if(o[Ae]){const{handleBounds:i}=o[Ae];let l=[],c=[];i&&(l=Kf(o,i,"source",`${t}-${n}-${r}`),c=Kf(o,i,"target",`${t}-${n}-${r}`)),s.push(...l,...c)}return s},[])}function Wu(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ul(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function jN(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Kg({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:s,getState:o,setState:i,isValidConnection:l,edgeUpdaterType:c,onReconnectEnd:u}){const d=Lg(e.target),{connectionMode:f,domNode:p,autoPanOnConnect:m,connectionRadius:y,onConnectStart:x,panBy:j,getNodes:h,cancelConnection:g}=o();let w=0,k;const{x:C,y:N}=Un(e),T=d==null?void 0:d.elementFromPoint(C,N),P=Wu(c,T),$=p==null?void 0:p.getBoundingClientRect();if(!$||!P)return;let M,B=Un(e,$),W=!1,V=null,E=!1,O=null;const L=CN({nodes:h(),nodeId:n,handleId:t,handleType:P}),F=()=>{if(!m)return;const[D,z]=Pg(B,$);j({x:D,y:z}),w=requestAnimationFrame(F)};i({connectionPosition:B,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:P,connectionStartHandle:{nodeId:n,handleId:t,type:P},connectionEndHandle:null}),x==null||x(e,{nodeId:n,handleId:t,handleType:P});function A(D){const{transform:z}=o();B=Un(D,$);const{handle:H,validHandleResult:X}=SN(D,d,Ec(B,z,!1,[1,1]),y,L,G=>Yg(G,f,n,t,s?"target":"source",l,d));if(k=H,W||(F(),W=!0),O=X.handleDomNode,V=X.connection,E=X.isValid,i({connectionPosition:k&&E?Bg({x:k.x,y:k.y},z):B,connectionStatus:jN(!!k,E),connectionEndHandle:X.endHandle}),!k&&!E&&!O)return ul(M);V.source!==V.target&&O&&(ul(M),M=O,O.classList.add("connecting","react-flow__handle-connecting"),O.classList.toggle("valid",E),O.classList.toggle("react-flow__handle-valid",E))}function b(D){var z,H;(k||O)&&V&&E&&(r==null||r(V)),(H=(z=o()).onConnectEnd)==null||H.call(z,D),c&&(u==null||u(D)),ul(M),g(),cancelAnimationFrame(w),W=!1,E=!1,V=null,O=null,d.removeEventListener("mousemove",A),d.removeEventListener("mouseup",b),d.removeEventListener("touchmove",A),d.removeEventListener("touchend",b)}d.addEventListener("mousemove",A),d.addEventListener("mouseup",b),d.addEventListener("touchmove",A),d.addEventListener("touchend",b)}const Gf=()=>!0,NN=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),EN=(e,t,n)=>r=>{const{connectionStartHandle:s,connectionEndHandle:o,connectionClickStartHandle:i}=r;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.handleId)===t&&(o==null?void 0:o.type)===n,clickConnecting:(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n}},Gg=v.forwardRef(({type:e="source",position:t=ne.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:s=!0,isConnectableEnd:o=!0,id:i,onConnect:l,children:c,className:u,onMouseDown:d,onTouchStart:f,...p},m)=>{var $,M;const y=i||null,x=e==="target",j=He(),h=yN(),{connectOnClick:g,noPanClassName:w}=Ne(NN,ht),{connecting:k,clickConnecting:C}=Ne(EN(h,y,e),ht);h||(M=($=j.getState()).onError)==null||M.call($,"010",Sn.error010());const N=B=>{const{defaultEdgeOptions:W,onConnect:V,hasDefaultEdges:E}=j.getState(),O={...W,...B};if(E){const{edges:L,setEdges:F}=j.getState();F(Fg(O,L))}V==null||V(O),l==null||l(O)},T=B=>{if(!h)return;const W=Dg(B);s&&(W&&B.button===0||!W)&&Kg({event:B,handleId:y,nodeId:h,onConnect:N,isTarget:x,getState:j.getState,setState:j.setState,isValidConnection:n||j.getState().isValidConnection||Gf}),W?d==null||d(B):f==null||f(B)},P=B=>{const{onClickConnectStart:W,onClickConnectEnd:V,connectionClickStartHandle:E,connectionMode:O,isValidConnection:L}=j.getState();if(!h||!E&&!s)return;if(!E){W==null||W(B,{nodeId:h,handleId:y,handleType:e}),j.setState({connectionClickStartHandle:{nodeId:h,type:e,handleId:y}});return}const F=Lg(B.target),A=n||L||Gf,{connection:b,isValid:D}=Yg({nodeId:h,id:y,type:e},O,E.nodeId,E.handleId||null,E.type,A,F);D&&N(b),V==null||V(B),j.setState({connectionClickStartHandle:null})};return I.createElement("div",{"data-handleid":y,"data-nodeid":h,"data-handlepos":t,"data-id":`${h}-${y}-${e}`,className:et(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",w,u,{source:!x,target:x,connectable:r,connectablestart:s,connectableend:o,connecting:C,connectionindicator:r&&(s&&!k||o&&k)}]),onMouseDown:T,onTouchStart:T,onClick:g?P:void 0,ref:m,...p},c)});Gg.displayName="Handle";var ss=v.memo(Gg);const Xg=({data:e,isConnectable:t,targetPosition:n=ne.Top,sourcePosition:r=ne.Bottom})=>I.createElement(I.Fragment,null,I.createElement(ss,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,I.createElement(ss,{type:"source",position:r,isConnectable:t}));Xg.displayName="DefaultNode";var _c=v.memo(Xg);const Jg=({data:e,isConnectable:t,sourcePosition:n=ne.Bottom})=>I.createElement(I.Fragment,null,e==null?void 0:e.label,I.createElement(ss,{type:"source",position:n,isConnectable:t}));Jg.displayName="InputNode";var Qg=v.memo(Jg);const Zg=({data:e,isConnectable:t,targetPosition:n=ne.Top})=>I.createElement(I.Fragment,null,I.createElement(ss,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Zg.displayName="OutputNode";var qg=v.memo(Zg);const Yu=()=>null;Yu.displayName="GroupNode";const _N=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),ei=e=>e.id;function bN(e,t){return ht(e.selectedNodes.map(ei),t.selectedNodes.map(ei))&&ht(e.selectedEdges.map(ei),t.selectedEdges.map(ei))}const ey=v.memo(({onSelectionChange:e})=>{const t=He(),{selectedNodes:n,selectedEdges:r}=Ne(_N,bN);return v.useEffect(()=>{const s={nodes:n,edges:r};e==null||e(s),t.getState().onSelectionChange.forEach(o=>o(s))},[n,r,e]),null});ey.displayName="SelectionListener";const TN=e=>!!e.onSelectionChange;function PN({onSelectionChange:e}){const t=Ne(TN);return e||t?I.createElement(ey,{onSelectionChange:e}):null}const LN=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function xr(e,t){v.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function le(e,t,n){v.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const MN=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:s,onConnectStart:o,onConnectEnd:i,onClickConnectStart:l,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:p,edgesUpdatable:m,elevateNodesOnSelect:y,minZoom:x,maxZoom:j,nodeExtent:h,onNodesChange:g,onEdgesChange:w,elementsSelectable:k,connectionMode:C,snapGrid:N,snapToGrid:T,translateExtent:P,connectOnClick:$,defaultEdgeOptions:M,fitView:B,fitViewOptions:W,onNodesDelete:V,onEdgesDelete:E,onNodeDrag:O,onNodeDragStart:L,onNodeDragStop:F,onSelectionDrag:A,onSelectionDragStart:b,onSelectionDragStop:D,noPanClassName:z,nodeOrigin:H,rfId:X,autoPanOnConnect:G,autoPanOnNodeDrag:q,onError:te,connectionRadius:re,isValidConnection:ue,nodeDragThreshold:se})=>{const{setNodes:J,setEdges:ve,setDefaultNodesAndEdges:we,setMinZoom:Me,setMaxZoom:Re,setTranslateExtent:Ee,setNodeExtent:Ue,reset:he}=Ne(LN,ht),ee=He();return v.useEffect(()=>{const Ie=r==null?void 0:r.map(ot=>({...ot,...M}));return we(n,Ie),()=>{he()}},[]),le("defaultEdgeOptions",M,ee.setState),le("connectionMode",C,ee.setState),le("onConnect",s,ee.setState),le("onConnectStart",o,ee.setState),le("onConnectEnd",i,ee.setState),le("onClickConnectStart",l,ee.setState),le("onClickConnectEnd",c,ee.setState),le("nodesDraggable",u,ee.setState),le("nodesConnectable",d,ee.setState),le("nodesFocusable",f,ee.setState),le("edgesFocusable",p,ee.setState),le("edgesUpdatable",m,ee.setState),le("elementsSelectable",k,ee.setState),le("elevateNodesOnSelect",y,ee.setState),le("snapToGrid",T,ee.setState),le("snapGrid",N,ee.setState),le("onNodesChange",g,ee.setState),le("onEdgesChange",w,ee.setState),le("connectOnClick",$,ee.setState),le("fitViewOnInit",B,ee.setState),le("fitViewOnInitOptions",W,ee.setState),le("onNodesDelete",V,ee.setState),le("onEdgesDelete",E,ee.setState),le("onNodeDrag",O,ee.setState),le("onNodeDragStart",L,ee.setState),le("onNodeDragStop",F,ee.setState),le("onSelectionDrag",A,ee.setState),le("onSelectionDragStart",b,ee.setState),le("onSelectionDragStop",D,ee.setState),le("noPanClassName",z,ee.setState),le("nodeOrigin",H,ee.setState),le("rfId",X,ee.setState),le("autoPanOnConnect",G,ee.setState),le("autoPanOnNodeDrag",q,ee.setState),le("onError",te,ee.setState),le("connectionRadius",re,ee.setState),le("isValidConnection",ue,ee.setState),le("nodeDragThreshold",se,ee.setState),xr(e,J),xr(t,ve),xr(x,Me),xr(j,Re),xr(P,Ee),xr(h,Ue),null},Xf={display:"none"},$N={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ty="react-flow__node-desc",ny="react-flow__edge-desc",AN="react-flow__aria-live",DN=e=>e.ariaLiveMessage;function ON({rfId:e}){const t=Ne(DN);return I.createElement("div",{id:`${AN}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:$N},t)}function RN({rfId:e,disableKeyboardA11y:t}){return I.createElement(I.Fragment,null,I.createElement("div",{id:`${ty}-${e}`,style:Xf},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),I.createElement("div",{id:`${ny}-${e}`,style:Xf},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&I.createElement(ON,{rfId:e}))}var go=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=v.useState(!1),s=v.useRef(!1),o=v.useRef(new Set([])),[i,l]=v.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,p)=>f.concat(...p),[]);return[u,d]}return[[],[]]},[e]);return v.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=m=>{if(s.current=m.ctrlKey||m.metaKey||m.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Cc(m))return!1;const x=Qf(m.code,l);o.current.add(m[x]),Jf(i,o.current,!1)&&(m.preventDefault(),r(!0))},f=m=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Cc(m))return!1;const x=Qf(m.code,l);Jf(i,o.current,!0)?(r(!1),o.current.clear()):o.current.delete(m[x]),m.key==="Meta"&&o.current.clear(),s.current=!1},p=()=>{o.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",p),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",p)}}},[e,r]),n};function Jf(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(s=>t.has(s)))}function Qf(e,t){return t.includes(e)?"code":"key"}function ry(e,t,n,r){var l,c;const s=e.parentNode||e.parentId;if(!s)return n;const o=t.get(s),i=ir(o,r);return ry(o,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(((l=o[Ae])==null?void 0:l.z)??0)>(n.z??0)?((c=o[Ae])==null?void 0:c.z)??0:n.z??0},r)}function sy(e,t,n){e.forEach(r=>{var o;const s=r.parentNode||r.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n!=null&&n[r.id]){const{x:i,y:l,z:c}=ry(r,e,{...r.position,z:((o=r[Ae])==null?void 0:o.z)??0},t);r.positionAbsolute={x:i,y:l},r[Ae].z=c,n!=null&&n[r.id]&&(r[Ae].isParent=!0)}})}function dl(e,t,n,r){const s=new Map,o={},i=r?1e3:0;return e.forEach(l=>{var m;const c=(Tt(l.zIndex)?l.zIndex:0)+(l.selected?i:0),u=t.get(l.id),d={...l,positionAbsolute:{x:l.position.x,y:l.position.y}},f=l.parentNode||l.parentId;f&&(o[f]=!0);const p=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==l.type;Object.defineProperty(d,Ae,{enumerable:!1,value:{handleBounds:p||(m=u==null?void 0:u[Ae])==null?void 0:m.handleBounds,z:c}}),s.set(l.id,d)}),sy(s,n,o),s}function oy(e,t={}){const{getNodes:n,width:r,height:s,minZoom:o,maxZoom:i,d3Zoom:l,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),p=t.initial&&!u&&d;if(l&&c&&(p||!t.initial)){const y=n().filter(j=>{var g;const h=t.includeHiddenNodes?j.width&&j.height:!j.hidden;return(g=t.nodes)!=null&&g.length?h&&t.nodes.some(w=>w.id===j.id):h}),x=y.every(j=>j.width&&j.height);if(y.length>0&&x){const j=Ea(y,f),{x:h,y:g,zoom:w}=Vg(j,r,s,t.minZoom??o,t.maxZoom??i,t.padding??.1),k=pn.translate(h,g).scale(w);return typeof t.duration=="number"&&t.duration>0?l.transform(Qn(c,t.duration),k):l.transform(c,k),!0}}return!1}function IN(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[Ae]:r[Ae],selected:n.selected})}),new Map(t)}function zN(e,t){return t.map(n=>{const r=e.find(s=>s.id===n.id);return r&&(n.selected=r.selected),n})}function ti({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:s,edges:o,onNodesChange:i,onEdgesChange:l,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&r({nodeInternals:IN(e,s)}),i==null||i(e)),t!=null&&t.length&&(u&&r({edges:zN(t,o)}),l==null||l(t))}const wr=()=>{},FN={zoomIn:wr,zoomOut:wr,zoomTo:wr,getZoom:()=>1,setViewport:wr,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:wr,fitBounds:wr,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},BN=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),HN=()=>{const e=He(),{d3Zoom:t,d3Selection:n}=Ne(BN,ht);return v.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(Qn(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(Qn(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,o)=>t.scaleTo(Qn(n,o==null?void 0:o.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,o)=>{const[i,l,c]=e.getState().transform,u=pn.translate(s.x??i,s.y??l).scale(s.zoom??c);t.transform(Qn(n,o==null?void 0:o.duration),u)},getViewport:()=>{const[s,o,i]=e.getState().transform;return{x:s,y:o,zoom:i}},fitView:s=>oy(e.getState,s),setCenter:(s,o,i)=>{const{width:l,height:c,maxZoom:u}=e.getState(),d=typeof(i==null?void 0:i.zoom)<"u"?i.zoom:u,f=l/2-s*d,p=c/2-o*d,m=pn.translate(f,p).scale(d);t.transform(Qn(n,i==null?void 0:i.duration),m)},fitBounds:(s,o)=>{const{width:i,height:l,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:p}=Vg(s,i,l,c,u,(o==null?void 0:o.padding)??.1),m=pn.translate(d,f).scale(p);t.transform(Qn(n,o==null?void 0:o.duration),m)},project:s=>{const{transform:o,snapToGrid:i,snapGrid:l}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ec(s,o,i,l)},screenToFlowPosition:s=>{const{transform:o,snapToGrid:i,snapGrid:l,domNode:c}=e.getState();if(!c)return s;const{x:u,y:d}=c.getBoundingClientRect(),f={x:s.x-u,y:s.y-d};return Ec(f,o,i,l)},flowToScreenPosition:s=>{const{transform:o,domNode:i}=e.getState();if(!i)return s;const{x:l,y:c}=i.getBoundingClientRect(),u=Bg(s,o);return{x:u.x+l,y:u.y+c}},viewportInitialized:!0}:FN,[t,n])};function Ku(){const e=HN(),t=He(),n=v.useCallback(()=>t.getState().getNodes().map(x=>({...x})),[]),r=v.useCallback(x=>t.getState().nodeInternals.get(x),[]),s=v.useCallback(()=>{const{edges:x=[]}=t.getState();return x.map(j=>({...j}))},[]),o=v.useCallback(x=>{const{edges:j=[]}=t.getState();return j.find(h=>h.id===x)},[]),i=v.useCallback(x=>{const{getNodes:j,setNodes:h,hasDefaultNodes:g,onNodesChange:w}=t.getState(),k=j(),C=typeof x=="function"?x(k):x;if(g)h(C);else if(w){const N=C.length===0?k.map(T=>({type:"remove",id:T.id})):C.map(T=>({item:T,type:"reset"}));w(N)}},[]),l=v.useCallback(x=>{const{edges:j=[],setEdges:h,hasDefaultEdges:g,onEdgesChange:w}=t.getState(),k=typeof x=="function"?x(j):x;if(g)h(k);else if(w){const C=k.length===0?j.map(N=>({type:"remove",id:N.id})):k.map(N=>({item:N,type:"reset"}));w(C)}},[]),c=v.useCallback(x=>{const j=Array.isArray(x)?x:[x],{getNodes:h,setNodes:g,hasDefaultNodes:w,onNodesChange:k}=t.getState();if(w){const N=[...h(),...j];g(N)}else if(k){const C=j.map(N=>({item:N,type:"add"}));k(C)}},[]),u=v.useCallback(x=>{const j=Array.isArray(x)?x:[x],{edges:h=[],setEdges:g,hasDefaultEdges:w,onEdgesChange:k}=t.getState();if(w)g([...h,...j]);else if(k){const C=j.map(N=>({item:N,type:"add"}));k(C)}},[]),d=v.useCallback(()=>{const{getNodes:x,edges:j=[],transform:h}=t.getState(),[g,w,k]=h;return{nodes:x().map(C=>({...C})),edges:j.map(C=>({...C})),viewport:{x:g,y:w,zoom:k}}},[]),f=v.useCallback(({nodes:x,edges:j})=>{const{nodeInternals:h,getNodes:g,edges:w,hasDefaultNodes:k,hasDefaultEdges:C,onNodesDelete:N,onEdgesDelete:T,onNodesChange:P,onEdgesChange:$}=t.getState(),M=(x||[]).map(O=>O.id),B=(j||[]).map(O=>O.id),W=g().reduce((O,L)=>{const F=L.parentNode||L.parentId,A=!M.includes(L.id)&&F&&O.find(D=>D.id===F);return(typeof L.deletable=="boolean"?L.deletable:!0)&&(M.includes(L.id)||A)&&O.push(L),O},[]),V=w.filter(O=>typeof O.deletable=="boolean"?O.deletable:!0),E=V.filter(O=>B.includes(O.id));if(W||E){const O=Ug(W,V),L=[...E,...O],F=L.reduce((A,b)=>(A.includes(b.id)||A.push(b.id),A),[]);if((C||k)&&(C&&t.setState({edges:w.filter(A=>!F.includes(A.id))}),k&&(W.forEach(A=>{h.delete(A.id)}),t.setState({nodeInternals:new Map(h)}))),F.length>0&&(T==null||T(L),$&&$(F.map(A=>({id:A,type:"remove"})))),W.length>0&&(N==null||N(W),P)){const A=W.map(b=>({id:b.id,type:"remove"}));P(A)}}},[]),p=v.useCallback(x=>{const j=cN(x),h=j?null:t.getState().nodeInternals.get(x.id);return!j&&!h?[null,null,j]:[j?x:Hf(h),h,j]},[]),m=v.useCallback((x,j=!0,h)=>{const[g,w,k]=p(x);return g?(h||t.getState().getNodes()).filter(C=>{if(!k&&(C.id===w.id||!C.positionAbsolute))return!1;const N=Hf(C),T=kc(N,g);return j&&T>0||T>=g.width*g.height}):[]},[]),y=v.useCallback((x,j,h=!0)=>{const[g]=p(x);if(!g)return!1;const w=kc(g,j);return h&&w>0||w>=g.width*g.height},[]);return v.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:s,getEdge:o,setNodes:i,setEdges:l,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:m,isNodeIntersecting:y}),[e,n,r,s,o,i,l,c,u,d,f,m,y])}const UN={actInsideInputWithModifier:!1};var VN=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=He(),{deleteElements:r}=Ku(),s=go(e,UN),o=go(t);v.useEffect(()=>{if(s){const{edges:i,getNodes:l}=n.getState(),c=l().filter(d=>d.selected),u=i.filter(d=>d.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),v.useEffect(()=>{n.setState({multiSelectionActive:o})},[o])};function WN(e){const t=He();v.useEffect(()=>{let n;const r=()=>{var o,i;if(!e.current)return;const s=zu(e.current);(s.height===0||s.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",Sn.error004())),t.setState({width:s.width||500,height:s.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Gu={position:"absolute",width:"100%",height:"100%",top:0,left:0},YN=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ni=e=>({x:e.x,y:e.y,zoom:e.k}),Sr=(e,t)=>e.target.closest(`.${t}`),Zf=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),qf=e=>{const t=e.ctrlKey&&Zi()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},KN=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),GN=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:s=!0,zoomOnPinch:o=!0,panOnScroll:i=!1,panOnScrollSpeed:l=.5,panOnScrollMode:c=nr.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:p,translateExtent:m,minZoom:y,maxZoom:x,zoomActivationKeyCode:j,preventScrolling:h=!0,children:g,noWheelClassName:w,noPanClassName:k})=>{const C=v.useRef(),N=He(),T=v.useRef(!1),P=v.useRef(!1),$=v.useRef(null),M=v.useRef({x:0,y:0,zoom:0}),{d3Zoom:B,d3Selection:W,d3ZoomHandler:V,userSelectionActive:E}=Ne(KN,ht),O=go(j),L=v.useRef(0),F=v.useRef(!1),A=v.useRef();return WN($),v.useEffect(()=>{if($.current){const b=$.current.getBoundingClientRect(),D=bg().scaleExtent([y,x]).translateExtent(m),z=_t($.current).call(D),H=pn.translate(p.x,p.y).scale(rs(p.zoom,y,x)),X=[[0,0],[b.width,b.height]],G=D.constrain()(H,X,m);D.transform(z,G),D.wheelDelta(qf),N.setState({d3Zoom:D,d3Selection:z,d3ZoomHandler:z.on("wheel.zoom"),transform:[G.x,G.y,G.k],domNode:$.current.closest(".react-flow")})}},[]),v.useEffect(()=>{W&&B&&(i&&!O&&!E?W.on("wheel.zoom",b=>{if(Sr(b,w))return!1;b.preventDefault(),b.stopImmediatePropagation();const D=W.property("__zoom").k||1;if(b.ctrlKey&&o){const ue=Rt(b),se=qf(b),J=D*Math.pow(2,se);B.scaleTo(W,J,ue,b);return}const z=b.deltaMode===1?20:1;let H=c===nr.Vertical?0:b.deltaX*z,X=c===nr.Horizontal?0:b.deltaY*z;!Zi()&&b.shiftKey&&c!==nr.Vertical&&(H=b.deltaY*z,X=0),B.translateBy(W,-(H/D)*l,-(X/D)*l,{internal:!0});const G=ni(W.property("__zoom")),{onViewportChangeStart:q,onViewportChange:te,onViewportChangeEnd:re}=N.getState();clearTimeout(A.current),F.current||(F.current=!0,t==null||t(b,G),q==null||q(G)),F.current&&(e==null||e(b,G),te==null||te(G),A.current=setTimeout(()=>{n==null||n(b,G),re==null||re(G),F.current=!1},150))},{passive:!1}):typeof V<"u"&&W.on("wheel.zoom",function(b,D){if(!h&&b.type==="wheel"&&!b.ctrlKey||Sr(b,w))return null;b.preventDefault(),V.call(this,b,D)},{passive:!1}))},[E,i,c,W,B,V,O,o,h,w,t,e,n]),v.useEffect(()=>{B&&B.on("start",b=>{var H,X;if(!b.sourceEvent||b.sourceEvent.internal)return null;L.current=(H=b.sourceEvent)==null?void 0:H.button;const{onViewportChangeStart:D}=N.getState(),z=ni(b.transform);T.current=!0,M.current=z,((X=b.sourceEvent)==null?void 0:X.type)==="mousedown"&&N.setState({paneDragging:!0}),D==null||D(z),t==null||t(b.sourceEvent,z)})},[B,t]),v.useEffect(()=>{B&&(E&&!T.current?B.on("zoom",null):E||B.on("zoom",b=>{var z;const{onViewportChange:D}=N.getState();if(N.setState({transform:[b.transform.x,b.transform.y,b.transform.k]}),P.current=!!(r&&Zf(f,L.current??0)),(e||D)&&!((z=b.sourceEvent)!=null&&z.internal)){const H=ni(b.transform);D==null||D(H),e==null||e(b.sourceEvent,H)}}))},[E,B,e,f,r]),v.useEffect(()=>{B&&B.on("end",b=>{if(!b.sourceEvent||b.sourceEvent.internal)return null;const{onViewportChangeEnd:D}=N.getState();if(T.current=!1,N.setState({paneDragging:!1}),r&&Zf(f,L.current??0)&&!P.current&&r(b.sourceEvent),P.current=!1,(n||D)&&YN(M.current,b.transform)){const z=ni(b.transform);M.current=z,clearTimeout(C.current),C.current=setTimeout(()=>{D==null||D(z),n==null||n(b.sourceEvent,z)},i?150:0)}})},[B,i,f,n,r]),v.useEffect(()=>{B&&B.filter(b=>{const D=O||s,z=o&&b.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&b.button===1&&b.type==="mousedown"&&(Sr(b,"react-flow__node")||Sr(b,"react-flow__edge")))return!0;if(!f&&!D&&!i&&!u&&!o||E||!u&&b.type==="dblclick"||Sr(b,w)&&b.type==="wheel"||Sr(b,k)&&(b.type!=="wheel"||i&&b.type==="wheel"&&!O)||!o&&b.ctrlKey&&b.type==="wheel"||!D&&!i&&!z&&b.type==="wheel"||!f&&(b.type==="mousedown"||b.type==="touchstart")||Array.isArray(f)&&!f.includes(b.button)&&b.type==="mousedown")return!1;const H=Array.isArray(f)&&f.includes(b.button)||!b.button||b.button<=1;return(!b.ctrlKey||b.type==="wheel")&&H})},[E,B,s,o,i,u,f,d,O]),I.createElement("div",{className:"react-flow__renderer",ref:$,style:Gu},g)},XN=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function JN(){const{userSelectionActive:e,userSelectionRect:t}=Ne(XN,ht);return e&&t?I.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function eh(e,t){const n=t.parentNode||t.parentId,r=e.find(s=>s.id===n);if(r){const s=t.position.x+t.width-r.width,o=t.position.y+t.height-r.height;if(s>0||o>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,s>0&&(r.style.width+=s),o>0&&(r.style.height+=o),t.position.x<0){const i=Math.abs(t.position.x);r.position.x=r.position.x-i,r.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);r.position.y=r.position.y-i,r.style.height+=i,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function iy(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,s)=>{const o=e.filter(l=>l.id===s.id);if(o.length===0)return r.push(s),r;const i={...s};for(const l of o)if(l)switch(l.type){case"select":{i.selected=l.selected;break}case"position":{typeof l.position<"u"&&(i.position=l.position),typeof l.positionAbsolute<"u"&&(i.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(i.dragging=l.dragging),i.expandParent&&eh(r,i);break}case"dimensions":{typeof l.dimensions<"u"&&(i.width=l.dimensions.width,i.height=l.dimensions.height),typeof l.updateStyle<"u"&&(i.style={...i.style||{},...l.dimensions}),typeof l.resizing=="boolean"&&(i.resizing=l.resizing),i.expandParent&&eh(r,i);break}case"remove":return r}return r.push(i),r},n)}function ay(e,t){return iy(e,t)}function QN(e,t){return iy(e,t)}const Tn=(e,t)=>({id:e,type:"select",selected:t});function Or(e,t){return e.reduce((n,r)=>{const s=t.includes(r.id);return!r.selected&&s?(r.selected=!0,n.push(Tn(r.id,!0))):r.selected&&!s&&(r.selected=!1,n.push(Tn(r.id,!1))),n},[])}const fl=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},ZN=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),ly=v.memo(({isSelecting:e,selectionMode:t=mo.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:s,onPaneClick:o,onPaneContextMenu:i,onPaneScroll:l,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const p=v.useRef(null),m=He(),y=v.useRef(0),x=v.useRef(0),j=v.useRef(),{userSelectionActive:h,elementsSelectable:g,dragging:w}=Ne(ZN,ht),k=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,x.current=0},C=V=>{o==null||o(V),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},N=V=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){V.preventDefault();return}i==null||i(V)},T=l?V=>l(V):void 0,P=V=>{const{resetSelectedElements:E,domNode:O}=m.getState();if(j.current=O==null?void 0:O.getBoundingClientRect(),!g||!e||V.button!==0||V.target!==p.current||!j.current)return;const{x:L,y:F}=Un(V,j.current);E(),m.setState({userSelectionRect:{width:0,height:0,startX:L,startY:F,x:L,y:F}}),r==null||r(V)},$=V=>{const{userSelectionRect:E,nodeInternals:O,edges:L,transform:F,onNodesChange:A,onEdgesChange:b,nodeOrigin:D,getNodes:z}=m.getState();if(!e||!j.current||!E)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const H=Un(V,j.current),X=E.startX??0,G=E.startY??0,q={...E,x:H.x<X?H.x:X,y:H.y<G?H.y:G,width:Math.abs(H.x-X),height:Math.abs(H.y-G)},te=z(),re=Hg(O,q,F,t===mo.Partial,!0,D),ue=Ug(re,L).map(J=>J.id),se=re.map(J=>J.id);if(y.current!==se.length){y.current=se.length;const J=Or(te,se);J.length&&(A==null||A(J))}if(x.current!==ue.length){x.current=ue.length;const J=Or(L,ue);J.length&&(b==null||b(J))}m.setState({userSelectionRect:q})},M=V=>{if(V.button!==0)return;const{userSelectionRect:E}=m.getState();!h&&E&&V.target===p.current&&(C==null||C(V)),m.setState({nodesSelectionActive:y.current>0}),k(),s==null||s(V)},B=V=>{h&&(m.setState({nodesSelectionActive:y.current>0}),s==null||s(V)),k()},W=g&&(e||h);return I.createElement("div",{className:et(["react-flow__pane",{dragging:w,selection:e}]),onClick:W?void 0:fl(C,p),onContextMenu:fl(N,p),onWheel:fl(T,p),onMouseEnter:W?void 0:c,onMouseDown:W?P:void 0,onMouseMove:W?$:u,onMouseUp:W?M:void 0,onMouseLeave:W?B:d,ref:p,style:Gu},f,I.createElement(JN,null))});ly.displayName="Pane";function cy(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:cy(r,t):!1}function th(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function qN(e,t,n,r){return Array.from(e.values()).filter(s=>(s.selected||s.id===r)&&(!s.parentNode||s.parentId||!cy(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var o,i;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((o=s.positionAbsolute)==null?void 0:o.x)??0),y:n.y-(((i=s.positionAbsolute)==null?void 0:i.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function eE(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function uy(e,t,n,r,s=[0,0],o){const i=eE(e,e.extent||r);let l=i;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:p,y:m}=ir(f,s).positionAbsolute;l=f&&Tt(p)&&Tt(m)&&Tt(f.width)&&Tt(f.height)?[[p+e.width*s[0],m+e.height*s[1]],[p+f.width-e.width+e.width*s[0],m+f.height-e.height+e.height*s[1]]]:l}else o==null||o("005",Sn.error005()),l=i;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:p,y:m}=ir(f,s).positionAbsolute;l=[[e.extent[0][0]+p,e.extent[0][1]+m],[e.extent[1][0]+p,e.extent[1][1]+m]]}let u={x:0,y:0};if(c){const f=n.get(c);u=ir(f,s).positionAbsolute}const d=l&&l!=="parent"?Fu(t,l):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function hl({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?r.find(s=>s.id===e):r[0],r]}const nh=(e,t,n,r)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const o=Array.from(s),i=t.getBoundingClientRect(),l={x:i.width*r[0],y:i.height*r[1]};return o.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-i.left-l.x)/n,y:(u.top-i.top-l.y)/n,...zu(c)}})};function js(e,t,n){return n===void 0?n:r=>{const s=t().nodeInternals.get(e);s&&n(r,{...s})}}function bc({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:s,unselectNodesAndEdges:o,multiSelectionActive:i,nodeInternals:l,onError:c}=t.getState(),u=l.get(e);if(!u){c==null||c("012",Sn.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&i)&&(o({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):s([e])}function tE(){const e=He();return v.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:s,snapToGrid:o}=e.getState(),i=n.touches?n.touches[0].clientX:n.clientX,l=n.touches?n.touches[0].clientY:n.clientY,c={x:(i-r[0])/r[2],y:(l-r[1])/r[2]};return{xSnapped:o?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:o?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function pl(e){return(t,n,r)=>e==null?void 0:e(t,r)}function dy({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:s,isSelectable:o,selectNodesOnDrag:i}){const l=He(),[c,u]=v.useState(!1),d=v.useRef([]),f=v.useRef({x:null,y:null}),p=v.useRef(0),m=v.useRef(null),y=v.useRef({x:0,y:0}),x=v.useRef(null),j=v.useRef(!1),h=v.useRef(!1),g=v.useRef(!1),w=tE();return v.useEffect(()=>{if(e!=null&&e.current){const k=_t(e.current),C=({x:P,y:$})=>{const{nodeInternals:M,onNodeDrag:B,onSelectionDrag:W,updateNodePositions:V,nodeExtent:E,snapGrid:O,snapToGrid:L,nodeOrigin:F,onError:A}=l.getState();f.current={x:P,y:$};let b=!1,D={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&E){const H=Ea(d.current,F);D=po(H)}if(d.current=d.current.map(H=>{const X={x:P-H.distance.x,y:$-H.distance.y};L&&(X.x=O[0]*Math.round(X.x/O[0]),X.y=O[1]*Math.round(X.y/O[1]));const G=[[E[0][0],E[0][1]],[E[1][0],E[1][1]]];d.current.length>1&&E&&!H.extent&&(G[0][0]=H.positionAbsolute.x-D.x+E[0][0],G[1][0]=H.positionAbsolute.x+(H.width??0)-D.x2+E[1][0],G[0][1]=H.positionAbsolute.y-D.y+E[0][1],G[1][1]=H.positionAbsolute.y+(H.height??0)-D.y2+E[1][1]);const q=uy(H,X,M,G,F,A);return b=b||H.position.x!==q.position.x||H.position.y!==q.position.y,H.position=q.position,H.positionAbsolute=q.positionAbsolute,H}),!b)return;V(d.current,!0,!0),u(!0);const z=s?B:pl(W);if(z&&x.current){const[H,X]=hl({nodeId:s,dragItems:d.current,nodeInternals:M});z(x.current,H,X)}},N=()=>{if(!m.current)return;const[P,$]=Pg(y.current,m.current);if(P!==0||$!==0){const{transform:M,panBy:B}=l.getState();f.current.x=(f.current.x??0)-P/M[2],f.current.y=(f.current.y??0)-$/M[2],B({x:P,y:$})&&C(f.current)}p.current=requestAnimationFrame(N)},T=P=>{var F;const{nodeInternals:$,multiSelectionActive:M,nodesDraggable:B,unselectNodesAndEdges:W,onNodeDragStart:V,onSelectionDragStart:E}=l.getState();h.current=!0;const O=s?V:pl(E);(!i||!o)&&!M&&s&&((F=$.get(s))!=null&&F.selected||W()),s&&o&&i&&bc({id:s,store:l,nodeRef:e});const L=w(P);if(f.current=L,d.current=qN($,B,L,s),O&&d.current){const[A,b]=hl({nodeId:s,dragItems:d.current,nodeInternals:$});O(P.sourceEvent,A,b)}};if(t)k.on(".drag",null);else{const P=hC().on("start",$=>{const{domNode:M,nodeDragThreshold:B}=l.getState();B===0&&T($),g.current=!1;const W=w($);f.current=W,m.current=(M==null?void 0:M.getBoundingClientRect())||null,y.current=Un($.sourceEvent,m.current)}).on("drag",$=>{var V,E;const M=w($),{autoPanOnNodeDrag:B,nodeDragThreshold:W}=l.getState();if($.sourceEvent.type==="touchmove"&&$.sourceEvent.touches.length>1&&(g.current=!0),!g.current){if(!j.current&&h.current&&B&&(j.current=!0,N()),!h.current){const O=M.xSnapped-(((V=f==null?void 0:f.current)==null?void 0:V.x)??0),L=M.ySnapped-(((E=f==null?void 0:f.current)==null?void 0:E.y)??0);Math.sqrt(O*O+L*L)>W&&T($)}(f.current.x!==M.xSnapped||f.current.y!==M.ySnapped)&&d.current&&h.current&&(x.current=$.sourceEvent,y.current=Un($.sourceEvent,m.current),C(M))}}).on("end",$=>{if(!(!h.current||g.current)&&(u(!1),j.current=!1,h.current=!1,cancelAnimationFrame(p.current),d.current)){const{updateNodePositions:M,nodeInternals:B,onNodeDragStop:W,onSelectionDragStop:V}=l.getState(),E=s?W:pl(V);if(M(d.current,!1,!1),E){const[O,L]=hl({nodeId:s,dragItems:d.current,nodeInternals:B});E($.sourceEvent,O,L)}}}).filter($=>{const M=$.target;return!$.button&&(!n||!th(M,`.${n}`,e))&&(!r||th(M,r,e))});return k.call(P),()=>{k.on(".drag",null)}}}},[e,t,n,r,o,l,s,i,w]),c}function fy(){const e=He();return v.useCallback(n=>{const{nodeInternals:r,nodeExtent:s,updateNodePositions:o,getNodes:i,snapToGrid:l,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=i().filter(g=>g.selected&&(g.draggable||d&&typeof g.draggable>"u")),p=l?c[0]:5,m=l?c[1]:5,y=n.isShiftPressed?4:1,x=n.x*p*y,j=n.y*m*y,h=f.map(g=>{if(g.positionAbsolute){const w={x:g.positionAbsolute.x+x,y:g.positionAbsolute.y+j};l&&(w.x=c[0]*Math.round(w.x/c[0]),w.y=c[1]*Math.round(w.y/c[1]));const{positionAbsolute:k,position:C}=uy(g,w,r,s,void 0,u);g.position=C,g.positionAbsolute=k}return g});o(h,!0,!1)},[])}const Yr={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ns=e=>{const t=({id:n,type:r,data:s,xPos:o,yPos:i,xPosOrigin:l,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:p,onMouseLeave:m,onContextMenu:y,onDoubleClick:x,style:j,className:h,isDraggable:g,isSelectable:w,isConnectable:k,isFocusable:C,selectNodesOnDrag:N,sourcePosition:T,targetPosition:P,hidden:$,resizeObserver:M,dragHandle:B,zIndex:W,isParent:V,noDragClassName:E,noPanClassName:O,initialized:L,disableKeyboardA11y:F,ariaLabel:A,rfId:b,hasHandleBounds:D})=>{const z=He(),H=v.useRef(null),X=v.useRef(null),G=v.useRef(T),q=v.useRef(P),te=v.useRef(r),re=w||g||d||f||p||m,ue=fy(),se=js(n,z.getState,f),J=js(n,z.getState,p),ve=js(n,z.getState,m),we=js(n,z.getState,y),Me=js(n,z.getState,x),Re=he=>{const{nodeDragThreshold:ee}=z.getState();if(w&&(!N||!g||ee>0)&&bc({id:n,store:z,nodeRef:H}),d){const Ie=z.getState().nodeInternals.get(n);Ie&&d(he,{...Ie})}},Ee=he=>{if(!Cc(he)&&!F)if(Ag.includes(he.key)&&w){const ee=he.key==="Escape";bc({id:n,store:z,unselect:ee,nodeRef:H})}else g&&u&&Object.prototype.hasOwnProperty.call(Yr,he.key)&&(z.setState({ariaLiveMessage:`Moved selected node ${he.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~o}, y: ${~~i}`}),ue({x:Yr[he.key].x,y:Yr[he.key].y,isShiftPressed:he.shiftKey}))};v.useEffect(()=>()=>{X.current&&(M==null||M.unobserve(X.current),X.current=null)},[]),v.useEffect(()=>{if(H.current&&!$){const he=H.current;(!L||!D||X.current!==he)&&(X.current&&(M==null||M.unobserve(X.current)),M==null||M.observe(he),X.current=he)}},[$,L,D]),v.useEffect(()=>{const he=te.current!==r,ee=G.current!==T,Ie=q.current!==P;H.current&&(he||ee||Ie)&&(he&&(te.current=r),ee&&(G.current=T),Ie&&(q.current=P),z.getState().updateNodeDimensions([{id:n,nodeElement:H.current,forceUpdate:!0}]))},[n,r,T,P]);const Ue=dy({nodeRef:H,disabled:$||!g,noDragClassName:E,handleSelector:B,nodeId:n,isSelectable:w,selectNodesOnDrag:N});return $?null:I.createElement("div",{className:et(["react-flow__node",`react-flow__node-${r}`,{[O]:g},h,{selected:u,selectable:w,parent:V,dragging:Ue}]),ref:H,style:{zIndex:W,transform:`translate(${l}px,${c}px)`,pointerEvents:re?"all":"none",visibility:L?"visible":"hidden",...j},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:se,onMouseMove:J,onMouseLeave:ve,onContextMenu:we,onClick:Re,onDoubleClick:Me,onKeyDown:C?Ee:void 0,tabIndex:C?0:void 0,role:C?"button":void 0,"aria-describedby":F?void 0:`${ty}-${b}`,"aria-label":A},I.createElement(gN,{value:n},I.createElement(e,{id:n,data:s,type:r,xPos:o,yPos:i,selected:u,isConnectable:k,sourcePosition:T,targetPosition:P,dragging:Ue,dragHandle:B,zIndex:W})))};return t.displayName="NodeWrapper",v.memo(t)};const nE=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Ea(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function rE({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=He(),{width:s,height:o,x:i,y:l,transformString:c,userSelectionActive:u}=Ne(nE,ht),d=fy(),f=v.useRef(null);if(v.useEffect(()=>{var y;n||(y=f.current)==null||y.focus({preventScroll:!0})},[n]),dy({nodeRef:f}),u||!s||!o)return null;const p=e?y=>{const x=r.getState().getNodes().filter(j=>j.selected);e(y,x)}:void 0,m=y=>{Object.prototype.hasOwnProperty.call(Yr,y.key)&&d({x:Yr[y.key].x,y:Yr[y.key].y,isShiftPressed:y.shiftKey})};return I.createElement("div",{className:et(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},I.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:s,height:o,top:l,left:i}}))}var sE=v.memo(rE);const oE=e=>e.nodesSelectionActive,hy=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:i,deleteKeyCode:l,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:p,selectionMode:m,onSelectionStart:y,onSelectionEnd:x,multiSelectionKeyCode:j,panActivationKeyCode:h,zoomActivationKeyCode:g,elementsSelectable:w,zoomOnScroll:k,zoomOnPinch:C,panOnScroll:N,panOnScrollSpeed:T,panOnScrollMode:P,zoomOnDoubleClick:$,panOnDrag:M,defaultViewport:B,translateExtent:W,minZoom:V,maxZoom:E,preventScrolling:O,onSelectionContextMenu:L,noWheelClassName:F,noPanClassName:A,disableKeyboardA11y:b})=>{const D=Ne(oE),z=go(f),H=go(h),X=H||M,G=H||N,q=z||p&&X!==!0;return VN({deleteKeyCode:l,multiSelectionKeyCode:j}),I.createElement(GN,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:o,elementsSelectable:w,zoomOnScroll:k,zoomOnPinch:C,panOnScroll:G,panOnScrollSpeed:T,panOnScrollMode:P,zoomOnDoubleClick:$,panOnDrag:!z&&X,defaultViewport:B,translateExtent:W,minZoom:V,maxZoom:E,zoomActivationKeyCode:g,preventScrolling:O,noWheelClassName:F,noPanClassName:A},I.createElement(ly,{onSelectionStart:y,onSelectionEnd:x,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:o,onPaneScroll:i,panOnDrag:X,isSelecting:!!q,selectionMode:m},e,D&&I.createElement(sE,{onSelectionContextMenu:L,noPanClassName:A,disableKeyboardA11y:b})))};hy.displayName="FlowRenderer";var iE=v.memo(hy);function aE(e){return Ne(v.useCallback(n=>e?Hg(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function lE(e){const t={input:Ns(e.input||Qg),default:Ns(e.default||_c),output:Ns(e.output||qg),group:Ns(e.group||Yu)},n={},r=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,o)=>(s[o]=Ns(e[o]||_c),s),n);return{...t,...r}}const cE=({x:e,y:t,width:n,height:r,origin:s})=>!n||!r?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-r*s[1]},uE=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),py=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:s,updateNodeDimensions:o,onError:i}=Ne(uE,ht),l=aE(e.onlyRenderVisibleElements),c=v.useRef(),u=v.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const p=f.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));o(p)});return c.current=d,d},[]);return v.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),I.createElement("div",{className:"react-flow__nodes",style:Gu},l.map(d=>{var C,N,T;let f=d.type||"default";e.nodeTypes[f]||(i==null||i("003",Sn.error003(f)),f="default");const p=e.nodeTypes[f]||e.nodeTypes.default,m=!!(d.draggable||t&&typeof d.draggable>"u"),y=!!(d.selectable||s&&typeof d.selectable>"u"),x=!!(d.connectable||n&&typeof d.connectable>"u"),j=!!(d.focusable||r&&typeof d.focusable>"u"),h=e.nodeExtent?Fu(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,g=(h==null?void 0:h.x)??0,w=(h==null?void 0:h.y)??0,k=cE({x:g,y:w,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return I.createElement(p,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||ne.Bottom,targetPosition:d.targetPosition||ne.Top,hidden:d.hidden,xPos:g,yPos:w,xPosOrigin:k.x,yPosOrigin:k.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:m,isSelectable:y,isConnectable:x,isFocusable:j,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((C=d[Ae])==null?void 0:C.z)??0,isParent:!!((N=d[Ae])!=null&&N.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((T=d[Ae])!=null&&T.handleBounds)})}))};py.displayName="NodeRenderer";var dE=v.memo(py);const fE=(e,t,n)=>n===ne.Left?e-t:n===ne.Right?e+t:e,hE=(e,t,n)=>n===ne.Top?e-t:n===ne.Bottom?e+t:e,rh="react-flow__edgeupdater",sh=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:s,onMouseEnter:o,onMouseOut:i,type:l})=>I.createElement("circle",{onMouseDown:s,onMouseEnter:o,onMouseOut:i,className:et([rh,`${rh}-${l}`]),cx:fE(t,r,e),cy:hE(n,r,e),r,stroke:"transparent",fill:"transparent"}),pE=()=>!0;var kr=e=>{const t=({id:n,className:r,type:s,data:o,onClick:i,onEdgeDoubleClick:l,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:x,style:j,source:h,target:g,sourceX:w,sourceY:k,targetX:C,targetY:N,sourcePosition:T,targetPosition:P,elementsSelectable:$,hidden:M,sourceHandleId:B,targetHandleId:W,onContextMenu:V,onMouseEnter:E,onMouseMove:O,onMouseLeave:L,reconnectRadius:F,onReconnect:A,onReconnectStart:b,onReconnectEnd:D,markerEnd:z,markerStart:H,rfId:X,ariaLabel:G,isFocusable:q,isReconnectable:te,pathOptions:re,interactionWidth:ue,disableKeyboardA11y:se})=>{const J=v.useRef(null),[ve,we]=v.useState(!1),[Me,Re]=v.useState(!1),Ee=He(),Ue=v.useMemo(()=>`url('#${Nc(H,X)}')`,[H,X]),he=v.useMemo(()=>`url('#${Nc(z,X)}')`,[z,X]);if(M)return null;const ee=R=>{var xe;const{edges:K,addSelectedEdges:de,unselectNodesAndEdges:ae,multiSelectionActive:oe}=Ee.getState(),ge=K.find(fe=>fe.id===n);ge&&($&&(Ee.setState({nodesSelectionActive:!1}),ge.selected&&oe?(ae({nodes:[],edges:[ge]}),(xe=J.current)==null||xe.blur()):de([n])),i&&i(R,ge))},Ie=Cs(n,Ee.getState,l),ot=Cs(n,Ee.getState,V),Vt=Cs(n,Ee.getState,E),Wt=Cs(n,Ee.getState,O),$t=Cs(n,Ee.getState,L),Ye=(R,K)=>{if(R.button!==0)return;const{edges:de,isValidConnection:ae}=Ee.getState(),oe=K?g:h,ge=(K?W:B)||null,xe=K?"target":"source",fe=ae||pE,pt=K,ie=de.find(ke=>ke.id===n);Re(!0),b==null||b(R,ie,xe);const us=ke=>{Re(!1),D==null||D(ke,ie,xe)};Kg({event:R,handleId:ge,nodeId:oe,onConnect:ke=>A==null?void 0:A(ie,ke),isTarget:pt,getState:Ee.getState,setState:Ee.setState,isValidConnection:fe,edgeUpdaterType:xe,onReconnectEnd:us})},Yt=R=>Ye(R,!0),kt=R=>Ye(R,!1),Ct=()=>we(!0),S=()=>we(!1),_=!$&&!i,U=R=>{var K;if(!se&&Ag.includes(R.key)&&$){const{unselectNodesAndEdges:de,addSelectedEdges:ae,edges:oe}=Ee.getState();R.key==="Escape"?((K=J.current)==null||K.blur(),de({edges:[oe.find(xe=>xe.id===n)]})):ae([n])}};return I.createElement("g",{className:et(["react-flow__edge",`react-flow__edge-${s}`,r,{selected:c,animated:u,inactive:_,updating:ve}]),onClick:ee,onDoubleClick:Ie,onContextMenu:ot,onMouseEnter:Vt,onMouseMove:Wt,onMouseLeave:$t,onKeyDown:q?U:void 0,tabIndex:q?0:void 0,role:q?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":G===null?void 0:G||`Edge from ${h} to ${g}`,"aria-describedby":q?`${ny}-${X}`:void 0,ref:J},!Me&&I.createElement(e,{id:n,source:h,target:g,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:x,data:o,style:j,sourceX:w,sourceY:k,targetX:C,targetY:N,sourcePosition:T,targetPosition:P,sourceHandleId:B,targetHandleId:W,markerStart:Ue,markerEnd:he,pathOptions:re,interactionWidth:ue}),te&&I.createElement(I.Fragment,null,(te==="source"||te===!0)&&I.createElement(sh,{position:T,centerX:w,centerY:k,radius:F,onMouseDown:Yt,onMouseEnter:Ct,onMouseOut:S,type:"source"}),(te==="target"||te===!0)&&I.createElement(sh,{position:P,centerX:C,centerY:N,radius:F,onMouseDown:kt,onMouseEnter:Ct,onMouseOut:S,type:"target"})))};return t.displayName="EdgeWrapper",v.memo(t)};function mE(e){const t={default:kr(e.default||ea),straight:kr(e.bezier||Uu),step:kr(e.step||Hu),smoothstep:kr(e.step||Na),simplebezier:kr(e.simplebezier||Bu)},n={},r=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,o)=>(s[o]=kr(e[o]||ea),s),n);return{...t,...r}}function oh(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,o=(n==null?void 0:n.width)||t.width,i=(n==null?void 0:n.height)||t.height;switch(e){case ne.Top:return{x:r+o/2,y:s};case ne.Right:return{x:r+o,y:s+i/2};case ne.Bottom:return{x:r+o/2,y:s+i};case ne.Left:return{x:r,y:s+i/2}}}function ih(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const gE=(e,t,n,r,s,o)=>{const i=oh(n,e,t),l=oh(o,r,s);return{sourceX:i.x,sourceY:i.y,targetX:l.x,targetY:l.y}};function yE({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:s,targetHeight:o,width:i,height:l,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+r,t.y+o)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=po({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:i/c[2],height:l/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),p=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*p)>0}function ah(e){var r,s,o,i,l;const t=((r=e==null?void 0:e[Ae])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)<"u";return[{x:((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.x)||0,y:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const vE=[{level:0,isMaxLevel:!0,edges:[]}];function xE(e,t,n=!1){let r=-1;const s=e.reduce((i,l)=>{var d,f;const c=Tt(l.zIndex);let u=c?l.zIndex:0;if(n){const p=t.get(l.target),m=t.get(l.source),y=l.selected||(p==null?void 0:p.selected)||(m==null?void 0:m.selected),x=Math.max(((d=m==null?void 0:m[Ae])==null?void 0:d.z)||0,((f=p==null?void 0:p[Ae])==null?void 0:f.z)||0,1e3);u=(c?l.zIndex:0)+(y?x:0)}return i[u]?i[u].push(l):i[u]=[l],r=u>r?u:r,i},{}),o=Object.entries(s).map(([i,l])=>{const c=+i;return{edges:l,level:c,isMaxLevel:c===r}});return o.length===0?vE:o}function wE(e,t,n){const r=Ne(v.useCallback(s=>e?s.edges.filter(o=>{const i=t.get(o.source),l=t.get(o.target);return(i==null?void 0:i.width)&&(i==null?void 0:i.height)&&(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&yE({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:l.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:l.width,targetHeight:l.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return xE(r,t,n)}const SE=({color:e="none",strokeWidth:t=1})=>I.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),kE=({color:e="none",strokeWidth:t=1})=>I.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),lh={[qi.Arrow]:SE,[qi.ArrowClosed]:kE};function CE(e){const t=He();return v.useMemo(()=>{var s,o;return Object.prototype.hasOwnProperty.call(lh,e)?lh[e]:((o=(s=t.getState()).onError)==null||o.call(s,"009",Sn.error009(e)),null)},[e])}const jE=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:o="strokeWidth",strokeWidth:i,orient:l="auto-start-reverse"})=>{const c=CE(t);return c?I.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:o,orient:l,refX:"0",refY:"0"},I.createElement(c,{color:n,strokeWidth:i})):null},NE=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((s,o)=>([o.markerStart,o.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const l=Nc(i,t);r.includes(l)||(s.push({id:l,color:i.color||e,...i}),r.push(l))}}),s),[]).sort((s,o)=>s.id.localeCompare(o.id))},my=({defaultColor:e,rfId:t})=>{const n=Ne(v.useCallback(NE({defaultColor:e,rfId:t}),[e,t]),(r,s)=>!(r.length!==s.length||r.some((o,i)=>o.id!==s[i].id)));return I.createElement("defs",null,n.map(r=>I.createElement(jE,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};my.displayName="MarkerDefinitions";var EE=v.memo(my);const _E=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),gy=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:s,noPanClassName:o,onEdgeContextMenu:i,onEdgeMouseEnter:l,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:m,onReconnectEnd:y,reconnectRadius:x,children:j,disableKeyboardA11y:h})=>{const{edgesFocusable:g,edgesUpdatable:w,elementsSelectable:k,width:C,height:N,connectionMode:T,nodeInternals:P,onError:$}=Ne(_E,ht),M=wE(t,P,n);return C?I.createElement(I.Fragment,null,M.map(({level:B,edges:W,isMaxLevel:V})=>I.createElement("svg",{key:B,style:{zIndex:B},width:C,height:N,className:"react-flow__edges react-flow__container"},V&&I.createElement(EE,{defaultColor:e,rfId:r}),I.createElement("g",null,W.map(E=>{const[O,L,F]=ah(P.get(E.source)),[A,b,D]=ah(P.get(E.target));if(!F||!D)return null;let z=E.type||"default";s[z]||($==null||$("011",Sn.error011(z)),z="default");const H=s[z]||s.default,X=T===hr.Strict?b.target:(b.target??[]).concat(b.source??[]),G=ih(L.source,E.sourceHandle),q=ih(X,E.targetHandle),te=(G==null?void 0:G.position)||ne.Bottom,re=(q==null?void 0:q.position)||ne.Top,ue=!!(E.focusable||g&&typeof E.focusable>"u"),se=E.reconnectable||E.updatable,J=typeof p<"u"&&(se||w&&typeof se>"u");if(!G||!q)return $==null||$("008",Sn.error008(G,E)),null;const{sourceX:ve,sourceY:we,targetX:Me,targetY:Re}=gE(O,G,te,A,q,re);return I.createElement(H,{key:E.id,id:E.id,className:et([E.className,o]),type:z,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:ve,sourceY:we,targetX:Me,targetY:Re,sourcePosition:te,targetPosition:re,elementsSelectable:k,onContextMenu:i,onMouseEnter:l,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:p,onReconnectStart:m,onReconnectEnd:y,reconnectRadius:x,rfId:r,ariaLabel:E.ariaLabel,isFocusable:ue,isReconnectable:J,pathOptions:"pathOptions"in E?E.pathOptions:void 0,interactionWidth:E.interactionWidth,disableKeyboardA11y:h})})))),j):null};gy.displayName="EdgeRenderer";var bE=v.memo(gy);const TE=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function PE({children:e}){const t=Ne(TE);return I.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function LE(e){const t=Ku(),n=v.useRef(!1);v.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const ME={[ne.Left]:ne.Right,[ne.Right]:ne.Left,[ne.Top]:ne.Bottom,[ne.Bottom]:ne.Top},yy=({nodeId:e,handleType:t,style:n,type:r=Mn.Bezier,CustomComponent:s,connectionStatus:o})=>{var N,T,P;const{fromNode:i,handleId:l,toX:c,toY:u,connectionMode:d}=Ne(v.useCallback($=>({fromNode:$.nodeInternals.get(e),handleId:$.connectionHandleId,toX:($.connectionPosition.x-$.transform[0])/$.transform[2],toY:($.connectionPosition.y-$.transform[1])/$.transform[2],connectionMode:$.connectionMode}),[e]),ht),f=(N=i==null?void 0:i[Ae])==null?void 0:N.handleBounds;let p=f==null?void 0:f[t];if(d===hr.Loose&&(p=p||(f==null?void 0:f[t==="source"?"target":"source"])),!i||!p)return null;const m=l?p.find($=>$.id===l):p[0],y=m?m.x+m.width/2:(i.width??0)/2,x=m?m.y+m.height/2:i.height??0,j=(((T=i.positionAbsolute)==null?void 0:T.x)??0)+y,h=(((P=i.positionAbsolute)==null?void 0:P.y)??0)+x,g=m==null?void 0:m.position,w=g?ME[g]:null;if(!g||!w)return null;if(s)return I.createElement(s,{connectionLineType:r,connectionLineStyle:n,fromNode:i,fromHandle:m,fromX:j,fromY:h,toX:c,toY:u,fromPosition:g,toPosition:w,connectionStatus:o});let k="";const C={sourceX:j,sourceY:h,sourcePosition:g,targetX:c,targetY:u,targetPosition:w};return r===Mn.Bezier?[k]=zg(C):r===Mn.Step?[k]=jc({...C,borderRadius:0}):r===Mn.SmoothStep?[k]=jc(C):r===Mn.SimpleBezier?[k]=Ig(C):k=`M${j},${h} ${c},${u}`,I.createElement("path",{d:k,fill:"none",className:"react-flow__connection-path",style:n})};yy.displayName="ConnectionLine";const $E=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function AE({containerStyle:e,style:t,type:n,component:r}){const{nodeId:s,handleType:o,nodesConnectable:i,width:l,height:c,connectionStatus:u}=Ne($E,ht);return!(s&&o&&l&&i)?null:I.createElement("svg",{style:e,width:l,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},I.createElement("g",{className:et(["react-flow__connection",u])},I.createElement(yy,{nodeId:s,handleType:o,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function ch(e,t){return v.useRef(null),He(),v.useMemo(()=>t(e),[e])}const vy=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:s,onInit:o,onNodeClick:i,onEdgeClick:l,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:m,onSelectionContextMenu:y,onSelectionStart:x,onSelectionEnd:j,connectionLineType:h,connectionLineStyle:g,connectionLineComponent:w,connectionLineContainerStyle:k,selectionKeyCode:C,selectionOnDrag:N,selectionMode:T,multiSelectionKeyCode:P,panActivationKeyCode:$,zoomActivationKeyCode:M,deleteKeyCode:B,onlyRenderVisibleElements:W,elementsSelectable:V,selectNodesOnDrag:E,defaultViewport:O,translateExtent:L,minZoom:F,maxZoom:A,preventScrolling:b,defaultMarkerColor:D,zoomOnScroll:z,zoomOnPinch:H,panOnScroll:X,panOnScrollSpeed:G,panOnScrollMode:q,zoomOnDoubleClick:te,panOnDrag:re,onPaneClick:ue,onPaneMouseEnter:se,onPaneMouseMove:J,onPaneMouseLeave:ve,onPaneScroll:we,onPaneContextMenu:Me,onEdgeContextMenu:Re,onEdgeMouseEnter:Ee,onEdgeMouseMove:Ue,onEdgeMouseLeave:he,onReconnect:ee,onReconnectStart:Ie,onReconnectEnd:ot,reconnectRadius:Vt,noDragClassName:Wt,noWheelClassName:$t,noPanClassName:Ye,elevateEdgesOnSelect:Yt,disableKeyboardA11y:kt,nodeOrigin:Ct,nodeExtent:S,rfId:_})=>{const U=ch(e,lE),R=ch(t,mE);return LE(o),I.createElement(iE,{onPaneClick:ue,onPaneMouseEnter:se,onPaneMouseMove:J,onPaneMouseLeave:ve,onPaneContextMenu:Me,onPaneScroll:we,deleteKeyCode:B,selectionKeyCode:C,selectionOnDrag:N,selectionMode:T,onSelectionStart:x,onSelectionEnd:j,multiSelectionKeyCode:P,panActivationKeyCode:$,zoomActivationKeyCode:M,elementsSelectable:V,onMove:n,onMoveStart:r,onMoveEnd:s,zoomOnScroll:z,zoomOnPinch:H,zoomOnDoubleClick:te,panOnScroll:X,panOnScrollSpeed:G,panOnScrollMode:q,panOnDrag:re,defaultViewport:O,translateExtent:L,minZoom:F,maxZoom:A,onSelectionContextMenu:y,preventScrolling:b,noDragClassName:Wt,noWheelClassName:$t,noPanClassName:Ye,disableKeyboardA11y:kt},I.createElement(PE,null,I.createElement(bE,{edgeTypes:R,onEdgeClick:l,onEdgeDoubleClick:u,onlyRenderVisibleElements:W,onEdgeContextMenu:Re,onEdgeMouseEnter:Ee,onEdgeMouseMove:Ue,onEdgeMouseLeave:he,onReconnect:ee,onReconnectStart:Ie,onReconnectEnd:ot,reconnectRadius:Vt,defaultMarkerColor:D,noPanClassName:Ye,elevateEdgesOnSelect:!!Yt,disableKeyboardA11y:kt,rfId:_},I.createElement(AE,{style:g,type:h,component:w,containerStyle:k})),I.createElement("div",{className:"react-flow__edgelabel-renderer"}),I.createElement(dE,{nodeTypes:U,onNodeClick:i,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:p,onNodeContextMenu:m,selectNodesOnDrag:E,onlyRenderVisibleElements:W,noPanClassName:Ye,noDragClassName:Wt,disableKeyboardA11y:kt,nodeOrigin:Ct,nodeExtent:S,rfId:_})))};vy.displayName="GraphView";var DE=v.memo(vy);const Tc=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Nn={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Tc,nodeExtent:Tc,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:hr.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:uN,isValidConnection:void 0},OE=()=>NS((e,t)=>({...Nn,setNodes:n=>{const{nodeInternals:r,nodeOrigin:s,elevateNodesOnSelect:o}=t();e({nodeInternals:dl(n,r,s,o)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(s=>({...r,...s}))})},setDefaultNodesAndEdges:(n,r)=>{const s=typeof n<"u",o=typeof r<"u",i=s?dl(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:o?r:[],hasDefaultNodes:s,hasDefaultEdges:o})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:s,fitViewOnInit:o,fitViewOnInitDone:i,fitViewOnInitOptions:l,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:p}=new window.DOMMatrixReadOnly(f.transform),m=n.reduce((x,j)=>{const h=s.get(j.id);if(h!=null&&h.hidden)s.set(h.id,{...h,[Ae]:{...h[Ae],handleBounds:void 0}});else if(h){const g=zu(j.nodeElement);!!(g.width&&g.height&&(h.width!==g.width||h.height!==g.height||j.forceUpdate))&&(s.set(h.id,{...h,[Ae]:{...h[Ae],handleBounds:{source:nh(".source",j.nodeElement,p,u),target:nh(".target",j.nodeElement,p,u)}},...g}),x.push({id:h.id,type:"dimensions",dimensions:g}))}return x},[]);sy(s,u);const y=i||o&&!i&&oy(t,{initial:!0,...l});e({nodeInternals:new Map(s),fitViewOnInitDone:y}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,s=!1)=>{const{triggerNodeChanges:o}=t(),i=n.map(l=>{const c={id:l.id,type:"position",dragging:s};return r&&(c.positionAbsolute=l.positionAbsolute,c.position=l.position),c});o(i)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:s,hasDefaultNodes:o,nodeOrigin:i,getNodes:l,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(o){const u=ay(n,l()),d=dl(u,s,i,c);e({nodeInternals:d})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:s,getNodes:o}=t();let i,l=null;r?i=n.map(c=>Tn(c,!0)):(i=Or(o(),n),l=Or(s,[])),ti({changedNodes:i,changedEdges:l,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:s,getNodes:o}=t();let i,l=null;r?i=n.map(c=>Tn(c,!0)):(i=Or(s,n),l=Or(o(),[])),ti({changedNodes:l,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:s,getNodes:o}=t(),i=n||o(),l=r||s,c=i.map(d=>(d.selected=!1,Tn(d.id,!1))),u=l.map(d=>Tn(d.id,!1));ti({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:s}=t();r==null||r.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:s}=t();r==null||r.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),o=r().filter(l=>l.selected).map(l=>Tn(l.id,!1)),i=n.filter(l=>l.selected).map(l=>Tn(l.id,!1));ti({changedNodes:o,changedEdges:i,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(s=>{s.positionAbsolute=Fu(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:s,height:o,d3Zoom:i,d3Selection:l,translateExtent:c}=t();if(!i||!l||!n.x&&!n.y)return!1;const u=pn.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),d=[[0,0],[s,o]],f=i==null?void 0:i.constrain()(u,d,c);return i.transform(l,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Nn.connectionNodeId,connectionHandleId:Nn.connectionHandleId,connectionHandleType:Nn.connectionHandleType,connectionStatus:Nn.connectionStatus,connectionStartHandle:Nn.connectionStartHandle,connectionEndHandle:Nn.connectionEndHandle}),reset:()=>e({...Nn})}),Object.is),xy=({children:e})=>{const t=v.useRef(null);return t.current||(t.current=OE()),I.createElement(rN,{value:t.current},e)};xy.displayName="ReactFlowProvider";const wy=({children:e})=>v.useContext(ja)?I.createElement(I.Fragment,null,e):I.createElement(xy,null,e);wy.displayName="ReactFlowWrapper";const RE={input:Qg,default:_c,output:qg,group:Yu},IE={default:ea,straight:Uu,step:Hu,smoothstep:Na,simplebezier:Bu},zE=[0,0],FE=[15,15],BE={x:0,y:0,zoom:1},HE={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Sy=v.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:s,nodeTypes:o=RE,edgeTypes:i=IE,onNodeClick:l,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onConnect:m,onConnectStart:y,onConnectEnd:x,onClickConnectStart:j,onClickConnectEnd:h,onNodeMouseEnter:g,onNodeMouseMove:w,onNodeMouseLeave:k,onNodeContextMenu:C,onNodeDoubleClick:N,onNodeDragStart:T,onNodeDrag:P,onNodeDragStop:$,onNodesDelete:M,onEdgesDelete:B,onSelectionChange:W,onSelectionDragStart:V,onSelectionDrag:E,onSelectionDragStop:O,onSelectionContextMenu:L,onSelectionStart:F,onSelectionEnd:A,connectionMode:b=hr.Strict,connectionLineType:D=Mn.Bezier,connectionLineStyle:z,connectionLineComponent:H,connectionLineContainerStyle:X,deleteKeyCode:G="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:te=!1,selectionMode:re=mo.Full,panActivationKeyCode:ue="Space",multiSelectionKeyCode:se=Zi()?"Meta":"Control",zoomActivationKeyCode:J=Zi()?"Meta":"Control",snapToGrid:ve=!1,snapGrid:we=FE,onlyRenderVisibleElements:Me=!1,selectNodesOnDrag:Re=!0,nodesDraggable:Ee,nodesConnectable:Ue,nodesFocusable:he,nodeOrigin:ee=zE,edgesFocusable:Ie,edgesUpdatable:ot,elementsSelectable:Vt,defaultViewport:Wt=BE,minZoom:$t=.5,maxZoom:Ye=2,translateExtent:Yt=Tc,preventScrolling:kt=!0,nodeExtent:Ct,defaultMarkerColor:S="#b1b1b7",zoomOnScroll:_=!0,zoomOnPinch:U=!0,panOnScroll:R=!1,panOnScrollSpeed:K=.5,panOnScrollMode:de=nr.Free,zoomOnDoubleClick:ae=!0,panOnDrag:oe=!0,onPaneClick:ge,onPaneMouseEnter:xe,onPaneMouseMove:fe,onPaneMouseLeave:pt,onPaneScroll:ie,onPaneContextMenu:us,children:De,onEdgeContextMenu:ke,onEdgeDoubleClick:ds,onEdgeMouseEnter:_y,onEdgeMouseMove:by,onEdgeMouseLeave:Ty,onEdgeUpdate:Py,onEdgeUpdateStart:Ly,onEdgeUpdateEnd:My,onReconnect:$y,onReconnectStart:Ay,onReconnectEnd:Dy,reconnectRadius:Oy=10,edgeUpdaterRadius:Ry=10,onNodesChange:Iy,onEdgesChange:zy,noDragClassName:Fy="nodrag",noWheelClassName:By="nowheel",noPanClassName:Xu="nopan",fitView:Hy=!1,fitViewOptions:Uy,connectOnClick:Vy=!0,attributionPosition:Wy,proOptions:Yy,defaultEdgeOptions:Ky,elevateNodesOnSelect:Gy=!0,elevateEdgesOnSelect:Xy=!1,disableKeyboardA11y:Ju=!1,autoPanOnConnect:Jy=!0,autoPanOnNodeDrag:Qy=!0,connectionRadius:Zy=20,isValidConnection:qy,onError:ev,style:tv,id:Qu,nodeDragThreshold:nv,...rv},sv)=>{const _a=Qu||"1";return I.createElement("div",{...rv,style:{...tv,...HE},ref:sv,className:et(["react-flow",s]),"data-testid":"rf__wrapper",id:Qu},I.createElement(wy,null,I.createElement(DE,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:p,onNodeClick:l,onEdgeClick:c,onNodeMouseEnter:g,onNodeMouseMove:w,onNodeMouseLeave:k,onNodeContextMenu:C,onNodeDoubleClick:N,nodeTypes:o,edgeTypes:i,connectionLineType:D,connectionLineStyle:z,connectionLineComponent:H,connectionLineContainerStyle:X,selectionKeyCode:q,selectionOnDrag:te,selectionMode:re,deleteKeyCode:G,multiSelectionKeyCode:se,panActivationKeyCode:ue,zoomActivationKeyCode:J,onlyRenderVisibleElements:Me,selectNodesOnDrag:Re,defaultViewport:Wt,translateExtent:Yt,minZoom:$t,maxZoom:Ye,preventScrolling:kt,zoomOnScroll:_,zoomOnPinch:U,zoomOnDoubleClick:ae,panOnScroll:R,panOnScrollSpeed:K,panOnScrollMode:de,panOnDrag:oe,onPaneClick:ge,onPaneMouseEnter:xe,onPaneMouseMove:fe,onPaneMouseLeave:pt,onPaneScroll:ie,onPaneContextMenu:us,onSelectionContextMenu:L,onSelectionStart:F,onSelectionEnd:A,onEdgeContextMenu:ke,onEdgeDoubleClick:ds,onEdgeMouseEnter:_y,onEdgeMouseMove:by,onEdgeMouseLeave:Ty,onReconnect:$y??Py,onReconnectStart:Ay??Ly,onReconnectEnd:Dy??My,reconnectRadius:Oy??Ry,defaultMarkerColor:S,noDragClassName:Fy,noWheelClassName:By,noPanClassName:Xu,elevateEdgesOnSelect:Xy,rfId:_a,disableKeyboardA11y:Ju,nodeOrigin:ee,nodeExtent:Ct}),I.createElement(MN,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:y,onConnectEnd:x,onClickConnectStart:j,onClickConnectEnd:h,nodesDraggable:Ee,nodesConnectable:Ue,nodesFocusable:he,edgesFocusable:Ie,edgesUpdatable:ot,elementsSelectable:Vt,elevateNodesOnSelect:Gy,minZoom:$t,maxZoom:Ye,nodeExtent:Ct,onNodesChange:Iy,onEdgesChange:zy,snapToGrid:ve,snapGrid:we,connectionMode:b,translateExtent:Yt,connectOnClick:Vy,defaultEdgeOptions:Ky,fitView:Hy,fitViewOptions:Uy,onNodesDelete:M,onEdgesDelete:B,onNodeDragStart:T,onNodeDrag:P,onNodeDragStop:$,onSelectionDrag:E,onSelectionDragStart:V,onSelectionDragStop:O,noPanClassName:Xu,nodeOrigin:ee,rfId:_a,autoPanOnConnect:Jy,autoPanOnNodeDrag:Qy,onError:ev,connectionRadius:Zy,isValidConnection:qy,nodeDragThreshold:nv}),I.createElement(PN,{onSelectionChange:W}),De,I.createElement(oN,{proOptions:Yy,position:Wy}),I.createElement(RN,{rfId:_a,disableKeyboardA11y:Ju})))});Sy.displayName="ReactFlow";function ky(e){return t=>{const[n,r]=v.useState(t),s=v.useCallback(o=>r(i=>e(o,i)),[]);return[n,r,s]}}const UE=ky(ay),VE=ky(QN);function Cy(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const jy=({id:e,x:t,y:n,width:r,height:s,style:o,color:i,strokeColor:l,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:p,selected:m})=>{const{background:y,backgroundColor:x}=o||{},j=i||y||x;return I.createElement("rect",{className:et(["react-flow__minimap-node",{selected:m},u]),x:t,y:n,rx:d,ry:d,width:r,height:s,fill:j,stroke:l,strokeWidth:c,shapeRendering:f,onClick:p?h=>p(h,e):void 0})};jy.displayName="MiniMapNode";var WE=v.memo(jy);const YE=e=>e.nodeOrigin,KE=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),ml=e=>e instanceof Function?e:()=>e;function GE({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:s=2,nodeComponent:o=WE,onClick:i}){const l=Ne(KE,Cy),c=Ne(YE),u=ml(t),d=ml(e),f=ml(n),p=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return I.createElement(I.Fragment,null,l.map(m=>{const{x:y,y:x}=ir(m,c).positionAbsolute;return I.createElement(o,{key:m.id,x:y,y:x,width:m.width,height:m.height,style:m.style,selected:m.selected,className:f(m),color:u(m),borderRadius:r,strokeColor:d(m),strokeWidth:s,shapeRendering:p,onClick:i,id:m.id})}))}var XE=v.memo(GE);const JE=200,QE=150,ZE=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?lN(Ea(t,e.nodeOrigin),n):n,rfId:e.rfId}},qE="react-flow__minimap-desc";function Ny({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:s="",nodeBorderRadius:o=5,nodeStrokeWidth:i=2,nodeComponent:l,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:p,onNodeClick:m,pannable:y=!1,zoomable:x=!1,ariaLabel:j="React Flow mini map",inversePan:h=!1,zoomStep:g=10,offsetScale:w=5}){const k=He(),C=v.useRef(null),{boundingRect:N,viewBB:T,rfId:P}=Ne(ZE,Cy),$=(e==null?void 0:e.width)??JE,M=(e==null?void 0:e.height)??QE,B=N.width/$,W=N.height/M,V=Math.max(B,W),E=V*$,O=V*M,L=w*V,F=N.x-(E-N.width)/2-L,A=N.y-(O-N.height)/2-L,b=E+L*2,D=O+L*2,z=`${qE}-${P}`,H=v.useRef(0);H.current=V,v.useEffect(()=>{if(C.current){const q=_t(C.current),te=se=>{const{transform:J,d3Selection:ve,d3Zoom:we}=k.getState();if(se.sourceEvent.type!=="wheel"||!ve||!we)return;const Me=-se.sourceEvent.deltaY*(se.sourceEvent.deltaMode===1?.05:se.sourceEvent.deltaMode?1:.002)*g,Re=J[2]*Math.pow(2,Me);we.scaleTo(ve,Re)},re=se=>{const{transform:J,d3Selection:ve,d3Zoom:we,translateExtent:Me,width:Re,height:Ee}=k.getState();if(se.sourceEvent.type!=="mousemove"||!ve||!we)return;const Ue=H.current*Math.max(1,J[2])*(h?-1:1),he={x:J[0]-se.sourceEvent.movementX*Ue,y:J[1]-se.sourceEvent.movementY*Ue},ee=[[0,0],[Re,Ee]],Ie=pn.translate(he.x,he.y).scale(J[2]),ot=we.constrain()(Ie,ee,Me);we.transform(ve,ot)},ue=bg().on("zoom",y?re:null).on("zoom.wheel",x?te:null);return q.call(ue),()=>{q.on("zoom",null)}}},[y,x,h,g]);const X=p?q=>{const te=Rt(q);p(q,{x:te[0],y:te[1]})}:void 0,G=m?(q,te)=>{const re=k.getState().nodeInternals.get(te);m(q,re)}:void 0;return I.createElement(Iu,{position:f,style:e,className:et(["react-flow__minimap",t]),"data-testid":"rf__minimap"},I.createElement("svg",{width:$,height:M,viewBox:`${F} ${A} ${b} ${D}`,role:"img","aria-labelledby":z,ref:C,onClick:X},j&&I.createElement("title",{id:z},j),I.createElement(XE,{onClick:G,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:o,nodeClassName:s,nodeStrokeWidth:i,nodeComponent:l}),I.createElement("path",{className:"react-flow__minimap-mask",d:`M${F-L},${A-L}h${b+L*2}v${D+L*2}h${-b-L*2}z
        M${T.x},${T.y}h${T.width}v${T.height}h${-T.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}Ny.displayName="MiniMap";var e_=v.memo(Ny);function t_(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}function n_(){return I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},I.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function r_(){return I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},I.createElement("path",{d:"M0 0h32v4.2H0z"}))}function s_(){return I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},I.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function o_(){return I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},I.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function i_(){return I.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},I.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Ms=({children:e,className:t,...n})=>I.createElement("button",{type:"button",className:et(["react-flow__controls-button",t]),...n},e);Ms.displayName="ControlButton";const a_=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Ey=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:s,onZoomIn:o,onZoomOut:i,onFitView:l,onInteractiveChange:c,className:u,children:d,position:f="bottom-left"})=>{const p=He(),[m,y]=v.useState(!1),{isInteractive:x,minZoomReached:j,maxZoomReached:h}=Ne(a_,t_),{zoomIn:g,zoomOut:w,fitView:k}=Ku();if(v.useEffect(()=>{y(!0)},[]),!m)return null;const C=()=>{g(),o==null||o()},N=()=>{w(),i==null||i()},T=()=>{k(s),l==null||l()},P=()=>{p.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),c==null||c(!x)};return I.createElement(Iu,{className:et(["react-flow__controls",u]),position:f,style:e,"data-testid":"rf__controls"},t&&I.createElement(I.Fragment,null,I.createElement(Ms,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:h},I.createElement(n_,null)),I.createElement(Ms,{onClick:N,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:j},I.createElement(r_,null))),n&&I.createElement(Ms,{className:"react-flow__controls-fitview",onClick:T,title:"fit view","aria-label":"fit view"},I.createElement(s_,null)),r&&I.createElement(Ms,{className:"react-flow__controls-interactive",onClick:P,title:"toggle interactivity","aria-label":"toggle interactivity"},x?I.createElement(i_,null):I.createElement(o_,null)),d)};Ey.displayName="Controls";var l_=v.memo(Ey);const $s={text_block:{inputs:[],outputs:["output"],label:"Text Block"},variables_placeholders_block:{inputs:[],outputs:["output"],label:"Variables/Placeholders Block"},constructor_block:{inputs:["input1","input2"],outputs:["output"],label:"Constructor Block"},chat_history_block:{inputs:[],outputs:["output"],label:"Chat History Block"},character_card_block:{inputs:[],outputs:["output"],label:"Character Card Block"},character_current:{inputs:[],outputs:["character","character_id"],label:"Character: Current"},chat_history:{inputs:["messages"],outputs:["chathistory"],label:"Chat: History"},variables_substitution:{inputs:["template_text","variables_map"],outputs:["processed_text"],label:"Variables: Substitution"},template_text_formatter:{inputs:["input1","input2","input3","input4","input5"],outputs:["formatted_text"],label:"Template: Text Formatter"}},c_={text_block:{connectorTypes:{inputs:{},outputs:{output:"string|number"}},configuration:[{name:"Text Content",type:"text",description:"The text or number to output"},{name:"Output Type",type:"select",description:"Whether to output as string or number"}],metadata:[{label:"Block Type",value:"Text Output Block",description:"Outputs configured text or numerical data"},{label:"Inputs",value:"None",description:"No input connections required"}]},variables_placeholders_block:{connectorTypes:{inputs:{},outputs:{output:"string"}},configuration:[{name:"Variable/Placeholder Selection",type:"select",description:"Choose from available variables and placeholders"}],metadata:[{label:"Block Type",value:"Variables/Placeholders Block",description:"Outputs selected variable or placeholder value"},{label:"Data Source",value:"Settings  Prompts  Variables + Placeholders",description:"Dynamic dropdown populated from application settings"}]},constructor_block:{connectorTypes:{inputs:{input1:"string",input2:"string"},outputs:{output:"string"}},configuration:[{name:"Separator Text",type:"text",description:"Text to place between input1 and input2"}],metadata:[{label:"Block Type",value:"Constructor Block",description:"Combines two inputs with a separator"},{label:"Operation",value:"input1 + separator + input2",description:"Concatenation with configurable separator"}]},chat_history_block:{connectorTypes:{inputs:{},outputs:{output:"string"}},configuration:[{name:"Message Type Filter",type:"select",description:"Filter by User messages, AI messages, or All messages"},{name:"Message Count",type:"number",description:"Number of messages to include (blank = entire history)"}],metadata:[{label:"Block Type",value:"Chat History Block",description:"Outputs filtered chat history"},{label:"Data Source",value:"Active Chat History",description:"Accesses current conversation messages"}]},character_card_block:{connectorTypes:{inputs:{},outputs:{output:"string"}},configuration:[{name:"Character Selection",type:"select",description:'Choose a character (defaults to "Current Character")'},{name:"Card Field",type:"select",description:"Select which part of the character card to output"}],metadata:[{label:"Block Type",value:"Character Card Block",description:"Outputs selected character card data"},{label:"Data Source",value:"Character Database",description:"Accesses loaded character configurations"}]},variables_substitution:{connectorTypes:{inputs:{template_text:"string",variables_map:"JSON"},outputs:{processed_text:"string"}},configuration:[{name:"Variable Syntax",type:"select",description:"{{var}} or ${var} substitution"},{name:"Error Handling",type:"select",description:"How to handle missing variables"}],metadata:[{label:"Substitution Type",value:"Key/Value Replacement",description:"Replaces markers with data values"},{label:"Supported Formats",value:"JSON Map/Object",description:"Variables input structure"}]}},on=({data:e})=>{const t=$s[e.type]||{inputs:[],outputs:[],label:"Unknown Block"},n=Math.max(t.inputs.length,t.outputs.length,1),r=80+n*20,s=(o,i)=>{const c=(r-40)/Math.max(i-1,1);return 20+o*c};return a.jsxs("div",{className:`circuit-block circuit-${e.type}`,style:{height:r,minHeight:100},children:[t.inputs.map((o,i)=>a.jsx(ss,{id:`input-${o}`,type:"target",position:ne.Left,className:"handle-input",style:{top:s(i,t.inputs.length)-6},title:`Input: ${o}`},`input-${o}`)),t.outputs.map((o,i)=>a.jsx(ss,{id:`output-${o}`,type:"source",position:ne.Right,className:"handle-output",style:{top:s(i,t.outputs.length)-6},title:`Output: ${o}`},`output-${o}`)),a.jsxs("div",{className:"block-content-flex",children:[a.jsx("span",{className:"block-icon-large",children:e.icon}),a.jsx("span",{className:"block-label",children:t.label}),a.jsxs("span",{className:"block-connector-count",children:[n," connections"]})]})]})},u_=e=>({basic_text:"Outputs whatever string or number is entered into this block's settings. Can be configured to accept text or numbers only.",text_block:"Outputs configured text or numerical data. Can be configured to output as string or number.",variables_placeholders_block:"Outputs selected variable or placeholder value from application settings.",constructor_block:"Combines two inputs with a configurable separator text.",chat_history_block:"Outputs filtered chat history with configurable message type and count.",character_card_block:"Outputs selected character card data with configurable field selection.",character_current:"Outputs the currently active character's name and numerical character ID.",chat_history:"Outputs chat history. With messages input, returns the x most recent messages where x is the input value.",variables_substitution:"Replaces {{variable}} placeholders in template_text with values from variables_map.",template_text_formatter:"Combines up to 5 input strings using a custom template format."})[e]||"No description available.",d_=(e,t)=>{const n=e.data.type,r=e.data;switch(console.log("renderBlockSettings called for node:",e.id,"data:",r),n){case"text_block":return a.jsxs("div",{className:"block-settings-content",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"text-block-input",children:"Text Content:"}),a.jsx("input",{id:"text-block-input",type:"text",value:r.text||"",onChange:o=>{console.log("Text input changed:",o.target.value),t(e.id,{text:o.target.value})},placeholder:"Enter text to output..."})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"text-block-mode",children:"Output Type:"}),a.jsxs("select",{id:"text-block-mode",value:r.outputMode||"string",onChange:o=>{t(e.id,{outputMode:o.target.value})},children:[a.jsx("option",{value:"string",children:"String (Text)"}),a.jsx("option",{value:"number",children:"Number Only"})]})]})]});case"constructor_block":return a.jsx("div",{className:"block-settings-content",children:a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"constructor-separator",children:"Separator Text:"}),a.jsx("input",{id:"constructor-separator",type:"text",value:r.separator||"",onChange:o=>{t(e.id,{separator:o.target.value})},placeholder:"Enter separator (e.g., ' - ', ', ', etc.)"})]})});case"chat_history_block":return a.jsxs("div",{className:"block-settings-content",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"chat-filter",children:"Message Type:"}),a.jsxs("select",{id:"chat-filter",value:r.messageFilter||"all",onChange:o=>{t(e.id,{messageFilter:o.target.value})},children:[a.jsx("option",{value:"all",children:"All Messages"}),a.jsx("option",{value:"user",children:"User Messages Only"}),a.jsx("option",{value:"ai",children:"AI Messages Only"})]})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"chat-count",children:"Message Count:"}),a.jsx("input",{id:"chat-count",type:"number",min:"1",value:r.messageCount||"",onChange:o=>{t(e.id,{messageCount:o.target.value})},placeholder:"Leave blank for entire history"})]})]});case"character_card_block":const{characters:s}=Pu.getState();return a.jsxs("div",{className:"block-settings-content",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"character-select",children:"Character:"}),a.jsxs("select",{id:"character-select",value:r.selectedCharacter||"current",onChange:o=>{t(e.id,{selectedCharacter:o.target.value})},children:[a.jsx("option",{value:"current",children:"Current Character"}),s.map(o=>a.jsx("option",{value:o.id,children:o.name||`Character ${o.id}`},o.id))]})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"card-field",children:"Card Field:"}),a.jsxs("select",{id:"card-field",value:r.cardField||"full",onChange:o=>{t(e.id,{cardField:o.target.value})},children:[a.jsx("option",{value:"full",children:"Full Character Card"}),a.jsx("option",{value:"name",children:"Name Only"}),a.jsx("option",{value:"description",children:"Description Only"}),a.jsx("option",{value:"personality",children:"Personality Only"}),a.jsx("option",{value:"scenario",children:"Scenario Only"})]})]})]});case"basic_text":return a.jsxs("div",{className:"block-settings-content",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"basic-text-input",children:"Text Content:"}),a.jsx("input",{id:"basic-text-input",type:"text",value:r.text||"",onChange:o=>{console.log("Text input changed:",o.target.value),t(e.id,{text:o.target.value})},placeholder:"Enter text to output..."})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"basic-text-mode",children:"Output Type:"}),a.jsxs("select",{id:"basic-text-mode",value:r.outputMode||"string",onChange:o=>{t(e.id,{outputMode:o.target.value})},children:[a.jsx("option",{value:"string",children:"String (Text)"}),a.jsx("option",{value:"number",children:"Number Only"})]})]})]});case"variables_substitution":return a.jsxs("div",{className:"block-settings-content",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"variable-syntax",children:"Variable Syntax:"}),a.jsxs("select",{id:"variable-syntax",value:r.variableSyntax||"{{var}}",onChange:o=>{t(e.id,{variableSyntax:o.target.value})},children:[a.jsxs("option",{value:"{{var}}",children:["{{var}}"," style"]}),a.jsxs("option",{value:"${var}",children:["${var}"," style"]})]})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"error-handling",children:"Error Handling:"}),a.jsxs("select",{id:"error-handling",value:r.errorHandling||"keep_placeholder",onChange:o=>{t(e.id,{errorHandling:o.target.value})},children:[a.jsx("option",{value:"keep_placeholder",children:"Keep placeholder"}),a.jsx("option",{value:"replace_empty",children:"Replace with empty string"}),a.jsx("option",{value:"throw_error",children:"Throw error"})]})]})]});case"template_text_formatter":return a.jsxs("div",{className:"block-settings-content",children:[a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"template-format",children:"Template Format:"}),a.jsx("textarea",{id:"template-format",value:r.templateFormat||"",onChange:o=>{t(e.id,{templateFormat:o.target.value})},placeholder:"Use {input1}, {input2}, etc. for placeholders",rows:4})]}),a.jsxs("div",{className:"setting-item",children:[a.jsx("label",{htmlFor:"case-sensitivity",children:"Case Sensitivity:"}),a.jsxs("select",{id:"case-sensitivity",value:r.caseSensitive||"false",onChange:o=>{t(e.id,{caseSensitive:o.target.value})},children:[a.jsx("option",{value:"false",children:"Case Insensitive"}),a.jsx("option",{value:"true",children:"Case Sensitive"})]})]})]});default:return a.jsx("div",{className:"no-settings",children:"No settings available for this block type."})}},f_={basic_text:on,text_block:on,variables_placeholders_block:on,constructor_block:on,chat_history_block:on,character_current:on,character_card_block:on,variables_substitution:on,template_text_formatter:on},h_=()=>{const e=Ur(),{userPersona:t,providers:n,activeProvider:r,loadConfig:s}=Gm(),{characters:o,loadCharacters:i,lorebooks:l,findCharacterById:c}=Pu(),{loreEntries:u,selectedLorebook:d,selectLorebook:f,fetchLorebooks:p,refreshLoreEntries:m}=Lu();v.useState(!1);const{circuits:y,current:x,fetchCircuits:j,saveCircuit:h,executeCircuit:g,executionResult:w,isExecuting:k}=Ur(),[C,N]=v.useState(!1),[T,P]=v.useState({name:"",description:""}),[$,M]=v.useState(!1),[B,W]=v.useState([]),[V,E]=v.useState({}),[O,L]=v.useState({}),[F,A]=v.useState({});v.useState({});const[b,D]=v.useState(null),[z,H]=v.useState(!1),[X,G,q]=UE([]),[te,re,ue]=VE([]),se=v.useRef(null),[J,ve]=v.useState(null),[we,Me]=v.useState(400),[Re,Ee]=v.useState(0),Ue=v.useCallback(()=>{const S=window.innerHeight*.64;return Math.max(S,300)},[]);v.useEffect(()=>{const S=()=>Me(Ue());S();const _=()=>S();return window.addEventListener("resize",_),()=>window.removeEventListener("resize",_)},[Ue]),v.useEffect(()=>{j().catch(S=>{console.error("Failed to fetch circuits:",S)})},[j]);const he=v.useCallback(()=>{J&&(G(S=>S.filter(_=>_.id!==J.id)),re(S=>S.filter(_=>_.source!==J.id&&_.target!==J.id)),ve(null))},[J,G,re]);v.useEffect(()=>{e.current&&(G(e.current.data.nodes||[]),re(e.current.data.edges||[]),ve(null))},[e.current,G,re,ve]),v.useEffect(()=>{if(J){const S=X.find(_=>_.id===J.id);S&&S.data!==J.data&&(console.log("Updating selectedNode to match current node data"),ve(S))}},[X,J,ve]),v.useEffect(()=>{(async()=>{if(!z)try{L(_=>({..._,config:!0,data:!0,lorebook:!0})),await s(),await Promise.all([i(),p()]);try{const _=await fetch("/backend/prompts.json");if(_.ok){const U=await _.json();D(U)}}catch(_){console.warn("Failed to load prompts.json:",_),A(U=>({...U,prompts:"Failed to load variables"}))}H(!0),L(_=>({config:!1,data:!1,lorebook:!1}))}catch(_){console.error("Failed to initialize live data:",_),A(U=>({...U,init:"Failed to load application data"})),L(U=>({config:!1,data:!1,lorebook:!1}))}})()},[z,s,i,p]);const ee=v.useCallback(async S=>{try{switch(L(_=>({..._,[S||"all"]:!0})),S){case"persona":case"format_persona":await s();break;case"tools":case"format_tools":await s();break;case"lore":case"format_lore_injection":await p(),d&&await m();break;case"character":await i();break;case"variables":case"variables_substitution":try{const _=await fetch("/backend/prompts.json");if(_.ok){const U=await _.json();D(U)}}catch{A(U=>({...U,prompts:"Failed to reload variables"}))}break;default:await s(),await Promise.all([i(),p()]),d&&await m();break}L(_=>({..._,[S||"all"]:!1}))}catch(_){console.error(`Failed to refresh ${S||"all"} data:`,_),A(U=>({...U,[S||"all"]:`Failed to refresh ${S||"all"} data`})),L(U=>({...U,[S||"all"]:!1}))}},[s,i,p,m,d]);v.useEffect(()=>{const S=_=>{_.key==="Delete"&&J&&(_.preventDefault(),he())};return document.addEventListener("keydown",S),()=>document.removeEventListener("keydown",S)},[e.current,G,re,ve]);const Ie=v.useCallback(S=>re(_=>Fg(S,_)),[re]),ot=v.useCallback(S=>{var oe;S.preventDefault();const _=S.dataTransfer.getData("nodeType");if(!_)return;const U=(oe=se.current)==null?void 0:oe.getBoundingClientRect();if(!U)return;const R=100,K={x:S.clientX-U.left-R/2,y:S.clientY-U.top-R/2},de=$s[_]||{inputs:[],outputs:[],label:"Unknown Block"},ae={id:`${_}-${Date.now()}`,type:_,position:K,data:{label:de.label,type:_,icon:Ye(_),inputs:de.inputs,outputs:de.outputs}};G(ge=>ge.concat(ae))},[G]),Vt=v.useCallback(S=>S.preventDefault(),[]),Wt=v.useCallback((S,_)=>ve(_),[]),$t=v.useCallback((S,_)=>{console.log("updateNodeData called:",S,_),G(U=>U.map(R=>R.id===S?(console.log("Updating node:",R.id,"with:",_),{...R,data:{...R.data,..._}}):R))},[G]),Ye=S=>({basic_text:"",text_block:"",variables_placeholders_block:"",constructor_block:"",chat_history_block:"",character_card_block:"",character_current:"",chat_history:"",variables_substitution:"",template_text_formatter:""})[S]||"",Yt=()=>{const S=e.current;S&&h({...S,data:{nodes:X,edges:te}}).catch(_=>console.error("Failed to save:",_))},kt=async()=>{if(T.name.trim())try{const S={name:T.name.trim(),description:T.description.trim(),data:{nodes:[],edges:[]}};await h(S),P({name:"",description:""}),N(!1)}catch(S){console.error("Failed to create circuit:",S)}},Ct=async()=>{if(x)try{const S={user_persona:t,current_character_name:"Test Character",current_character_id:1,chat_history:[{role:"user",content:"Hello"},{role:"assistant",content:"Hi there!"}],user_message:"Test message",ai_response:"Test response"},_=await g(x.id,S);W(_.logs),E(_.outputs),M(!0)}catch(S){console.error("Failed to execute circuit:",S)}};return a.jsxs("div",{className:"circuit-editor",children:[a.jsxs("div",{className:"toolbar panel",children:[a.jsx("span",{className:"title",children:"Circuits2"}),a.jsxs("div",{className:"toolbar-actions",children:[a.jsx("button",{className:"secondary",onClick:()=>N(!0),title:"Create new circuit",children:"+ New Circuit"}),a.jsx("button",{className:"secondary",onClick:Yt,disabled:!e.current,title:"Save circuit",children:"Save Circuit"}),a.jsx("button",{className:"primary",onClick:Ct,disabled:!e.current||k,title:"Execute circuit",children:k?" Executing...":" Execute Circuit"})]})]}),C&&a.jsx("div",{className:"create-form-overlay",children:a.jsxs("div",{className:"create-form-modal panel",children:[a.jsx("h3",{children:"Create New Circuit"}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"circuit-name",children:"Name:"}),a.jsx("input",{id:"circuit-name",type:"text",value:T.name,onChange:S=>P(_=>({..._,name:S.target.value})),placeholder:"Enter circuit name..."})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{htmlFor:"circuit-description",children:"Description (optional):"}),a.jsx("textarea",{id:"circuit-description",value:T.description,onChange:S=>P(_=>({..._,description:S.target.value})),placeholder:"Enter circuit description...",rows:3})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{onClick:kt,disabled:!T.name.trim(),children:"Create Circuit"}),a.jsx("button",{className:"secondary",onClick:()=>{N(!1),P({name:"",description:""})},children:"Cancel"})]})]})}),a.jsxs("div",{className:"editor-body",children:[a.jsxs("aside",{className:"block-palette panel",children:[a.jsx("h4",{children:"Block Palette"}),a.jsxs("div",{className:"palette-items",children:[a.jsx("div",{className:"palette-section",children:a.jsx("h5",{children:"Basic Blocks"})}),["text_block","constructor_block"].map(S=>a.jsxs("div",{className:`palette-item circuit-${S}`,draggable:!0,onDragStart:_=>_.dataTransfer.setData("nodeType",S),children:[a.jsx("span",{className:"block-icon",children:Ye(S)}),a.jsx("span",{children:$s[S].label})]},S)),a.jsx("div",{className:"palette-section",children:a.jsx("h5",{children:"Data Sources"})}),["character_current","chat_history_block","character_card_block"].map(S=>a.jsxs("div",{className:`palette-item circuit-${S}`,draggable:!0,onDragStart:_=>_.dataTransfer.setData("nodeType",S),children:[a.jsx("span",{className:"block-icon",children:Ye(S)}),a.jsx("span",{children:$s[S].label})]},S)),a.jsx("div",{className:"palette-section",children:a.jsx("h5",{children:"Variables & Templates"})}),["variables_placeholders_block","variables_substitution","template_text_formatter"].map(S=>a.jsxs("div",{className:`palette-item circuit-${S}`,draggable:!0,onDragStart:_=>_.dataTransfer.setData("nodeType",S),children:[a.jsx("span",{className:"block-icon",children:Ye(S)}),a.jsx("span",{children:$s[S].label})]},S))]})]}),a.jsxs("main",{className:"canvas panel",children:[a.jsxs("div",{className:"canvas-header",children:[!x&&y.length>0&&a.jsx("span",{className:"muted",children:"Select a circuit to view/edit"}),y.length===0&&a.jsx("span",{className:"muted",children:"No circuits available. Create your first circuit!"}),x&&a.jsx("div",{className:"execution-controls",children:a.jsx("button",{className:"secondary",onClick:()=>M(!$),title:"Toggle execution results",children:$?" Hide Results":" Show Results"})})]}),y.length>0&&!x&&a.jsx("div",{className:"circuits-list",children:y.map(S=>a.jsxs("div",{className:"circuit-item",onClick:()=>Ur.setState({current:S}),children:[a.jsx("span",{className:"circuit-name",children:S.name}),S.description&&a.jsx("span",{className:"circuit-description",children:S.description})]},S.id||S.name))}),x&&a.jsxs("div",{className:"circuit-canvas",children:[a.jsx("h3",{children:x.name}),a.jsx("div",{style:{height:"100%",position:"relative"},children:a.jsx("div",{ref:se,style:{height:`${we}px`},children:a.jsxs(Sy,{nodes:X,edges:te,onNodesChange:q,onEdgesChange:ue,onConnect:Ie,onDrop:ot,onDragOver:Vt,onNodeClick:Wt,nodeTypes:f_,fitView:!0,children:[a.jsx(l_,{}),a.jsx(e_,{})]})})})]}),$&&x&&a.jsxs("div",{className:"execution-results panel",children:[a.jsx("h4",{children:" Execution Results"}),a.jsxs("div",{className:"results-content",children:[Object.keys(V).length>0&&a.jsxs("div",{className:"results-section",children:[a.jsx("h5",{children:" Outputs"}),a.jsx("div",{className:"outputs-list",children:Object.entries(V).map(([S,_])=>a.jsxs("div",{className:"output-item",children:[a.jsxs("strong",{children:[S,":"]}),a.jsx("pre",{className:"output-value",children:JSON.stringify(_,null,2)})]},S))})]}),a.jsxs("div",{className:"results-section",children:[a.jsx("h5",{children:" Execution Logs"}),a.jsx("div",{className:"logs-container",children:B.length>0?B.map((S,_)=>a.jsx("div",{className:"log-entry",children:a.jsx("small",{children:S})},_)):a.jsx("div",{className:"no-logs",children:a.jsx("small",{children:"No execution logs available"})})})]}),w&&a.jsxs("div",{className:"results-section",children:[a.jsx("h5",{children:" Execution Info"}),a.jsxs("div",{className:"execution-info",children:[a.jsxs("div",{className:"info-item",children:[a.jsx("strong",{children:"ID:"})," ",w.execution_id]}),a.jsxs("div",{className:"info-item",children:[a.jsx("strong",{children:"Status:"}),a.jsx("span",{className:w.success?"status-success":"status-error",children:w.success?" Success":" Failed"})]}),w.errors&&w.errors.length>0&&a.jsxs("div",{className:"info-item",children:[a.jsx("strong",{children:"Errors:"}),a.jsx("div",{className:"error-list",children:w.errors.map((S,_)=>a.jsx("div",{className:"error-item",children:S},_))})]})]})]})]})]})]}),a.jsxs("aside",{className:"properties panel",children:[a.jsx("h4",{children:"Properties"}),x?a.jsxs("div",{className:"properties-content",children:[J?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"properties-section block-description",children:[a.jsx("h5",{children:" Block Description"}),a.jsx("p",{className:"block-description-text",children:u_(J.data.type)})]}),a.jsxs("div",{className:"properties-section block-settings",children:[a.jsx("h5",{children:" Block Settings"}),d_(J,$t)]})]}):null,J?a.jsxs(a.Fragment,{children:[(()=>{var _,U;const S=c_[J.data.type];return S?a.jsxs(a.Fragment,{children:[(((_=S.connectorTypes)==null?void 0:_.inputs)||((U=S.connectorTypes)==null?void 0:U.outputs))&&a.jsxs("div",{className:"properties-section",children:[a.jsx("h5",{children:" Connector Details"}),S.connectorTypes.inputs&&Object.keys(S.connectorTypes.inputs).length>0&&a.jsxs("div",{className:"connector-group",children:[a.jsx("div",{className:"connector-header",children:a.jsx("strong",{children:" Inputs:"})}),Object.entries(S.connectorTypes.inputs).map(([R,K])=>a.jsxs("div",{className:"connector-item",title:`Input connector: ${R} (${K}) - Data flows into this connector`,children:[a.jsx("span",{className:"connector-name",children:R}),a.jsx("span",{className:"connector-type",children:K})]},R))]}),S.connectorTypes.outputs&&Object.keys(S.connectorTypes.outputs).length>0&&a.jsxs("div",{className:"connector-group",children:[a.jsx("div",{className:"connector-header",children:a.jsx("strong",{children:"Outputs:"})}),Object.entries(S.connectorTypes.outputs).map(([R,K])=>a.jsxs("div",{className:"connector-item",title:`Output connector: ${R} (${K}) - Data flows out from this connector`,children:[a.jsx("span",{className:"connector-name",children:R}),a.jsx("span",{className:"connector-type",children:K})]},R))]})]}),S.configuration&&S.configuration.length>0&&a.jsxs("div",{className:"properties-section",children:[a.jsx("h5",{children:" Configuration"}),S.configuration.map((R,K)=>a.jsxs("div",{className:"config-item",title:R.description||`${R.name} (${R.type})`,children:[a.jsxs("strong",{children:[R.name,":"]}),a.jsx("span",{className:"config-value",children:"[Not set]"}),a.jsxs("span",{className:"config-type",children:["(",R.type,")"]})]},K))]}),J.data&&Object.keys(J.data).length>2&&a.jsxs("div",{className:"properties-section",children:[a.jsx("h5",{children:" Current Values"}),Object.entries(J.data).map(([R,K])=>["label","type","icon","inputs","outputs"].includes(R)?null:a.jsxs("div",{className:"value-item",title:`Current value for ${R}`,children:[a.jsxs("strong",{children:[R,":"]}),a.jsx("span",{children:typeof K=="string"?`"${K}"`:JSON.stringify(K)})]},R))]}),S.metadata&&S.metadata.length>0&&a.jsxs("div",{className:"properties-section",children:[a.jsx("h5",{children:" Metadata"}),S.metadata.map((R,K)=>a.jsxs("div",{className:"metadata-item",title:R.description||R.label,children:[a.jsxs("strong",{children:[R.label,":"]}),a.jsx("span",{children:R.value})]},K))]}),(J.data.type==="format_persona"||J.data.type==="format_tools"||J.data.type==="format_lore_injection"||J.data.type.startsWith("char_")||J.data.type==="variables_substitution"||J.data.type==="lorebook_content"||J.data.type==="lore_active_display"||J.data.type==="lore_title_injection")&&a.jsxs("div",{className:"properties-section",children:[a.jsx("h5",{children:" Live Data"}),a.jsxs("div",{className:"live-data-section",children:[J.data.type==="format_persona"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"User Name:"}),a.jsx("span",{className:"data-display",children:(t==null?void 0:t.name)||a.jsx("span",{className:"data-empty",children:"Not set"})})]}),a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Description:"}),a.jsx("span",{className:"data-display",children:(t==null?void 0:t.description)||a.jsx("span",{className:"data-empty",children:"Not set"})})]})]}),J.data.type==="format_tools"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Active Provider:"}),a.jsx("span",{className:"data-display",children:r||"None"})]}),a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Available Providers:"}),a.jsxs("span",{className:"data-display",children:[Object.keys(n).length," configured"]})]}),a.jsx("div",{className:"live-data-details",children:Object.entries(n).map(([R,K])=>a.jsxs("div",{className:"provider-detail",children:[a.jsx("span",{className:"provider-name",children:R}),K.model&&a.jsxs("span",{className:"provider-model",children:["(",K.model,")"]})]},R))})]}),J.data.type==="format_lore_injection"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Active Lorebook:"}),a.jsx("span",{className:"data-display",children:(d==null?void 0:d.name)||a.jsx("span",{className:"data-empty",children:"None selected"})})]}),a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Lore Entries:"}),a.jsxs("span",{className:"data-display",children:[u.length," entries"]})]}),a.jsxs("div",{className:"live-data-details",style:{maxHeight:"120px",overflowY:"auto"},children:[u.slice(0,5).map(R=>{var K;return a.jsxs("div",{className:"lore-detail",children:[a.jsx("span",{className:"lore-title",children:R.title}),a.jsx("div",{className:"lore-keywords",children:((K=R.keywords)==null?void 0:K.length)>0&&a.jsxs("small",{children:["Keys: ",R.keywords.slice(0,3).join(", ")]})})]},R.id)}),u.length>5&&a.jsxs("div",{className:"lore-more",children:["... and ",u.length-5," more entries"]})]})]}),J.data.type.startsWith("char_")&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Loaded Characters:"}),a.jsxs("span",{className:"data-display",children:[o.length," characters"]})]}),a.jsxs("div",{className:"live-data-details live-data-details-scroll",children:[o.slice(0,5).map(R=>a.jsxs("div",{className:"character-detail",children:[a.jsx("span",{className:"character-name",children:R.name||"Unnamed"}),R.description&&a.jsx("div",{className:"character-desc",children:a.jsxs("small",{children:[R.description.slice(0,50),"..."]})})]},R.id)),o.length>5&&a.jsxs("div",{className:"character-more",children:["... and ",o.length-5," more characters"]})]})]}),J.data.type==="variables_substitution"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Variables Status:"}),a.jsx("span",{className:"data-display",children:b?"Loaded":a.jsx("span",{className:"data-empty",children:"Not loaded"})})]}),(b==null?void 0:b.variables)&&a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Variable Count:"}),a.jsx("span",{className:"data-display",children:Object.keys(b.variables).length})]}),(b==null?void 0:b.variables)&&a.jsx("div",{className:"live-data-details live-data-details-scroll",children:Object.entries(b.variables).slice(0,5).map(([R,K])=>a.jsxs("div",{className:"variable-detail",children:[a.jsxs("span",{className:"variable-key",children:[R,":"]}),a.jsxs("span",{className:"variable-value",children:[String(K).slice(0,30),"..."]})]},R))})]}),(J.data.type==="lorebook_content"||J.data.type==="lore_active_display"||J.data.type==="lore_title_injection")&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Lorebook:"}),a.jsx("span",{className:"data-display",children:(d==null?void 0:d.name)||a.jsx("span",{className:"data-empty",children:"None selected"})})]}),a.jsxs("div",{className:"live-data-item",children:[a.jsx("strong",{children:"Total Entries:"}),a.jsx("span",{className:"data-display",children:u.length})]}),!1,u.length>0&&a.jsx("div",{className:"live-data-details live-data-details-scroll",children:u.slice(0,3).map(R=>{var K;return a.jsxs("div",{className:"entry-detail",children:[a.jsxs("div",{className:"entry-header",children:[a.jsx("span",{className:"entry-title",children:R.title}),a.jsxs("small",{className:"entry-trigger",children:["T:",R.trigger]})]}),a.jsx("div",{className:"entry-keywords",children:((K=R.keywords)==null?void 0:K.length)>0&&a.jsxs("small",{children:["K: ",R.keywords.slice(0,2).join(", ")]})})]},R.id)})})]}),a.jsxs("div",{className:"live-data-actions live-data-actions-bordered",children:[a.jsxs("button",{className:"secondary refresh-btn refresh-btn-small",onClick:()=>ee(J.data.type),disabled:O[J.data.type],children:[O[J.data.type]?"":""," Refresh"]}),F[J.data.type]&&a.jsx("div",{className:"error-state",children:a.jsxs("small",{style:{color:"#e74c3c"},children:[" ",F[J.data.type]]})})]})]})]})]}):null})(),a.jsx("div",{className:"property-item",children:a.jsx("button",{className:"secondary delete-btn delete-btn-full",onClick:he,title:"Delete selected node (or press Delete key)",children:" Delete Node"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"property-item",children:[a.jsx("strong",{children:"Name:"})," ",x.name]}),x.description&&a.jsxs("div",{className:"property-item",children:[a.jsx("strong",{children:"Description:"})," ",x.description]}),a.jsxs("div",{className:"property-item",children:[a.jsx("strong",{children:"Nodes:"})," ",X.length]}),a.jsxs("div",{className:"property-item",children:[a.jsx("strong",{children:"Edges:"})," ",te.length]})]})]}):a.jsx("div",{className:"muted",children:"No circuit selected"})]},Re)]})]})},gl=e=>({main:"Main System Prompt",tool_call:"Tool Call Prompt",lore_suggest:"Lorebook Suggestion Prompt",image_summary:"Image Generation Prompt"})[e]||e,p_=({isOpen:e,promptType:t,onClose:n,onSave:r})=>{const{circuits:s,fetchCircuits:o,modalState:i}=Ur(),[l,c]=v.useState(),[u,d]=v.useState(!1),[f,p]=v.useState(""),[m,y]=v.useState("");v.useEffect(()=>{e&&o().catch(g=>console.error("Failed to fetch circuits:",g))},[e,o]),v.useEffect(()=>{e&&i.selectedCircuitId&&c(i.selectedCircuitId)},[e,i.selectedCircuitId]);const x=()=>{if(l){const g=s.find(w=>w.id===l);g&&(r(l,g.name),n())}},j=async()=>{if(f.trim())try{const g={name:`${gl(t)} - ${f.trim()}`,description:m.trim()||`Circuit for ${gl(t)}`,data:{nodes:[],edges:[]}},w=await fetch(`${Q}/circuits/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!w.ok)throw new Error("Failed to create circuit");const k=await w.json(),C=[...s,k];Ur.setState({circuits:C}),c(k.id),d(!1),p(""),y("")}catch(g){console.error("Failed to create circuit:",g),alert("Failed to create circuit: "+g.message)}},h=()=>{c(void 0),d(!1),p(""),y(""),n()};return e?a.jsx("div",{className:"modal-overlay",onClick:n,children:a.jsxs("div",{className:"modal-content circuit-modal",onClick:g=>g.stopPropagation(),children:[a.jsxs("h3",{children:["Select Circuit for ",gl(t)]}),a.jsxs("div",{className:"circuit-selection",children:[a.jsxs("div",{className:"section",children:[a.jsx("h4",{children:"Available Circuits"}),a.jsx("div",{className:"circuit-list",children:s.length===0?a.jsx("div",{className:"empty-state",children:a.jsx("p",{children:"No circuits available. Create your first circuit below."})}):s.map(g=>a.jsxs("div",{className:`circuit-item ${l===g.id?"selected":""}`,onClick:()=>c(g.id),children:[a.jsxs("div",{className:"circuit-info",children:[a.jsx("span",{className:"circuit-name",children:g.name}),g.description&&a.jsx("span",{className:"circuit-description",children:g.description})]}),a.jsx("div",{className:"selection-indicator",children:l===g.id&&""})]},g.id))})]}),a.jsxs("div",{className:"section",children:[a.jsxs("div",{className:"create-new-header",children:[a.jsx("h4",{children:"Create New Circuit"}),a.jsx("button",{className:"secondary small",onClick:()=>d(!u),children:u?"Cancel":"+ Create New"})]}),u&&a.jsxs("div",{className:"create-form",children:[a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Circuit Name:"}),a.jsx("input",{type:"text",value:f,onChange:g=>p(g.target.value),placeholder:"Enter circuit name...",autoFocus:!0})]}),a.jsxs("div",{className:"form-group",children:[a.jsx("label",{children:"Description (optional):"}),a.jsx("textarea",{value:m,onChange:g=>y(g.target.value),placeholder:"Enter circuit description...",rows:3})]}),a.jsxs("div",{className:"form-actions",children:[a.jsx("button",{onClick:j,disabled:!f.trim(),children:"Create & Select"}),a.jsx("button",{className:"secondary",onClick:()=>d(!1),children:"Cancel"})]})]})]})]}),a.jsxs("div",{className:"modal-actions",children:[a.jsx("button",{onClick:x,disabled:!l,children:"Save Selection"}),a.jsx("button",{className:"secondary",onClick:h,children:"Cancel"})]})]})}):null};function m_({messageId:e,role:t,onSwipe:n,onEdit:r,onDelete:s,isVisible:o}){if(!o)return null;const i=u=>{u.preventDefault(),u.stopPropagation(),console.log("Swipe clicked for message:",e),n(e)},l=u=>{u.preventDefault(),u.stopPropagation(),console.log("Edit clicked for message:",e),r(e)},c=u=>{u.preventDefault(),u.stopPropagation(),console.log("Delete clicked for message:",e),s(e)};return a.jsxs("div",{className:"message-controls",children:[t==="assistant"&&a.jsx("button",{className:"message-btn swipe-btn",title:"Regenerate message",onClick:i,children:""}),a.jsx("button",{className:"message-btn edit-btn",title:"Edit message",onClick:l,children:""}),a.jsx("button",{className:"message-btn delete-btn",title:"Delete message",onClick:c,children:""})]})}function g_(){var kt,Ct;const e=O1(),t=D1(),n=Gm(),r=it(),s=Pu();Lu();const{generateImage:o,generateImageFromLastMessage:i}=R1(),{suggestLore:l}=I1(),c=v.useRef(null),[u,d]=v.useState(!1),[f,p]=v.useState(null);v.useState({});const[m,y]=v.useState(!1),[x,j]=v.useState(!1),[h,g]=v.useState([]),[w,k]=v.useState("https://example.org"),[C,N]=v.useState([]),[T,P]=v.useState(!1),[$,M]=v.useState(null),[B,W]=v.useState(!1),V=v.useRef(null),E=v.useRef(null),[O,L]=v.useState(null),[F,A]=v.useState(""),[b,D]=v.useState({}),[z,H]=v.useState({}),[X,G]=v.useState(null),[q,te]=v.useState(null),[re,ue]=v.useState(null);v.useEffect(()=>{n.loadConfig(),s.loadCharacters(),s.loadLorebooks()},[]),v.useEffect(()=>{const S=_=>{try{_&&_.detail&&t.setPhoneStyle(_.detail)}catch{}};return window.addEventListener("coolchat:phoneStyle",S),()=>window.removeEventListener("coolchat:phoneStyle",S)},[]),v.useEffect(()=>{const S=_=>{try{_&&_.detail&&t.updateAppTheme(_.detail)}catch{}};return window.addEventListener("coolchat:themeUpdate",S),()=>window.removeEventListener("coolchat:themeUpdate",S)},[]),v.useEffect(()=>{const S=()=>{try{const _=E1();t.applyPluginAnimations(_)}catch(_){console.error(_)}};try{P1(S)}catch{}return S(),()=>{try{L1(S)}catch{}}},[]);const se=(S,_="info")=>{const U=Date.now();N(R=>[...R,{id:U,message:S,type:_}]),setTimeout(()=>N(R=>R.filter(K=>K.id!==U)),4e3)};v.useEffect(()=>{const S=window.matchMedia("(max-width: 768px)"),_=R=>{R.target.closest(".header")||P(!1)},U=R=>{R.matches||P(!1)};if(T&&S.matches)return document.addEventListener("click",_),document.addEventListener("touchstart",_),S.addEventListener("change",U),()=>{document.removeEventListener("click",_),document.removeEventListener("touchstart",_),S.removeEventListener("change",U)}},[T]),v.useEffect(()=>{c.current&&setTimeout(()=>{try{c.current.scrollTop=c.current.scrollHeight}catch{}},0)},[e.messages]),v.useEffect(()=>{t.showConfig&&(async()=>{try{n.loadModels()}catch(S){console.error("Failed to load models:",S)}})()},[n.activeProvider,t.showConfig]),v.useEffect(()=>{s.selectedLorebook?s.loadLoreEntries(s.selectedLorebook.id):s.setLoreEntries([])},[s.selectedLorebook]);const J=S=>{if(!S||typeof S!="string")return{obj:null,captionText:""};let _="",U=null;const R=S.replace(/\*+/g,"").trim();try{return U=JSON.parse(R),{obj:U,captionText:""}}catch{}const K=Math.max(R.lastIndexOf("}"),R.lastIndexOf("]"));if(K>0){const oe=R.charAt(K),ge=oe==="}"?"{":"[";let xe=0,fe=-1;for(let pt=K;pt>=0;pt--){const ie=R.charAt(pt);if(ie===oe&&xe++,ie===ge&&(xe--,xe===0)){fe=pt;break}}if(fe>=0)try{const pt=R.slice(fe,K+1);return U=JSON.parse(pt),_=R.slice(0,fe).trim(),{obj:U,captionText:_}}catch{}}const de=R.match(/toolCalls\s*:?\s*(\[[\s\S]*\])$/);if(de)try{const oe=de[1];return U={toolCalls:JSON.parse(oe)},_=R.slice(0,de.index).trim(),{obj:U,captionText:_}}catch{}const ae=R.match(/\{[\s\S]*\}/);if(ae)try{return U=JSON.parse(ae[0]),_=R.slice(0,ae.index).trim(),{obj:U,captionText:_}}catch{}return{obj:null,captionText:""}},ve=async S=>{var U,R,K,de;S.preventDefault(),e.setError(null);const _=e.input.trim();if(_)try{console.log(`[${new Date().toISOString()}] onSubmit: Starting submit, current messages:`,e.messages.length,"messages"),e.setInput(""),console.log(`[${new Date().toISOString()}] onSubmit: Before appending user message, messages:`,e.messages.map(ie=>({role:ie.role,content:ie.content.slice(0,50)}))),Cr.flushSync(()=>r.setMessages(ie=>[...ie,{role:"user",content:_}]));const ae=it.getState().messages;console.log(`[${new Date().toISOString()}] onSubmit: After appending user message, messages:`,ae.map(ie=>({role:ie.role,content:ie.content.slice(0,50)})));const oe=await e.sendMessage(_);await wf("Raw LLM response: "+oe);const ge=it.getState().messages;console.log(`[${new Date().toISOString()}] onSubmit: after sendMessage, current messages:`,ge.map(ie=>({role:ie.role,content:ie.content.slice(0,50)})));let xe=!1,fe="";try{const{obj:ie,captionText:us}=J(oe);if(fe=us,Gt("Extraction result: "+JSON.stringify({obj:ie,captionText:fe})),ie||Gt("No JSON extracted from response"),ie&&Array.isArray(ie.toolCalls)){for(const De of ie.toolCalls)if(!(!De||!De.type))if(De.type==="image_request"&&((U=De.payload)!=null&&U.prompt))await o(De.payload.prompt),fe&&Cr.flushSync(()=>r.setMessages(ke=>[...ke,{role:"assistant",content:fe}])),xe=!0;else if(De.type==="phone_url"&&((R=De.payload)!=null&&R.url)){let ke=De.payload.url;/^https?:/i.test(ke)||(ke="https://"+ke),k(ke),t.setPhoneOpen(!0),fe&&Cr.flushSync(()=>r.setMessages(ds=>[...ds,{role:"assistant",content:fe}])),xe=!0}else De.type==="lore_suggestions"&&Array.isArray((K=De.payload)==null?void 0:K.items)?(console.log("[DEBUG] Lore suggestions tool call parsed (items):",De.payload.items),g(De.payload.items.map(ke=>({keyword:ke.keyword,content:ke.content}))),t.setSuggestOpen(!0),xe=!0):De.type==="lore_suggestions"&&Array.isArray((de=De.payload)==null?void 0:de.suggestions)&&(console.log("[DEBUG] Lore suggestions tool call parsed (suggestions):",De.payload.suggestions),g(De.payload.suggestions.map(ke=>({keyword:ke.keyword,content:ke.content}))),t.setSuggestOpen(!0),xe=!0)}else{if(Gt("No toolCalls array found, trying flat keys"),ie&&ie.image_request&&(Gt("Found flat key: image_request"),await o(ie.image_request),xe=!0),ie&&ie.phone_url){Gt("Found flat key: phone_url");let ke=ie.phone_url;/^https?:/i.test(ke)||(ke="https://"+ke),k(ke),t.setPhoneOpen(!0),fe&&(Gt("Adding caption message for phone_url: "+fe),Cr.flushSync(()=>r.setMessages(ds=>[...ds,{role:"assistant",content:fe}]))),xe=!0}ie&&Array.isArray(ie.lore_suggestions)&&(Gt("Found flat key: lore_suggestions"),console.log("[DEBUG] Lore suggestions flat key parsed:",ie.lore_suggestions),g(ie.lore_suggestions),t.setSuggestOpen(!0),xe=!0);const De=/toolCalls\s*:|image_request|phone_url|lore_suggestions/i.test(oe);!n.structuredOutput&&!x&&De&&!xe&&y(!0)}}catch(ie){console.warn("Tool parse failed",ie)}Gt("Parsing complete. Handled: "+xe+", Caption text: "+fe);const pt=it.getState().messages;console.log(`[${new Date().toISOString()}] onSubmit: after tool processing, handled:`,xe,"messages:",pt.map(ie=>({role:ie.role,content:ie.content.slice(0,50)}))),xe||(Gt("No tool calls handled, adding response text to chat"),Cr.flushSync(()=>r.setMessages(ie=>[...ie,{role:"assistant",content:oe}])))}catch(ae){console.error("Error sending message:",ae),se(ae.message,"error")}},we=(S,_)=>{_?(V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{M(S),W(!0)},300)):(V.current&&clearTimeout(V.current),W(!1),M(null))},Me=(S,_)=>{_?(E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{H(U=>({...U,[S]:!0}))},300)):(E.current&&clearTimeout(E.current),H(U=>({...U,[S]:!1})))};v.useEffect(()=>{const S=_=>{_.target.closest(".message")||(W(!1),M(null))};return document.addEventListener("touchstart",S),()=>document.removeEventListener("touchstart",S)},[]);const Re=async S=>{W(!1);try{let _=e.messages;if(S>=_.length||S<0){se("Message not found","error");return}const U=_[S];if(U.role!=="assistant"){se("Only assistant messages can be regenerated","error");return}let R=null;for(let K=S-1;K>=0;K--)if(_[K].role==="user"){R=_[K].content;break}if(!R){se("No user message found to regenerate from","error");return}G(S),setTimeout(async()=>{e.setSending(!0),e.setError(null),b[S]||(b[S]={currentIndex:0,generations:[U.content]});try{const K=await Hm(R,e.sessionId);await wf("Raw LLM response after swipe: "+K);const de=b[S];de.generations.push(K),de.currentIndex=de.generations.length-1;const ae=[..._];ae[S]={...U,content:K},e.setMessages(ae),D({...b}),G(null),te(S),setTimeout(()=>{te(null)},800),e.setSending(!1),se("Message regenerated successfully","success")}catch(K){console.error("Error during swipe:",K),e.setSending(!1),G(null),te(null),se("Failed to regenerate message: "+K.message,"error")}},300)}catch(_){console.error("Error during swipe:",_),se("Failed to regenerate message: "+_.message,"error"),G(null)}},Ee=S=>{W(!1);const _=e.messages[S];_&&(L(S),A(_.content))},Ue=async()=>{if(!(!O||!F.trim()))try{const S=O,_=[...e.messages];_[S]={..._[S],content:F.trim()},e.setMessages(_),L(null),A(""),se("Message edited successfully","success")}catch(S){console.error("Error editing message:",S),se("Failed to edit message: "+S.message,"error")}},he=()=>{L(null),A("")},ee=S=>{if(W(!1),S>=e.messages.length||S<0)return;const _={...b};delete _[S];const U={};Object.entries(_).forEach(([K,de])=>{const ae=parseInt(K);ae>S?U[ae-1]=de:U[ae]=de});const R=e.messages.filter((K,de)=>de!==S);e.setMessages(R),D(U),se("Message deleted","success")},Ie=S=>{const _=b[S];if(!_||_.currentIndex>0){const U=Math.max(0,((_==null?void 0:_.currentIndex)??0)-1),R=[...e.messages];R[S]={...R[S],content:_.generations[U]};const K={...b};K[S]={..._,currentIndex:U},e.setMessages(R),D(K),ue(S),setTimeout(()=>{ue(null)},1e3)}},ot=S=>{const _=b[S];if(!_||_.currentIndex<_.generations.length-1){const U=Math.min(((_==null?void 0:_.generations.length)??1)-1,((_==null?void 0:_.currentIndex)??0)+1),R=[...e.messages];R[S]={...R[S],content:_.generations[U]};const K={...b};K[S]={..._,currentIndex:U},e.setMessages(R),D(K),ue(S),setTimeout(()=>{ue(null)},1e3)}},[Vt,Wt]=v.useState([]),[$t,Ye]=v.useState({});v.useEffect(()=>{(async()=>{try{const S=await fetch(`${Q}/plugins`);if(S.ok){const _=await S.json();Wt(_.plugins||[]),Ye(_.enabled||{});try{hc(_.enabled||{})}catch{}try{await yf()}catch(U){console.error(U)}}}catch(S){console.error("Failed to load plugins",S)}})()},[]);const Yt=async S=>{try{if(!(await fetch(`${Q}/plugins/enabled`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok)throw new Error("Save failed");Ye(S);try{hc(S);const U=await fetch(`${Q}/plugins`),R=U.ok?await U.json():null;R&&b1(R.plugins||[]),await yf(R)}catch(U){console.error(U)}try{await Et({extensions:S})}catch(U){console.error("Failed to persist extensions to config",U)}}catch(_){console.error(_),alert(_.message)}};return a.jsxs("div",{className:`app ${t.phoneOpen?"phone-open":""}`,children:[a.jsx("div",{className:"bg-animations",children:(((kt=t.appTheme)==null?void 0:kt.background_animations)||[]).map((S,_)=>a.jsx("div",{className:`anim-${S}`},_))}),a.jsxs("header",{className:`header ${T?"menu-open":""}`,role:"banner",children:[a.jsx("h1",{children:"CoolChat"}),a.jsx("div",{className:"spacer"}),a.jsxs("div",{className:"header-buttons",children:[a.jsx("button",{className:"secondary","aria-label":t.showCharacters?"Hide characters panel":"Show characters panel","aria-expanded":t.showCharacters,onClick:()=>t.setShowCharacters(!t.showCharacters),children:t.showCharacters?"Hide Characters":"Characters"}),a.jsx("button",{className:"secondary","aria-label":t.showChats?"Hide chats panel":"Show chats panel","aria-expanded":t.showChats,onClick:()=>t.setShowChats(!t.showChats),children:t.showChats?"Hide Chats":"Chats"}),a.jsx("button",{className:"secondary","aria-label":t.showTools?"Hide tools panel":"Show tools panel","aria-expanded":t.showTools,onClick:()=>t.setShowTools(!t.showTools),children:t.showTools?"Hide Tools":"Tools"}),a.jsx("button",{className:"secondary","aria-label":t.showLorebooks?"Hide lorebooks panel":"Show lorebooks panel","aria-expanded":t.showLorebooks,onClick:()=>t.setShowLorebooks(!t.showLorebooks),children:t.showLorebooks?"Hide Lorebooks":"Lorebooks"}),a.jsx("button",{className:"secondary","aria-label":t.showCircuits?"Hide circuits panel":"Show circuits panel","aria-expanded":t.showCircuits,onClick:()=>t.setShowCircuits(!t.showCircuits),children:t.showCircuits?"Hide Circuits":"Circuits"}),a.jsx("button",{className:"secondary","aria-label":t.phoneOpen?"Close phone simulator":"Open phone simulator","aria-expanded":t.phoneOpen,onClick:()=>t.setPhoneOpen(!t.phoneOpen),children:t.phoneOpen?"Close Phone":"Phone"}),a.jsx("button",{className:"secondary","aria-label":t.showConfig?"Close settings":"Open settings","aria-expanded":t.showConfig,onClick:()=>t.setShowConfig(!t.showConfig),children:t.showConfig?"Close Settings":"Settings"})]}),a.jsx("button",{className:"menu-toggle","aria-label":"Toggle menu","aria-expanded":T,onClick:()=>P(!T),children:""})]}),t.phoneOpen&&a.jsxs("div",{className:`phone-panel ${t.phoneStyle}`,children:[a.jsx("div",{className:"outer-overlay",onClick:S=>{S.target===S.currentTarget&&t.setPhoneOpen(!1)}}),a.jsx("div",{className:"skin"}),a.jsxs("div",{className:"screen",children:[a.jsx("div",{className:"statusbar",children:t.phoneStyle==="iphone"?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"left",children:""}),a.jsx("span",{className:"time",children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),a.jsx("span",{className:"right",children:" "})]}):a.jsxs(a.Fragment,{children:[a.jsx("span",{children:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),a.jsx("span",{children:"  "})]})}),a.jsxs("div",{className:"bar",children:[a.jsx("input",{style:{flex:1},placeholder:"https://",value:w,onChange:S=>k(S.target.value)}),a.jsx("button",{className:"secondary",onClick:()=>{let S=w;/^https?:/i.test(S)||(S="https://"+S),k(S)},children:"Go"}),a.jsx("button",{className:"secondary",title:"Open in new tab",onClick:()=>{try{let S=w;/^https?:/i.test(S)||(S="https://"+S),window.open(S,"_blank")}catch(S){console.error(S)}},children:""})]}),a.jsx("iframe",{src:/^https?:/i.test(w)?w:"https://"+w,title:"Phone",onLoad:()=>{try{fetch(`${Q}/phone/debug`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"load",url:w})})}catch(S){console.error(S)}},onError:()=>{try{fetch(`${Q}/phone/debug`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({event:"error",url:w})})}catch(S){console.error(S)}}})]})]}),a.jsxs("main",{className:"chat",children:[t.showCharacters&&a.jsxs("section",{className:"characters overlay",children:[a.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[a.jsx("h2",{style:{margin:0},children:"Characters"}),a.jsx("button",{className:"secondary",onClick:()=>t.setShowCharacters(!1),children:"Close"})]}),a.jsxs("div",{className:"row",children:[a.jsxs("label",{className:"secondary",style:{padding:"8px 10px",borderRadius:6,cursor:"pointer"},children:["Import JSON/PNG",a.jsx("input",{type:"file",accept:"application/json,.json,image/png",style:{display:"none"},onChange:async S=>{var U;const _=(U=S.target.files)==null?void 0:U[0];if(_){try{if(_.type==="image/png"){const R=new FormData;if(R.append("file",_),!(await fetch(`${Q}/characters/import`,{method:"POST",body:R})).ok)throw new Error("Import failed")}else{const R=await _.text(),K=JSON.parse(R);if(!K.name)throw new Error("JSON must include name");await pf({name:K.name,description:K.description||"",avatar_url:K.avatar_url||null})}s.loadCharacters()}catch(R){alert(R.message)}S.target.value=""}}})]}),a.jsx("button",{className:"secondary",onClick:()=>s.loadCharacters(),children:"Refresh"})]}),a.jsxs("div",{className:"char-grid",children:[a.jsxs("div",{className:"char-card",onClick:()=>{p(null),d(!0)},children:[a.jsx("img",{src:"https://placehold.co/400x600?text=New+Character",alt:"New Character"}),a.jsx("div",{className:"name",children:"+ New"})]}),s.characters.map(S=>a.jsxs("div",{className:"char-card",children:[a.jsx("img",{src:S.avatar_url||"https://placehold.co/400x600?text=Character",alt:S.name}),a.jsx("div",{className:"name",children:S.name}),a.jsx("div",{className:"cog",onClick:_=>{_.stopPropagation(),p(S),d(!0)},children:a.jsx("span",{children:""})}),a.jsx("div",{style:{padding:"8px"},children:a.jsxs("div",{className:"row",style:{justifyContent:"space-between"},children:[a.jsx("button",{onClick:async()=>{try{await Et({active_character_id:S.id}),t.setShowCharacters(!1)}catch(_){console.error(_),alert(_.message)}},children:"Use"}),a.jsx("button",{className:"secondary",onClick:async()=>{try{await Um(S.id),s.loadCharacters()}catch(_){alert(_.message)}},children:"Delete"})]})})]},S.id))]})]}),t.showChats&&a.jsxs("section",{className:"panel overlay",children:[a.jsx("h2",{children:"Chats"}),a.jsx(j_,{sessionId:e.sessionId,setSessionId:e.switchSession,onClose:()=>t.setShowChats(!1)})]}),t.showTools&&a.jsxs("section",{className:"panel overlay",children:[a.jsx("h2",{children:"Tools"}),a.jsx(x_,{onClose:()=>t.setShowTools(!1)})]}),t.showConfig&&a.jsxs("section",{className:"panel overlay",children:[a.jsx("h2",{children:"Configuration"}),a.jsxs("div",{className:"row",style:{gap:6,marginBottom:8},children:[a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("connection")},children:"Connection"}),a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("persona")},children:"Persona"}),a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("appearance")},children:"Appearance"}),a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("images")},children:"Images"}),a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("prompts")},children:"Prompts"}),a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("advanced")},children:"Advanced"}),a.jsx("button",{className:"secondary",onClick:S=>{S.preventDefault(),t.setSettingsTab("extensions")},children:"Extensions"})]}),t.settingsTab==="connection"&&a.jsxs("form",{className:"config-form",onSubmit:async S=>{var _;S.preventDefault();try{const U=await tn(),R=((_=n.providers)==null?void 0:_[n.activeProvider])||{},K={};for(const ae of["api_key","api_base","model","temperature"]){const oe=n.configDraft[ae],ge=R[ae]??"";ae==="temperature"?typeof oe=="number"&&oe!==ge&&(K[ae]=oe):oe&&oe!==ge&&(K[ae]=oe)}if(Object.keys(K).length){const ae=Object.entries(K).map(([oe,ge])=>`- ${oe}: old=${R[oe]??"(none)"} -> new=${ge}`).join(`
`);if(!window.confirm(`Config.json already has this information, would you like to update it or discard?
${ae}`)){n.setConfigDraft({api_key:"",api_base:R.api_base||"",model:R.model||"",temperature:R.temperature??.7});return}}const de=await Et({active_provider:n.activeProvider,providers:{[n.activeProvider]:K},max_context_tokens:n.maxTokens});n.setProviders(de.providers||{})}catch(U){console.error(U),alert(U.message)}},children:[a.jsxs("label",{children:[a.jsx("span",{children:"Provider"}),a.jsxs("select",{value:n.activeProvider,onChange:async S=>{const _=S.target.value;n.setActiveProvider(_);const U=n.providers[_]||{};n.setConfigDraft({api_key:"",api_base:U.api_base||"",model:U.model||"",temperature:U.temperature??.7});try{await n.updateProvider(_)}catch{}},children:[a.jsx("option",{value:"echo",children:"Echo (no API key)"}),a.jsx("option",{value:"openai",children:"OpenAI-compatible"}),a.jsx("option",{value:"openrouter",children:"OpenRouter"}),a.jsx("option",{value:"gemini",children:"Google Gemini"})]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"API Key"}),a.jsx("input",{type:"password",placeholder:(Ct=n.providers[n.activeProvider])!=null&&Ct.api_key_masked?`Saved: ${n.providers[n.activeProvider].api_key_masked}`:"sk-...",value:n.configDraft.api_key,onChange:S=>n.setConfigDraft({...n.configDraft,api_key:S.target.value})})]}),a.jsxs("label",{children:[a.jsx("span",{children:"API Base"}),a.jsx("input",{type:"text",placeholder:n.activeProvider==="openrouter"?"https://openrouter.ai/api/v1":n.activeProvider==="openai"?"https://api.openai.com/v1":"https://generativelanguage.googleapis.com/v1beta/openai",value:n.configDraft.api_base,onChange:S=>n.setConfigDraft({...n.configDraft,api_base:S.target.value})})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Model"}),n.modelList.length>0?a.jsxs("select",{value:n.configDraft.model||"",onChange:S=>n.setConfigDraft({...n.configDraft,model:S.target.value}),children:[a.jsx("option",{value:"",children:n.loadingModels?"Loading":"Select a model"}),n.modelList.map(S=>a.jsx("option",{value:S,children:S},S))]}):a.jsx("input",{type:"text",placeholder:n.activeProvider==="gemini"?"gemini-1.5-flash":"gpt-4o-mini",value:n.configDraft.model,onChange:S=>n.setConfigDraft({...n.configDraft,model:S.target.value})})]}),a.jsx("div",{className:"row",children:a.jsx("button",{type:"button",className:"secondary",onClick:async()=>{try{await n.updateProviderConfig(n.activeProvider,n.configDraft)}catch{console.warn("Failed to update provider config")}try{await n.loadModelsForProvider(n.activeProvider)}catch{n.setModelList([])}},disabled:n.loadingModels,children:n.loadingModels?"Refreshing":"Refresh models"})}),a.jsxs("label",{children:[a.jsx("span",{children:"Temperature"}),a.jsx("input",{type:"number",step:"0.1",min:"0",max:"2",value:n.configDraft.temperature,onChange:S=>n.setConfigDraft({...n.configDraft,temperature:parseFloat(S.target.value)})})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Structured Output (Gemini)"}),a.jsx("input",{type:"checkbox",checked:n.structuredOutput,onChange:async S=>{try{await n.updateStructuredOutput(S.target.checked)}catch(_){alert(_.message)}}})]}),a.jsxs("div",{className:"row",children:[a.jsx("button",{type:"submit",children:"Save"}),a.jsx("button",{type:"button",className:"secondary",onClick:()=>{var S,_,U;return n.setConfigDraft({api_key:"",api_base:((S=n.providers[n.activeProvider])==null?void 0:S.api_base)||"",model:((_=n.providers[n.activeProvider])==null?void 0:_.model)||"",temperature:((U=n.providers[n.activeProvider])==null?void 0:U.temperature)??.7})},children:"Reset"})]}),a.jsxs("label",{children:[a.jsxs("span",{children:["Max Context Tokens (",n.maxTokens,")"]}),a.jsx("input",{type:"range",min:"512",max:"8192",step:"128",value:n.maxTokens,onChange:S=>n.updateMaxTokens(parseInt(S.target.value,10))})]})]}),t.settingsTab==="persona"&&a.jsxs("div",{className:"config-form",children:[a.jsxs("label",{children:[a.jsx("span",{children:"User Name"}),a.jsx("input",{value:n.userPersona.name,onChange:S=>n.setUserPersona({...n.userPersona,name:S.target.value}),onBlur:async()=>{try{await n.updateUserPersona(n.userPersona)}catch(S){console.error(S),alert(S.message)}}})]}),a.jsxs("label",{children:[a.jsx("span",{children:"User Description"}),a.jsx("textarea",{rows:3,value:n.userPersona.description,onChange:S=>n.setUserPersona({...n.userPersona,description:S.target.value}),onBlur:async()=>{try{await n.updateUserPersona(n.userPersona)}catch(S){console.error(S),alert(S.message)}}})]})]}),t.settingsTab==="debug"&&a.jsxs("div",{className:"config-form",children:[a.jsxs("label",{children:[a.jsx("span",{children:"Log Prompts"}),a.jsx("input",{type:"checkbox",checked:n.debugFlags.log_prompts,onChange:async S=>{const _=S.target.checked,U={...n.debugFlags,log_prompts:_};n.setDebugFlags(U);try{await n.updateDebugFlags(U)}catch{}}})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Log Responses"}),a.jsx("input",{type:"checkbox",checked:n.debugFlags.log_responses,onChange:async S=>{const _=S.target.checked,U={...n.debugFlags,log_responses:_};n.setDebugFlags(U);try{await n.updateDebugFlags(U)}catch{}}})]}),a.jsxs("label",{children:[a.jsxs("span",{children:["Max Context Tokens (",n.maxTokens,")"]}),a.jsx("input",{type:"range",min:"512",max:"8192",step:"128",value:n.maxTokens,onChange:async S=>{const _=parseInt(S.target.value,10);n.updateMaxTokens(_);try{await Et({max_context_tokens:_})}catch{}}})]}),a.jsxs("label",{children:[a.jsx("span",{children:"User Name"}),a.jsx("input",{value:n.userPersona.name,onChange:S=>n.setUserPersona({...n.userPersona,name:S.target.value}),onBlur:async()=>{try{await n.updateUserPersona(n.userPersona)}catch{}}})]}),a.jsxs("label",{children:[a.jsx("span",{children:"User Description"}),a.jsx("textarea",{rows:3,value:n.userPersona.description,onChange:S=>n.setUserPersona({...n.userPersona,description:S.target.value}),onBlur:async()=>{try{await n.updateUserPersona(n.userPersona)}catch{}}})]})]}),t.settingsTab==="appearance"&&a.jsx(k_,{}),t.settingsTab==="images"&&a.jsx(y_,{providers:n.providers}),t.settingsTab==="prompts"&&a.jsx(v_,{}),t.settingsTab==="advanced"&&a.jsx(w_,{}),t.settingsTab==="extensions"&&a.jsxs("div",{className:"config-form",children:[a.jsx("h3",{children:"Extensions"}),a.jsx("p",{className:"muted",children:"Detected extensions found under /extensions. Enable ones you trust."}),a.jsxs("div",{style:{marginTop:8},children:[Vt.length===0?a.jsxs("div",{className:"muted",children:["No extensions detected. If you expect extensions, verify the backend is running and that ",a.jsx("code",{children:"/plugins"})," returns manifests."]}):null,Vt.map(S=>a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",marginBottom:6},children:[a.jsxs("div",{style:{flex:1},children:[a.jsx("strong",{children:S.name||S.id}),a.jsx("div",{className:"muted",children:S.description||""})]}),a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:!!$t[S.id],onChange:_=>{const U={...$t,[S.id]:_.target.checked};Yt(U)}})," Enabled"]})]},S.id))]})]}),t.settingsTab==="connection"&&a.jsx("div",{className:"hint",children:a.jsx("p",{className:"muted",children:"OpenRouter uses OpenAI-compatible endpoints. You can set API Base to https://openrouter.ai/api/v1. Gemini uses the OpenAI-compatible base at https://generativelanguage.googleapis.com/v1beta/openai."})})]}),t.showLorebooks&&a.jsx("section",{className:"panel overlay",children:a.jsx(q1,{onClose:()=>t.setShowLorebooks(!1)})}),t.showCircuits&&a.jsxs("section",{className:"panel overlay",children:[a.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[a.jsx("h2",{children:"Circuits"}),a.jsx("button",{className:"secondary",onClick:()=>t.setShowCircuits(!1),children:"Close"})]}),a.jsx(h_,{})]}),a.jsxs("div",{className:"messages","aria-live":"polite",ref:c,children:[(()=>{const S=it.getState().messages;return console.log(`[${new Date().toISOString()}] Messages render: ${S.length} messages`,S.map(_=>({role:_.role,content:_.content.slice(0,50)}))),null})(),r.messages.map((S,_)=>{const U=S.id||`msg-${_}`,R=$===_&&B,K=O===_,de=X===_,ae=q===_,oe=re===_,ge=b[_]&&b[_].generations.length>1,xe=z[_]||!1;return a.jsx("div",{className:`message ${S.role}${R?" message-hovered":""}${K?" message-editing":""}${de?" message-animating-swipe":""}${ae?" message-swipe-new":""}${oe?" message-flip":""}`,onMouseEnter:()=>{we(_,!0),ge&&Me(_,!0)},onMouseLeave:()=>{we(_,!1),ge&&Me(_,!1)},onTouchStart:()=>{we(_,!0),ge&&Me(_,!0)},onTouchEnd:()=>{we(_,!1),ge&&Me(_,!1)},children:a.jsxs("div",{className:`bubble ${ge?"has-swipes":""}`,children:[a.jsx("div",{className:"bubble-content",children:S.image_url?a.jsxs("div",{children:[a.jsx("img",{src:S.image_url,alt:"generated",style:{maxWidth:"100%",borderRadius:8}}),S.content?a.jsx("div",{className:"img-caption",children:S.content}):null]}):a.jsx(a.Fragment,{children:K?a.jsxs("div",{className:"message-edit-container",children:[a.jsx("textarea",{value:F,onChange:fe=>A(fe.target.value),className:"message-edit-input",autoFocus:!0,rows:Math.ceil(F.length/60)}),a.jsxs("div",{className:"message-edit-buttons",children:[a.jsx("button",{className:"message-edit-save",onClick:Ue,children:" Save"}),a.jsx("button",{className:"message-edit-cancel",onClick:he,children:" Cancel"})]})]}):S.content})}),S.role==="assistant"&&ge&&xe&&a.jsxs("div",{className:"swipe-navigation",children:[a.jsx("button",{className:"swipe-nav-btn swipe-nav-prev",onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),Ie(_)},disabled:b[_].currentIndex===0,title:"Previous generation",children:""}),a.jsx("span",{className:"swipe-count",children:`${b[_].currentIndex+1}/${b[_].generations.length}`}),a.jsx("button",{className:"swipe-nav-btn swipe-nav-next",onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),ot(_)},disabled:b[_].currentIndex===b[_].generations.length-1,title:"Next generation",children:""})]}),S.role==="assistant"&&a.jsx("div",{className:"swipe-navigation",children:b[_]&&b[_].generations.length>1&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"swipe-nav-btn swipe-nav-prev",onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),Ie(_)},disabled:b[_].currentIndex===0,title:"Previous generation",children:""}),a.jsx("span",{className:"swipe-count",children:b[_].generations.length>1&&`${b[_].currentIndex+1}/${b[_].generations.length}`}),a.jsx("button",{className:"swipe-nav-btn swipe-nav-next",onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),ot(_)},disabled:b[_].currentIndex===b[_].generations.length-1,title:"Next generation",children:""})]})}),a.jsx(m_,{messageId:_,role:S.role,onSwipe:Re,onEdit:Ee,onDelete:ee,isVisible:R})]})},U)}),e.error&&a.jsx("div",{className:"message error",children:a.jsx("div",{className:"bubble",children:e.error})})]}),a.jsxs("div",{className:"input-tools",children:[a.jsx("button",{className:"secondary","aria-label":"Suggest lore entries from chat",title:"Suggest lore entries from chat",onClick:async()=>{try{const S=await l(e.sessionId);if(!S.suggestions||S.suggestions.length===0){alert("No suggestions");return}g(S.suggestions),t.setSuggestOpen(!0)}catch(S){console.error(S),alert(S.message)}},children:""}),a.jsx("button",{className:"secondary","aria-label":"Generate image from chat",title:"Generate image from chat",onClick:i,children:""}),a.jsx("button",{className:"secondary","aria-label":"Send URL to phone simulator",title:"Send URL to phone",onClick:()=>{let S=prompt("Open URL on phone:");S&&(/^https?:/i.test(S)||(S="https://"+S),k(S),t.setPhoneOpen(!0))},children:""}),a.jsx("button",{className:"secondary","aria-label":"Scroll to bottom of messages",title:"Scroll to bottom",style:{marginLeft:"auto"},onClick:()=>{try{const S=document.querySelectorAll(".message.assistant");S.length>0?S[S.length-1].scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"}):c.current&&c.current.scrollTo({top:c.current.scrollHeight,behavior:"smooth"})}catch(S){console.error("Error scrolling to last message:",S)}},children:""})]}),a.jsxs("form",{className:"input-row",onSubmit:ve,children:[a.jsx("input",{type:"text",placeholder:"Type your message",value:e.input,onChange:S=>e.setInput(S.target.value),onKeyDown:S=>{S.ctrlKey&&S.key==="Enter"&&ve(S)},disabled:e.sending,"aria-label":"Message input (Ctrl+Enter to send)","aria-describedby":"send-button"}),a.jsx("button",{type:"submit",id:"send-button",disabled:e.sending||!e.input.trim(),children:e.sending?a.jsxs("span",{className:"loading-text",children:[a.jsx("div",{className:"spinner"}),"Sending"]}):"Send"})]}),u&&a.jsx(N_,{character:f,lorebooks:s.lorebooks,onClose:()=>d(!1),onSave:async S=>{try{f?await i1(f.id,S):(Gt("No toolCalls array found, trying flat keys"),await pf(S)),s.loadCharacters(),d(!1)}catch(_){alert(_.message)}},onThink:async(S,_)=>{try{const U={..._};return typeof U.alternate_greetings=="string"&&(U.alternate_greetings=U.alternate_greetings.split(",").map(K=>K.trim()).filter(Boolean)),typeof U.tags=="string"&&(U.tags=U.tags.split(",").map(K=>K.trim()).filter(Boolean)),(await suggestCharacterField(S,U)).value}catch(U){return alert(U.message),""}}}),t.suggestOpen&&a.jsx(C_,{suggestions:h,onClose:()=>t.setSuggestOpen(!1),onApply:async(S,_)=>{try{const R=(await tn()).active_lorebook_ids||[],K=_||R[0];if(!K){alert("No active lorebooks set");return}const de=[];for(const ae of S.filter(oe=>oe.include)){const oe=await fetch(`${Q}/lore`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyword:ae.keyword,content:ae.content})});if(oe.ok){const ge=await oe.json();de.push(ge.id)}}if(de.length){const oe=[...(await(await fetch(`${Q}/lorebooks/${K}`)).json()).entry_ids||[],...de];await Wm(K,{entry_ids:oe})}t.setSuggestOpen(!1)}catch(U){console.error(U),alert(U.message)}}}),m&&a.jsx("section",{className:"panel overlay",onClick:()=>y(!1),children:a.jsxs("div",{className:"dialog",onClick:S=>S.stopPropagation(),children:[a.jsx("h3",{children:"Enable Structured Output?"}),a.jsx("p",{className:"muted",children:"The assistant attempted to call a tool. Structured Output improves tool reliability on Gemini models."}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",onChange:S=>j(S.target.checked)})," Don't show again (this session)"]}),a.jsx("span",{style:{flex:1}}),a.jsx("button",{className:"secondary",onClick:()=>y(!1),children:"Cancel"}),a.jsx("button",{onClick:async()=>{try{await Et({structured_output:!0}),y(!1)}catch(S){alert(String(S))}},children:"Enable"})]})]})})]}),a.jsx("div",{className:"toast-container","aria-live":"assertive","aria-atomic":"true",children:C.map(S=>a.jsxs("div",{className:`toast toast-${S.type}`,children:[S.message,a.jsx("button",{className:"toast-close",onClick:()=>N(_=>_.filter(U=>U.id!==S.id)),"aria-label":"Dismiss notification",children:""})]},S.id))})]})}function y_(){var p;const[e,t]=v.useState({active:"pollinations",pollinations:{api_key:"",model:""},dezgo:{api_key:"",model:"",lora_flux_1:"",lora_flux_2:"",lora_sd1_1:"",lora_sd1_2:"",transparent:!1,width:"",height:"",steps:"",upscale:!1}}),[n,r]=v.useState([]),[s,o]=v.useState("");v.useEffect(()=>{(async()=>{var m,y;try{const x=await tn();t(x.images);const j=await a1(x.images.active);r(j.models||[]);const h=l((y=(m=x.images)==null?void 0:m.dezgo)==null?void 0:y.model);o(h)}catch(x){console.error(x)}})()},[]);const i=async m=>{try{await Et({images:m})}catch(y){console.error(y),alert(y.message)}},l=m=>{const y=(m||"").toLowerCase();return y.includes("flux")?"flux":y.includes("lightning")?"sdxl_lightning":y.includes("sdxl")?"sdxl":"sd1"},c=l((p=e.dezgo)==null?void 0:p.model),u=s||c,d=[{id:"flux",label:"Flux"},{id:"sdxl",label:"SDXL"},{id:"sdxl_lightning",label:"SDXL Lightning"},{id:"sd1",label:"SD1"}],f=(n||[]).filter(m=>l(m)===u);return a.jsxs("div",{className:"config-form",children:[a.jsxs("label",{children:[a.jsx("span",{children:"Active Provider"}),a.jsxs("select",{value:e.active,onChange:async m=>{const y=m.target.value,x={...e,active:y};t(x),await i(x)},children:[a.jsx("option",{value:"pollinations",children:"Pollinations"}),a.jsx("option",{value:"dezgo",children:"Dezgo"})]})]}),e.active==="pollinations"&&a.jsxs(a.Fragment,{children:[a.jsxs("label",{children:[a.jsx("span",{children:"Model"}),a.jsxs("select",{value:e.pollinations.model||"",onChange:async m=>{const y=m.target.value,x={...e,pollinations:{...e.pollinations,model:y}};t(x),await i(x)},children:[a.jsx("option",{value:"",children:"(default)"}),n.map(m=>a.jsx("option",{value:m,children:m},m))]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"API Key"}),a.jsx("input",{placeholder:e.pollinations.api_key_masked?`Saved: ${e.pollinations.api_key_masked}`:"",value:e.pollinations.api_key||"",onChange:m=>t(y=>({...y,pollinations:{...y.pollinations,api_key:m.target.value}}))})]})]}),e.active==="dezgo"&&a.jsxs(a.Fragment,{children:[a.jsxs("label",{children:[a.jsx("span",{children:"API Key"}),a.jsx("input",{placeholder:e.dezgo.api_key_masked?`Saved: ${e.dezgo.api_key_masked}`:"",value:e.dezgo.api_key||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,api_key:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Family"}),a.jsx("select",{value:u,onChange:m=>o(m.target.value),children:d.map(m=>a.jsx("option",{value:m.id,children:m.label},m.id))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Model"}),a.jsxs("select",{value:e.dezgo.model||"",onChange:m=>{const y=m.target.value,x=l(y),j={...e,dezgo:{...e.dezgo,model:y,steps:x==="flux"?4:x==="sdxl_lightning"?"":e.dezgo.steps||30}};t(j),i(j)},children:[a.jsx("option",{value:"",children:"(default)"}),f.map(m=>a.jsx("option",{value:m,children:m},m))]})]}),a.jsxs("div",{className:"muted",children:["Family: ",u.toUpperCase()]}),a.jsx("div",{className:"muted",children:u==="sd1"?"Transparent background disabled; Upscale available.":u==="sdxl_lightning"?"Steps disabled (Lightning is fixed).":"Transparent background available; consider steps ~30."}),u==="flux"&&a.jsxs(a.Fragment,{children:[a.jsxs("label",{children:[a.jsx("span",{children:"Flux LORA #1 (SHA256)"}),a.jsx("input",{value:e.dezgo.lora_flux_1||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora_flux_1:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Flux LORA #2 (SHA256)"}),a.jsx("input",{value:e.dezgo.lora_flux_2||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora_flux_2:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"LoRA 1 Strength"}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",disabled:!e.dezgo.lora_flux_1,value:e.dezgo.lora1_strength??.7,onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora1_strength:parseFloat(m.target.value)}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"LoRA 2 Strength"}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",disabled:!e.dezgo.lora_flux_2,value:e.dezgo.lora2_strength??.7,onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora2_strength:parseFloat(m.target.value)}}))})]})]}),u==="sd1"&&a.jsxs(a.Fragment,{children:[a.jsxs("label",{children:[a.jsx("span",{children:"SD1 LORA #1 (SHA256)"}),a.jsx("input",{value:e.dezgo.lora_sd1_1||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora_sd1_1:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"SD1 LORA #2 (SHA256)"}),a.jsx("input",{value:e.dezgo.lora_sd1_2||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora_sd1_2:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"LoRA 1 Strength"}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",disabled:!e.dezgo.lora_sd1_1,value:e.dezgo.lora1_strength??.7,onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora1_strength:parseFloat(m.target.value)}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"LoRA 2 Strength"}),a.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",disabled:!e.dezgo.lora_sd1_2,value:e.dezgo.lora2_strength??.7,onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,lora2_strength:parseFloat(m.target.value)}}))})]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Width"}),a.jsx("input",{type:"number",value:e.dezgo.width||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,width:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Height"}),a.jsx("input",{type:"number",value:e.dezgo.height||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,height:m.target.value}}))})]}),u!=="sdxl_lightning"&&a.jsxs("label",{children:[a.jsx("span",{children:"Steps"}),a.jsx("input",{type:"number",value:e.dezgo.steps||"",onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,steps:m.target.value}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Transparent Background"}),a.jsx("input",{type:"checkbox",disabled:u==="sd1",checked:!!e.dezgo.transparent,onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,transparent:m.target.checked}}))})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Upscale"}),a.jsx("input",{type:"checkbox",disabled:u!=="sd1",checked:!!e.dezgo.upscale,onChange:m=>t(y=>({...y,dezgo:{...y.dezgo,upscale:m.target.checked}}))})]})]}),a.jsx("div",{className:"row",style:{gridColumn:"1 / -1"},children:a.jsx("button",{onClick:async()=>{try{const m=(await tn()).images;if(JSON.stringify(e)!==JSON.stringify(m)&&!window.confirm("Images config.json will be updated. Proceed?"))return;await i(e),alert("Saved")}catch(m){console.error(m),alert(m.message)}},children:"Save Image Settings"})})]})}function v_(){const e=Ur(),[t,n]=v.useState([]),[r,s]=v.useState([]),[o,i]=v.useState(""),[l,c]=v.useState({lore_suggest:"",image_summary:"",main:"",tool_call:""}),[u,d]=v.useState({}),[f,p]=v.useState(""),[m,y]=v.useState(""),[x,j]=v.useState(!1),h=N=>{const T=e.getPromptCircuitAssociation(N);if(T&&T.circuitId){const P=e.circuits.find($=>$.id===T.circuitId);return T.circuitName||(P?P.name:`Circuit ${T.circuitId}`)}return null};v.useEffect(()=>{(async()=>{try{const N=await x1();n(N.all||[]),s(N.active||[]),c(N.system||{lore_suggest:"",image_summary:""}),d(N.variables||{})}catch(N){console.error(N)}})()},[]);const g=async(N=t,T=r,P=l,$=u)=>{try{await w1({all:N,active:T,system:P,variables:$}),n(N),s(T),c(P),d($)}catch(M){console.error(M),alert(M.message)}},w=N=>{const T=r.includes(N)?r.filter(P=>P!==N):[...r,N];g(t,T)},k=()=>{const N=o.trim();if(!N)return;const T=[...t,N];i(""),g(T,r)},C=N=>{const T=t.filter($=>$!==N),P=r.filter($=>$!==N);g(T,P)};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"config-form",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("h3",{children:"System Prompts"}),a.jsxs("div",{className:"muted",children:["These prompts guide built-in tools. ",a.jsx("a",{href:"#",onClick:N=>{N.preventDefault(),j(!0)},children:"Use placeholders"}),"."]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Main System Prompt"}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("button",{className:"secondary",onClick:()=>e.openCircuitModal("main"),style:{flex:1,textAlign:"left"},children:h("main")?`Edit in Circuit: ${h("main")}`:"Edit in Circuit"}),h("main")&&a.jsx("button",{className:"secondary",onClick:()=>e.setPromptCircuitAssociation("main",null),title:"Clear circuit association",children:""})]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Tool Call Prompt"}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("button",{className:"secondary",onClick:()=>e.openCircuitModal("tool_call"),style:{flex:1,textAlign:"left"},children:h("tool_call")?`Edit in Circuit: ${h("tool_call")}`:"Edit in Circuit"}),h("tool_call")&&a.jsx("button",{className:"secondary",onClick:()=>e.setPromptCircuitAssociation("tool_call",null),title:"Clear circuit association",children:""})]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Lorebook suggestion prompt"}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("button",{className:"secondary",onClick:()=>e.openCircuitModal("lore_suggest"),style:{flex:1,textAlign:"left"},children:h("lore_suggest")?`Edit in Circuit: ${h("lore_suggest")}`:"Edit in Circuit"}),h("lore_suggest")&&a.jsx("button",{className:"secondary",onClick:()=>e.setPromptCircuitAssociation("lore_suggest",null),title:"Clear circuit association",children:""})]})]}),a.jsxs("label",{children:[a.jsx("span",{children:"Image generation prompt"}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("button",{className:"secondary",onClick:()=>e.openCircuitModal("image_summary"),style:{flex:1,textAlign:"left"},children:h("image_summary")?`Edit in Circuit: ${h("image_summary")}`:"Edit in Circuit"}),h("image_summary")&&a.jsx("button",{className:"secondary",onClick:()=>e.setPromptCircuitAssociation("image_summary",null),title:"Clear circuit association",children:""})]})]}),a.jsxs("div",{style:{gridColumn:"1 / -1",marginTop:8},children:[a.jsx("h3",{children:"Variables"}),a.jsxs("div",{className:"muted",children:["Define reusable snippets that replace tags like ",a.jsxs("code",{children:["{","{","company","}","}"]})," anywhere the LLM sees them."]})]}),a.jsxs("div",{className:"row",style:{gap:8},children:[a.jsx("input",{placeholder:"name (e.g., site)",value:f,onChange:N=>p(N.target.value)}),a.jsx("input",{placeholder:"value",value:m,onChange:N=>y(N.target.value)}),a.jsx("button",{className:"secondary",onClick:()=>{const N=f.trim();if(!N)return;const T={...u,[N]:m};p(""),y(""),g(t,r,l,T)},children:"Add"})]}),a.jsx("div",{className:"row",style:{display:"block",marginTop:8},children:Object.entries(u).map(([N,T])=>a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",marginBottom:6},children:[a.jsx("code",{style:{width:160},children:`{{${N}}}`}),a.jsx("input",{style:{flex:1},value:T,onChange:P=>{const $={...u,[N]:P.target.value};d($)},onBlur:()=>g(t,r,l,u)}),a.jsx("button",{className:"secondary",onClick:()=>{const P={...u};delete P[N],g(t,r,l,P)},children:"Delete"})]},N))}),a.jsxs("div",{style:{gridColumn:"1 / -1",marginTop:8},children:[a.jsx("h3",{children:"General Prompts"}),a.jsx("div",{className:"muted",children:"Short, reusable prompts that can be toggled on to influence replies globally."})]}),a.jsxs("label",{children:[a.jsx("span",{children:"New Prompt"}),a.jsxs("div",{className:"row",style:{gap:8},children:[a.jsx("input",{value:o,onChange:N=>i(N.target.value),placeholder:"Short prompt text to include in system context"}),a.jsx("button",{className:"secondary",onClick:k,children:"Add"})]})]}),a.jsx("div",{className:"row",style:{display:"block"},children:(t||[]).map((N,T)=>a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",marginBottom:6},children:[a.jsx("input",{type:"checkbox",checked:r.includes(N),onChange:()=>w(N)}),a.jsx("span",{style:{flex:1},children:N}),a.jsx("button",{className:"secondary",onClick:()=>C(N),children:"Delete"})]},T))})]}),x&&a.jsx("section",{className:"panel overlay",onClick:()=>j(!1),children:a.jsxs("div",{className:"dialog",onClick:N=>N.stopPropagation(),children:[a.jsx("h3",{children:"Available placeholders"}),a.jsxs("ul",{className:"muted",children:[a.jsxs("li",{children:[a.jsx("code",{children:"{{conversation}}"}),": recent conversation window"]}),a.jsxs("li",{children:[a.jsx("code",{children:"{{existing_keywords}}"}),": active lore keywords"]}),a.jsxs("li",{children:[a.jsx("code",{children:"{{tool_call_prompt}}"}),": tool call guidance"]}),a.jsxs("li",{children:[a.jsx("code",{children:"{{user_persona}}"}),": user persona summary"]}),a.jsxs("li",{children:[a.jsx("code",{children:"{{character_description}}"}),": character description/personality"]}),a.jsxs("li",{children:[a.jsx("code",{children:"{{tool_list}}"}),": enabled tools list"]}),Object.keys(u).map(N=>a.jsxs("li",{children:[a.jsx("code",{children:`{{${N}}}`}),": variable"]},N))]}),a.jsx("div",{className:"row",style:{justifyContent:"flex-end"},children:a.jsx("button",{className:"secondary",onClick:()=>j(!1),children:"Close"})})]})}),e.modalState.isOpen&&a.jsx(p_,{isOpen:e.modalState.isOpen,promptType:e.modalState.promptType,onClose:e.closeCircuitModal,onSave:(N,T)=>e.setPromptCircuitAssociation(e.modalState.promptType,N,T)})]})}function x_({onClose:e}){var w,k;const[t,n]=v.useState({phone:!1,image_gen:!1,lore_suggest:!1}),[r,s]=v.useState(!1),[o,i]=v.useState(!1),[l,c]=v.useState([]),[u,d]=v.useState([]),[f,p]=v.useState(""),[m,y]=v.useState(""),[x,j]=v.useState("");v.useEffect(()=>{(async()=>{try{const C=await tn();s(!!C.structured_output);const N=C.active_character_id,T=await(await fetch(`${Q}/tools/settings${N?`?character_id=${N}`:""}`)).json();n(T.enabled||{})}catch(C){console.error(C)}})()},[]);const h=async C=>{try{const T=(await tn()).active_character_id;await fetch(`${Q}/tools/settings${T?`?character_id=${T}`:""}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:C})}),n(C),!o&&(C.phone||C.image_gen||C.lore_suggest)&&!r&&(alert("Enabling tools benefits from Structured Output. You can toggle it in Connection settings."),i(!0))}catch(N){console.error(N),alert("Save failed")}};v.useEffect(()=>{(async()=>{try{const C=await k1();c(C.servers||[]);const N=await j1();d(N.items||[])}catch(C){console.error(C)}})()},[]);const g=async C=>{try{await C1({servers:C}),c(C)}catch(N){console.error(N),alert("Save failed")}};return a.jsxs("div",{className:"config-form",children:[a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:!!t.phone,onChange:C=>h({...t,phone:C.target.checked})}),"Phone Panel ",a.jsx("em",{children:"(phone_url)"})]}),a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:!!t.image_gen,onChange:C=>h({...t,image_gen:C.target.checked})}),"Image Generation ",a.jsx("em",{children:"(image_request)"})]}),a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:!!t.lore_suggest,onChange:C=>h({...t,lore_suggest:C.target.checked})}),"Lore Suggest ",a.jsx("em",{children:"(lore_suggestions)"})]})]}),a.jsx("p",{className:"muted",style:{marginTop:12},children:'When tools are enabled, the assistant receives concise instructions about each tool. For Gemini models, enable "Structured Output" in Connection to get reliable tool-usage responses.'}),a.jsx("hr",{}),a.jsx("h3",{children:"MCP Servers"}),a.jsxs("label",{children:[a.jsx("span",{children:"Catalog"}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsxs("select",{value:f,onChange:C=>p(C.target.value),children:[a.jsx("option",{value:"",children:"(select server)"}),u.map((C,N)=>a.jsx("option",{value:N,children:C.name},N))]}),f!==""&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"secondary",onClick:()=>{const C=u[parseInt(f,10)];if(!C)return;const N=[...l,{name:C.name,url:C.url}];g(N)},children:"Add Server"}),a.jsx("a",{className:"secondary",href:(w=u[parseInt(f,10)])==null?void 0:w.url,target:"_blank",rel:"noreferrer",children:"Open"})]})]}),f!==""&&a.jsx("div",{className:"muted",style:{marginTop:6},children:(k=u[parseInt(f,10)])==null?void 0:k.description})]}),a.jsxs("div",{className:"row",style:{gap:8},children:[a.jsx("input",{placeholder:"Name",value:m,onChange:C=>y(C.target.value)}),a.jsx("input",{placeholder:"URL or command",value:x,onChange:C=>j(C.target.value)}),a.jsx("button",{onClick:()=>{const C=m.trim(),N=x.trim();if(!C||!N)return;const T=[...l,{name:C,url:N}];g(T),y(""),j("")},children:"Add"})]}),a.jsx("div",{style:{marginTop:8},children:l.map((C,N)=>a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,marginBottom:6,padding:8,background:"var(--panel)",borderRadius:8},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("strong",{style:{fontSize:14},children:C.name}),a.jsx("button",{className:"secondary",onClick:()=>{const T=l.filter((P,$)=>$!==N);g(T)},children:"Remove"})]}),a.jsx("div",{className:"muted",style:{fontSize:12,wordBreak:"break-all"},children:C.url})]},N))}),a.jsx("div",{className:"row",style:{justifyContent:"flex-end"},children:a.jsx("button",{className:"secondary",onClick:e,children:"Close"})})]})}function w_(){const[e,t]=v.useState(""),[n,r]=v.useState(!0),[s,o]=v.useState(null);return v.useEffect(()=>{(async()=>{try{r(!0);const i=await fetch(`${Q}/config/raw`);if(!i.ok)throw new Error(`HTTP ${i.status}`);const l=await i.json();t(JSON.stringify(l,null,2))}catch(i){console.error(i),o(String(i)),t("")}finally{r(!1)}})()},[]),a.jsxs("div",{children:[a.jsx("p",{className:"muted",children:"Full settings.json (copy/share):"}),n?a.jsx("div",{className:"muted",children:"Loading settings"}):s?a.jsxs("div",{className:"muted",children:["Unable to load settings: ",s]}):a.jsx("textarea",{rows:16,style:{width:"100%"},value:e,onChange:i=>t(i.target.value)}),a.jsxs("div",{className:"row",style:{marginTop:8},children:[a.jsx("button",{className:"secondary",onClick:()=>{const i=new Blob([e],{type:"application/json"}),l=URL.createObjectURL(i),c=document.createElement("a");c.href=l,c.download="settings.json",c.click(),URL.revokeObjectURL(l)},children:"Export settings.json"}),a.jsxs("label",{className:"secondary",style:{padding:"8px 10px",borderRadius:6,cursor:"pointer"},children:["Import settings.json",a.jsx("input",{type:"file",accept:"application/json,.json",style:{display:"none"},onChange:async i=>{var c;const l=(c=i.target.files)==null?void 0:c[0];if(l)try{const u=await l.text(),d=JSON.parse(u);if(!(await fetch(`${Q}/config/raw`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok)throw new Error("Import failed");alert("Imported. Reloading..."),location.reload()}catch(u){console.error(u),alert(u.message)}finally{i.target.value=""}}})]}),a.jsx("button",{onClick:async()=>{try{const i=JSON.parse(e);if(!(await fetch(`${Q}/config/raw`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok)throw new Error("Save failed");alert("Saved. Reloading..."),location.reload()}catch(i){console.error(i),alert(i.message)}},children:"Save settings.json"})]}),a.jsx("hr",{}),a.jsx("p",{className:"muted",children:"Advanced settings"})]})}function S_(){const[e,t]=v.useState([]),[n,r]=v.useState("");v.useState(null);const s=async()=>{try{const o=await fetch(`${Q}/themes`);if(o.ok){const i=await o.json();t(i.names||[])}}catch(o){console.error(o)}};return v.useEffect(()=>{s()},[]),a.jsxs("div",{className:"row",style:{gap:8},children:[a.jsxs("select",{value:n,onChange:o=>r(o.target.value),children:[a.jsx("option",{value:"",children:"(select)"}),e.map(o=>a.jsx("option",{value:o,children:o},o))]}),a.jsx("button",{className:"secondary",onClick:async()=>{if(n)try{const o=await fetch(`${Q}/themes/${n}`);if(!o.ok)throw new Error("Load failed");const i=await o.json();await fetch(`${Q}/config`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({theme:i})});try{const l=document.documentElement;l.style.setProperty("--primary",i.primary),l.style.setProperty("--panel",i.secondary),l.style.setProperty("--text",i.text1),l.style.setProperty("--muted",i.text2),l.style.setProperty("--assistant",i.highlight),l.style.setProperty("--bg",i.lowlight)}catch(l){console.error(l)}alert("Theme loaded")}catch(o){console.error(o),alert(o.message)}},children:"Load Theme"}),a.jsx("button",{onClick:async()=>{const o=prompt("Save theme as:");if(o)try{const l=(await tn()).theme||{};if(!(await fetch(`${Q}/themes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o,theme:l})})).ok)throw new Error("Save theme failed");alert("Theme saved"),s()}catch(i){console.error(i),alert(i.message)}},children:"Save Current Theme"})]})}function k_(){const[e,t]=v.useState({primary:"#2563eb",secondary:"#374151",text1:"#e5e7eb",text2:"#cbd5e1",highlight:"#10b981",lowlight:"#111827",phone_style:"classic",background_animations:[]}),[n,r]=v.useState([{name:"Default",theme:{primary:"#2563eb",secondary:"#374151",text1:"#e5e7eb",text2:"#cbd5e1",highlight:"#10b981",lowlight:"#111827"}},{name:"Dark",theme:{primary:"#8b5cf6",secondary:"#1f2937",text1:"#f9fafb",text2:"#d1d5db",highlight:"#f59e0b",lowlight:"#111827"}},{name:"Light",theme:{primary:"#3b82f6",secondary:"#f3f4f6",text1:"#111827",text2:"#6b7280",highlight:"#059669",lowlight:"#f9fafb"}},{name:"Forest",theme:{primary:"#059669",secondary:"#064e3b",text1:"#ecfdf5",text2:"#a7f3d0",highlight:"#f59e0b",lowlight:"#022c22"}},{name:"Ocean",theme:{primary:"#0891b2",secondary:"#164e63",text1:"#ecfeff",text2:"#a5f3fc",highlight:"#f97316",lowlight:"#0c4a6e"}},{name:"Rose",theme:{primary:"#db2777",secondary:"#5b21b6",text1:"#fef2f2",text2:"#fecaca",highlight:"#eab308",lowlight:"#581c87"}}]);v.useEffect(()=>{(async()=>{try{const u=await tn();u.theme&&t(u.theme)}catch(u){console.error(u)}})()},[]),v.useEffect(()=>{const u=document.documentElement;u.style.setProperty("--primary",e.primary),u.style.setProperty("--panel",e.secondary),u.style.setProperty("--text",e.text1),u.style.setProperty("--muted",e.text2),u.style.setProperty("--assistant",e.highlight),u.style.setProperty("--bg",e.lowlight)},[e]);const s=async u=>{t(u);try{await Et({theme:u});try{window.dispatchEvent(new CustomEvent("coolchat:themeUpdate",{detail:u}))}catch{}}catch(d){console.error(d),alert(d.message)}},o=async()=>{try{const u=await fetch(`${Q}/theme/suggest`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({primary:e.primary})});if(!u.ok)throw new Error("Suggest failed");const{colors:d}=await u.json();if(d.length>=5){const f={...e,secondary:d[0],text1:d[1],text2:d[2],highlight:d[3],lowlight:d[4]};await s(f)}}catch(u){console.error(u),alert(u.message)}},i=async u=>{await s({...e,...u.theme})},l=async()=>{const u={...e,secondary:e.lowlight,lowlight:e.secondary,text1:e.text1,text2:e.text2};await s(u)},c=({label:u,keyName:d,withThink:f})=>a.jsxs("label",{children:[a.jsx("span",{children:u}),a.jsxs("div",{className:"row color-row",style:{gap:8,alignItems:"center"},children:[a.jsx("input",{className:"color-swatch",type:"color",value:e[d],onChange:async p=>{await s({...e,[d]:p.target.value})}}),a.jsx("input",{style:{flex:1},value:e[d],onChange:async p=>{await s({...e,[d]:p.target.value})}}),f&&a.jsx("button",{className:"think",title:"AI suggests complementary colors for this primary",onClick:o,children:""})]})]});return a.jsxs("div",{className:"config-form",children:[a.jsxs("div",{className:"theme-preview",style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16,padding:12,background:"var(--panel)",borderRadius:8,border:"1px solid var(--muted)"},children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{background:"var(--primary)",width:40,height:20,borderRadius:4,margin:"0 auto 8px"}}),a.jsx("small",{style:{color:"var(--text)"},children:"Primary"})]}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{background:"var(--bg)",width:40,height:20,borderRadius:4,border:"1px solid var(--secondary)",margin:"0 auto 8px"}}),a.jsx("small",{style:{color:"var(--text)"},children:"Background"})]}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{background:"var(--panel)",width:40,height:20,borderRadius:4,border:"1px solid var(--muted)",margin:"0 auto 8px"}}),a.jsx("small",{style:{color:"var(--text)"},children:"Panel"})]}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{background:"var(--assistant)",width:40,height:20,borderRadius:4,margin:"0 auto 8px"}}),a.jsx("small",{style:{color:"var(--text)"},children:"Assistant"})]})]}),a.jsxs("label",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{children:"Preset Themes"}),a.jsxs("div",{className:"row",style:{gap:6,flexWrap:"wrap",marginTop:6},children:[n.map((u,d)=>a.jsx("button",{className:"secondary theme-btn",style:{background:`linear-gradient(45deg, ${u.theme.primary}, ${u.theme.secondary})`,color:u.theme.text1,border:"none",borderRadius:6,padding:"6px 12px",fontSize:12,cursor:"pointer"},onClick:()=>i(u),title:`Apply ${u.name} theme`,children:u.name},d)),a.jsx("button",{className:"secondary",onClick:l,title:"Swap background colors for high contrast",children:" Invert BG"})]})]}),a.jsx(c,{label:"Primary",keyName:"primary",withThink:!0}),a.jsx(c,{label:"Secondary",keyName:"secondary"}),a.jsx(c,{label:"Text 1",keyName:"text1"}),a.jsx(c,{label:"Text 2",keyName:"text2"}),a.jsx(c,{label:"Highlight",keyName:"highlight"}),a.jsx(c,{label:"Lowlight",keyName:"lowlight"}),a.jsxs("label",{children:[a.jsx("span",{children:"Phone Style"}),a.jsxs("select",{value:e.phone_style||"classic",onChange:async u=>{const d={...e,phone_style:u.target.value};await s(d);try{window.dispatchEvent(new CustomEvent("coolchat:phoneStyle",{detail:d.phone_style}))}catch{}},children:[a.jsx("option",{value:"classic",children:"Classic"}),a.jsx("option",{value:"modern",children:"Modern"}),a.jsx("option",{value:"iphone",children:"iPhone"}),a.jsx("option",{value:"cyberpunk",children:"Cyberpunk"})]})]}),a.jsxs("label",{style:{gridColumn:"1 / -1"},children:[a.jsxs("span",{style:{display:"flex",alignItems:"center",gap:8},children:["Background Animations",a.jsx("small",{style:{color:"var(--muted)",fontWeight:"normal"},children:"(Multiple allowed)"})]}),a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center",marginBottom:6},children:[a.jsxs("select",{id:"anim-select",style:{flex:1},children:[a.jsx("option",{value:"gradient_flow",children:"Gradient Flow"}),a.jsx("option",{value:"floating_squares",children:"Floating Squares"}),a.jsx("option",{value:"waves",children:"Ocean Waves"}),a.jsx("option",{value:"neon_rain",children:"Neon Rain"}),a.jsx("option",{value:"matrix",children:"Matrix Code"}),a.jsx("option",{value:"particles",children:"Floating Particles"}),a.jsx("option",{value:"geometric",children:"Geometric Shapes"})]}),a.jsx("button",{className:"secondary",onClick:()=>{try{const u=document.querySelector("#anim-select"),d=u==null?void 0:u.value;if(!d||d==="")return;const f=Array.isArray(e.background_animations)?[...e.background_animations]:[];!f.includes(d)&&f.length<3?s({...e,background_animations:[...f,d]}):f.length>=3&&alert("Maximum 3 background animations allowed")}catch(u){console.error(u)}},children:"+ Add"})]}),a.jsx("div",{className:"row",style:{gap:6,flexWrap:"wrap"},children:(e.background_animations||[]).map((u,d)=>a.jsxs("span",{className:"tag",style:{padding:"4px 8px",borderRadius:12,background:"var(--panel)",border:"1px solid var(--muted)",fontSize:12,display:"flex",alignItems:"center",gap:4},children:[u,a.jsx("button",{className:"remove-tag",onClick:()=>{const f=(e.background_animations||[]).filter(p=>p!==u);s({...e,background_animations:f})},style:{border:"none",background:"transparent",color:"var(--muted)",cursor:"pointer",fontSize:14,lineHeight:1},children:""})]},d))})]}),a.jsx("hr",{}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsxs("div",{className:"row",style:{justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:a.jsx("strong",{children:"Saved Themes"})}),a.jsx("button",{className:"secondary",onClick:async()=>{const u=prompt("Export current theme as:");u&&u.trim()&&(await fetch(`${Q}/themes`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u.trim(),theme:{...e}})}),alert("Theme exported: "+u.trim()))},title:"Export current theme to saved themes",children:" Export"})]}),a.jsx("div",{style:{marginTop:8},children:a.jsx(S_,{})})]})]})}function C_({suggestions:e,onClose:t,onApply:n}){console.log("[DEBUG] SuggestLoreModal received suggestions:",e);const[r,s]=v.useState(()=>(e||[]).map(u=>({include:!0,keyword:u.keyword||"",content:u.content||""})));console.log("[DEBUG] SuggestLoreModal rows initialized:",r);const[o,i]=v.useState([]),[l,c]=v.useState("");return v.useEffect(()=>{(async()=>{var u;try{const f=(await tn()).active_lorebook_ids||[];if(f.length){const m=(await Tu()).filter(y=>f.includes(y.id)).map(y=>({id:y.id,name:y.name}));i(m),c(String(((u=m[0])==null?void 0:u.id)||""))}}catch(d){console.error(d)}})()},[]),a.jsxs("section",{className:"panel overlay",children:[a.jsx("h2",{children:"Lore Suggestions"}),o.length>1&&a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("span",{className:"muted",children:"Target Lorebook"}),a.jsx("select",{value:l,onChange:u=>c(u.target.value),children:o.map(u=>a.jsx("option",{value:u.id,children:u.name},u.id))})]}),a.jsx("div",{className:"char-list",style:{maxHeight:360,overflow:"auto"},children:r.map((u,d)=>a.jsxs("div",{className:"char-item",style:{flexDirection:"column",alignItems:"stretch"},children:[a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("input",{type:"checkbox",checked:u.include,onChange:f=>s(p=>p.map((m,y)=>y===d?{...m,include:f.target.checked}:m))}),a.jsx("input",{placeholder:"Keyword",value:u.keyword,onChange:f=>s(p=>p.map((m,y)=>y===d?{...m,keyword:f.target.value}:m))})]}),a.jsx("textarea",{rows:3,placeholder:"Content",value:u.content,onChange:f=>s(p=>p.map((m,y)=>y===d?{...m,content:f.target.value}:m))})]},d))}),a.jsxs("div",{className:"row",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[a.jsx("button",{className:"secondary",onClick:t,children:"Cancel"}),a.jsx("button",{onClick:()=>n(r,l?parseInt(l,10):null),children:"Add Selected"})]})]})}function j_({sessionId:e,setSessionId:t,onClose:n}){const[r,s]=v.useState([]),[o,i]=v.useState(""),l=async()=>{try{const c=await Ym();s(c.sessions||[])}catch(c){console.error(c)}};return v.useEffect(()=>{l()},[]),a.jsxs("div",{className:"config-form",children:[a.jsxs("div",{className:"row",style:{gap:8,alignItems:"center"},children:[a.jsx("select",{value:e,onChange:async c=>{const u=c.target.value;t(u)},children:[...r].map(c=>a.jsx("option",{value:c,children:c},c))}),a.jsx("button",{className:"secondary",onClick:l,children:"Refresh"}),a.jsx("button",{className:"secondary",onClick:async()=>{try{await Km(e),await l(),t("default")}catch(c){alert(c.message)}},children:"Reset"}),a.jsx("button",{className:"secondary",onClick:n,children:"Close"})]}),a.jsxs("div",{style:{marginTop:8,display:"flex",flexDirection:"column",gap:8},children:[a.jsx("input",{placeholder:"New session id (e.g., 2025-01-01T12:00)",value:o,onChange:c=>i(c.target.value),style:{flex:1}}),a.jsx("button",{onClick:async()=>{const c=(o||"").trim()||String(Date.now());r.includes(c)||s(u=>[...u,c]),t(c),i("")},children:"New"})]})]})}function N_({character:e,onClose:t,onSave:n,onThink:r,lorebooks:s}){const[o,i]=v.useState(()=>({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",avatar_url:(e==null?void 0:e.avatar_url)||"",first_message:(e==null?void 0:e.first_message)||"",alternate_greetings:((e==null?void 0:e.alternate_greetings)||[]).join(", "),scenario:(e==null?void 0:e.scenario)||"",system_prompt:(e==null?void 0:e.system_prompt)||"",personality:(e==null?void 0:e.personality)||"",mes_example:(e==null?void 0:e.mes_example)||"",creator_notes:(e==null?void 0:e.creator_notes)||"",tags:((e==null?void 0:e.tags)||[]).join(", "),post_history_instructions:(e==null?void 0:e.post_history_instructions)||"",lorebook_ids:(e==null?void 0:e.lorebook_ids)||[],image_prompt_prefix:(e==null?void 0:e.image_prompt_prefix)||"",image_prompt_suffix:(e==null?void 0:e.image_prompt_suffix)||""})),[l,c]=v.useState(null),[u,d]=v.useState(!1),[f,p]=v.useState(!1),m=async y=>{try{c(y);const x=await r(y,o);i(j=>({...j,[y]:x}))}finally{c(null)}};return a.jsx("div",{className:"modal",onClick:t,children:a.jsxs("div",{className:"dialog",onClick:y=>y.stopPropagation(),children:[a.jsx("h2",{children:e?"Edit Character":"New Character"}),a.jsxs("div",{className:"editor-grid",children:[a.jsx("span",{className:"label",children:"Name"}),a.jsxs("div",{children:[a.jsx("input",{value:o.name,onChange:y=>i(x=>({...x,name:y.target.value}))})," ",a.jsx("button",{className:"think",onClick:()=>m("name"),children:""})]}),a.jsx("span",{className:"label",children:"Avatar"}),a.jsxs("div",{children:[o.avatar_url&&a.jsx("img",{src:o.avatar_url,alt:"Avatar preview",style:{width:80,height:80,objectFit:"cover",borderRadius:8,marginRight:8,border:"1px solid #1f2937"}}),a.jsx("input",{type:"file",accept:"image/*",onChange:async y=>{var j;const x=(j=y.target.files)==null?void 0:j[0];if(x)try{p(!0);const h=new FormData;h.append("file",x);const g=await fetch(`${Q}/characters/upload_avatar`,{method:"POST",body:h});if(!g.ok)throw new Error("Upload failed");const w=await g.json();i(k=>({...k,avatar_url:w.avatar_url}))}catch(h){alert(h.message)}finally{p(!1),y.target.value=""}}}),a.jsx("button",{className:`paint ${u?"thinking":""}`,onClick:async()=>{try{d(!0);const y=await fetch(`${Q}/characters/generate_avatar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({character:o})});if(!y.ok)throw new Error("Generate failed");const x=await y.json();i(j=>({...j,avatar_url:x.avatar_url}))}catch(y){alert(y.message)}finally{d(!1)}},children:""})]}),a.jsx("span",{className:"label",children:"Description"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.description,onChange:y=>i(x=>({...x,description:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="description"?"thinking":""}`,onClick:()=>m("description"),children:""})]}),a.jsx("span",{className:"label",children:"First Message"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.first_message,onChange:y=>i(x=>({...x,first_message:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="first_message"?"thinking":""}`,onClick:()=>m("first_message"),children:""})]}),a.jsx("span",{className:"label",children:"Alternate Greetings (comma)"}),a.jsxs("div",{children:[a.jsx("input",{value:o.alternate_greetings,onChange:y=>i(x=>({...x,alternate_greetings:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="alternate_greetings"?"thinking":""}`,onClick:()=>m("alternate_greetings"),children:""})]}),a.jsx("span",{className:"label",children:"Scenario"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.scenario,onChange:y=>i(x=>({...x,scenario:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="scenario"?"thinking":""}`,onClick:()=>m("scenario"),children:""})]}),a.jsx("span",{className:"label",children:"System Prompt"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.system_prompt,onChange:y=>i(x=>({...x,system_prompt:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="system_prompt"?"thinking":""}`,onClick:()=>m("system_prompt"),children:""})]}),a.jsx("span",{className:"label",children:"Personality"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.personality,onChange:y=>i(x=>({...x,personality:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="personality"?"thinking":""}`,onClick:()=>m("personality"),children:""})]}),a.jsx("span",{className:"label",children:"Message Example"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.mes_example,onChange:y=>i(x=>({...x,mes_example:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="mes_example"?"thinking":""}`,onClick:()=>m("mes_example"),children:""})]}),a.jsx("span",{className:"label",children:"Creator Notes"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.creator_notes,onChange:y=>i(x=>({...x,creator_notes:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="creator_notes"?"thinking":""}`,onClick:()=>m("creator_notes"),children:""})]}),a.jsx("span",{className:"label",children:"Prepend to image prompts"}),a.jsxs("div",{children:[a.jsx("input",{value:o.image_prompt_prefix,onChange:y=>i(x=>({...x,image_prompt_prefix:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="image_prompt_prefix"?"thinking":""}`,onClick:()=>m("image_prompt_prefix"),children:""})]}),a.jsx("span",{className:"label",children:"Append to image prompts"}),a.jsxs("div",{children:[a.jsx("input",{value:o.image_prompt_suffix,onChange:y=>i(x=>({...x,image_prompt_suffix:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="image_prompt_suffix"?"thinking":""}`,onClick:()=>m("image_prompt_suffix"),children:""})]}),a.jsx("span",{className:"label",children:"Tags (comma)"}),a.jsx("div",{children:a.jsx("input",{value:o.tags,onChange:y=>i(x=>({...x,tags:y.target.value}))})}),a.jsx("span",{className:"label",children:"Post-History Instructions"}),a.jsxs("div",{children:[a.jsx("textarea",{rows:3,value:o.post_history_instructions,onChange:y=>i(x=>({...x,post_history_instructions:y.target.value}))})," ",a.jsx("button",{className:`think ${l==="post_history_instructions"?"thinking":""}`,onClick:()=>m("post_history_instructions"),children:""})]}),a.jsx("span",{className:"label",children:"Lorebook"}),a.jsx("div",{children:a.jsxs("select",{value:o.lorebook_ids[0]||"",onChange:y=>{const x=y.target.value?[parseInt(y.target.value,10)]:[];i(j=>({...j,lorebook_ids:x}))},children:[a.jsx("option",{value:"",children:"-- None --"}),s.map(y=>a.jsx("option",{value:y.id,children:y.name},y.id))]})})]}),a.jsxs("div",{className:"row",style:{justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"secondary",onClick:t,children:"Cancel"}),a.jsx("button",{onClick:()=>{const y={...o,alternate_greetings:o.alternate_greetings.split(",").map(x=>x.trim()).filter(Boolean),tags:o.tags.split(",").map(x=>x.trim()).filter(Boolean)};n(y)},children:"Save"})]})]})})}function E_(){return a.jsx(kw,{children:a.jsx(Dm,{path:"/",element:a.jsx(g_,{})})})}yl.createRoot(document.getElementById("root")).render(a.jsx(I.StrictMode,{children:a.jsx(Yw,{children:a.jsx(E_,{})})}));
